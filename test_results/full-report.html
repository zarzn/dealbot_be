<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8"/>
    <title id="head-title">full-report.html</title>
      <link href="assets\style.css" rel="stylesheet" type="text/css"/>
  </head>
  <body>
    <h1 id="title">full-report.html</h1>
    <p>Report generated on 01-Mar-2025 at 03:08:52 by <a href="https://pypi.python.org/pypi/pytest-html">pytest-html</a>
        v4.1.1</p>
    <div id="environment-header">
      <h2>Environment</h2>
    </div>
    <table id="environment"></table>
    <!-- TEMPLATES -->
      <template id="template_environment_row">
      <tr>
        <td></td>
        <td></td>
      </tr>
    </template>
    <template id="template_results-table__body--empty">
      <tbody class="results-table-row">
        <tr id="not-found-message">
          <td colspan="4">No results found. Check the filters.</th>
        </tr>
    </template>
    <template id="template_results-table__tbody">
      <tbody class="results-table-row">
        <tr class="collapsible">
        </tr>
        <tr class="extras-row">
          <td class="extra" colspan="4">
            <div class="extraHTML"></div>
            <div class="media">
              <div class="media-container">
                  <div class="media-container__nav--left"><</div>
                  <div class="media-container__viewport">
                    <img src="" />
                    <video controls>
                      <source src="" type="video/mp4">
                    </video>
                  </div>
                  <div class="media-container__nav--right">></div>
                </div>
                <div class="media__name"></div>
                <div class="media__counter"></div>
            </div>
            <div class="logwrapper">
              <div class="logexpander"></div>
              <div class="log"></div>
            </div>
          </td>
        </tr>
      </tbody>
    </template>
    <!-- END TEMPLATES -->
    <div class="summary">
      <div class="summary__data">
        <h2>Summary</h2>
        <div class="additional-summary prefix">
        </div>
        <p class="run-count">124 tests took 00:00:37.</p>
        <p class="filter">(Un)check the boxes to filter the results.</p>
        <div class="summary__reload">
          <div class="summary__reload__button hidden" onclick="location.reload()">
            <div>There are still tests running. <br />Reload this page to get the latest results!</div>
          </div>
        </div>
        <div class="summary__spacer"></div>
        <div class="controls">
          <div class="filters">
            <input checked="true" class="filter" name="filter_checkbox" type="checkbox" data-test-result="failed" disabled/>
            <span class="failed">0 Failed,</span>
            <input checked="true" class="filter" name="filter_checkbox" type="checkbox" data-test-result="passed" />
            <span class="passed">124 Passed,</span>
            <input checked="true" class="filter" name="filter_checkbox" type="checkbox" data-test-result="skipped" />
            <span class="skipped">1 Skipped,</span>
            <input checked="true" class="filter" name="filter_checkbox" type="checkbox" data-test-result="xfailed" disabled/>
            <span class="xfailed">0 Expected failures,</span>
            <input checked="true" class="filter" name="filter_checkbox" type="checkbox" data-test-result="xpassed" disabled/>
            <span class="xpassed">0 Unexpected passes,</span>
            <input checked="true" class="filter" name="filter_checkbox" type="checkbox" data-test-result="error" disabled/>
            <span class="error">0 Errors,</span>
            <input checked="true" class="filter" name="filter_checkbox" type="checkbox" data-test-result="rerun" disabled/>
            <span class="rerun">0 Reruns</span>
          </div>
          <div class="collapse">
            <button id="show_all_details">Show all details</button>&nbsp;/&nbsp;<button id="hide_all_details">Hide all details</button>
          </div>
        </div>
      </div>
      <div class="additional-summary summary">
      </div>
      <div class="additional-summary postfix">
      </div>
    </div>
    <table id="results-table">
      <thead id="results-table-head">
        <tr>
          <th class="sortable" data-column-type="result">Result</th>
          <th class="sortable" data-column-type="testId">Test</th>
          <th class="sortable" data-column-type="duration">Duration</th>
          <th>Links</th>
        </tr>
      </thead>
    </table>
  </body>
  <footer>
    <div id="data-container" data-jsonblob="{&#34;environment&#34;: {&#34;Python&#34;: &#34;3.11.4&#34;, &#34;Platform&#34;: &#34;Windows-10-10.0.22631-SP0&#34;, &#34;Packages&#34;: {&#34;pytest&#34;: &#34;7.4.4&#34;, &#34;pluggy&#34;: &#34;1.5.0&#34;}, &#34;Plugins&#34;: {&#34;anchorpy&#34;: &#34;0.18.0&#34;, &#34;anyio&#34;: &#34;3.7.1&#34;, &#34;Faker&#34;: &#34;22.5.1&#34;, &#34;asyncio&#34;: &#34;0.21.1&#34;, &#34;cov&#34;: &#34;4.1.0&#34;, &#34;html&#34;: &#34;4.1.1&#34;, &#34;metadata&#34;: &#34;3.1.1&#34;, &#34;mock&#34;: &#34;3.12.0&#34;, &#34;timeout&#34;: &#34;2.3.1&#34;, &#34;xdist&#34;: &#34;3.6.1&#34;, &#34;xprocess&#34;: &#34;0.18.1&#34;, &#34;time-machine&#34;: &#34;2.16.0&#34;}}, &#34;tests&#34;: {&#34;backend_tests/core/test_models/test_deal.py::test_create_deal&#34;: [{&#34;extras&#34;: [], &#34;result&#34;: &#34;Passed&#34;, &#34;testId&#34;: &#34;backend_tests/core/test_models/test_deal.py::test_create_deal&#34;, &#34;duration&#34;: &#34;879 ms&#34;, &#34;resultsTableRow&#34;: [&#34;&lt;td class=\&#34;col-result\&#34;&gt;Passed&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-testId\&#34;&gt;backend_tests/core/test_models/test_deal.py::test_create_deal&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-duration\&#34;&gt;879 ms&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-links\&#34;&gt;&lt;/td&gt;&#34;], &#34;log&#34;: &#34;----------------------------- Captured stderr call -----------------------------\nWARNING:passlib.handlers.bcrypt:(trapped) error reading bcrypt version\nTraceback (most recent call last):\n  File &amp;quot;C:\\Active Projects\\AI AGENTIC DEALS SYSTEM\\venv\\Lib\\site-packages\\passlib\\handlers\\bcrypt.py&amp;quot;, line 620, in _load_backend_mixin\n    version = _bcrypt.__about__.__version__\n              ^^^^^^^^^^^^^^^^^\nAttributeError: module &amp;#x27;bcrypt&amp;#x27; has no attribute &amp;#x27;__about__&amp;#x27;\nC:\\Active Projects\\AI AGENTIC DEALS SYSTEM\\backend\\backend_tests\\factories\\base.py:24: SAWarning: relationship &amp;#x27;Deal.tracked_by_users&amp;#x27; will copy column deals.id to column tracked_deals.deal_id, which conflicts with relationship(s): &amp;#x27;Deal.trackers&amp;#x27; (copies deals.id to tracked_deals.deal_id). If this is not the intention, consider if these relationships should be linked with back_populates, or if viewonly=True should be applied to one or more if they are read-only. For the less common case that foreign key constraints are partially overlapping, the orm.foreign() annotation can be used to isolate the columns that should be written towards.   To silence this warning, add the parameter &amp;#x27;overlaps=&amp;quot;trackers&amp;quot;&amp;#x27; to the &amp;#x27;Deal.tracked_by_users&amp;#x27; relationship. (Background on this warning at: https://sqlalche.me/e/20/qzyx) (This warning originated from the `configure_mappers()` process, which was invoked automatically in response to a user-initiated operation.)\n  return model_class(*args, **kwargs)\n\n------------------------------ Captured log call -------------------------------\nWARNING  passlib.handlers.bcrypt:bcrypt.py:622 (trapped) error reading bcrypt version\nTraceback (most recent call last):\n  File &amp;quot;C:\\Active Projects\\AI AGENTIC DEALS SYSTEM\\venv\\Lib\\site-packages\\passlib\\handlers\\bcrypt.py&amp;quot;, line 620, in _load_backend_mixin\n    version = _bcrypt.__about__.__version__\n              ^^^^^^^^^^^^^^^^^\nAttributeError: module &amp;#x27;bcrypt&amp;#x27; has no attribute &amp;#x27;__about__&amp;#x27;\n\n&#34;}], &#34;backend_tests/core/test_models/test_deal.py::test_deal_price_validation&#34;: [{&#34;extras&#34;: [], &#34;result&#34;: &#34;Passed&#34;, &#34;testId&#34;: &#34;backend_tests/core/test_models/test_deal.py::test_deal_price_validation&#34;, &#34;duration&#34;: &#34;249 ms&#34;, &#34;resultsTableRow&#34;: [&#34;&lt;td class=\&#34;col-result\&#34;&gt;Passed&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-testId\&#34;&gt;backend_tests/core/test_models/test_deal.py::test_deal_price_validation&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-duration\&#34;&gt;249 ms&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-links\&#34;&gt;&lt;/td&gt;&#34;], &#34;log&#34;: &#34;No log output captured.&#34;}], &#34;backend_tests/core/test_models/test_deal.py::test_deal_status_transitions&#34;: [{&#34;extras&#34;: [], &#34;result&#34;: &#34;Passed&#34;, &#34;testId&#34;: &#34;backend_tests/core/test_models/test_deal.py::test_deal_status_transitions&#34;, &#34;duration&#34;: &#34;270 ms&#34;, &#34;resultsTableRow&#34;: [&#34;&lt;td class=\&#34;col-result\&#34;&gt;Passed&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-testId\&#34;&gt;backend_tests/core/test_models/test_deal.py::test_deal_status_transitions&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-duration\&#34;&gt;270 ms&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-links\&#34;&gt;&lt;/td&gt;&#34;], &#34;log&#34;: &#34;No log output captured.&#34;}], &#34;backend_tests/core/test_models/test_deal.py::test_deal_relationships&#34;: [{&#34;extras&#34;: [], &#34;result&#34;: &#34;Passed&#34;, &#34;testId&#34;: &#34;backend_tests/core/test_models/test_deal.py::test_deal_relationships&#34;, &#34;duration&#34;: &#34;408 ms&#34;, &#34;resultsTableRow&#34;: [&#34;&lt;td class=\&#34;col-result\&#34;&gt;Passed&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-testId\&#34;&gt;backend_tests/core/test_models/test_deal.py::test_deal_relationships&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-duration\&#34;&gt;408 ms&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-links\&#34;&gt;&lt;/td&gt;&#34;], &#34;log&#34;: &#34;No log output captured.&#34;}], &#34;backend_tests/core/test_models/test_market.py::test_create_market&#34;: [{&#34;extras&#34;: [], &#34;result&#34;: &#34;Passed&#34;, &#34;testId&#34;: &#34;backend_tests/core/test_models/test_market.py::test_create_market&#34;, &#34;duration&#34;: &#34;9 ms&#34;, &#34;resultsTableRow&#34;: [&#34;&lt;td class=\&#34;col-result\&#34;&gt;Passed&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-testId\&#34;&gt;backend_tests/core/test_models/test_market.py::test_create_market&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-duration\&#34;&gt;9 ms&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-links\&#34;&gt;&lt;/td&gt;&#34;], &#34;log&#34;: &#34;No log output captured.&#34;}], &#34;backend_tests/core/test_models/test_market.py::test_market_status_transitions&#34;: [{&#34;extras&#34;: [], &#34;result&#34;: &#34;Passed&#34;, &#34;testId&#34;: &#34;backend_tests/core/test_models/test_market.py::test_market_status_transitions&#34;, &#34;duration&#34;: &#34;18 ms&#34;, &#34;resultsTableRow&#34;: [&#34;&lt;td class=\&#34;col-result\&#34;&gt;Passed&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-testId\&#34;&gt;backend_tests/core/test_models/test_market.py::test_market_status_transitions&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-duration\&#34;&gt;18 ms&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-links\&#34;&gt;&lt;/td&gt;&#34;], &#34;log&#34;: &#34;No log output captured.&#34;}], &#34;backend_tests/core/test_models/test_market.py::test_market_type_validation&#34;: [{&#34;extras&#34;: [], &#34;result&#34;: &#34;Passed&#34;, &#34;testId&#34;: &#34;backend_tests/core/test_models/test_market.py::test_market_type_validation&#34;, &#34;duration&#34;: &#34;27 ms&#34;, &#34;resultsTableRow&#34;: [&#34;&lt;td class=\&#34;col-result\&#34;&gt;Passed&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-testId\&#34;&gt;backend_tests/core/test_models/test_market.py::test_market_type_validation&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-duration\&#34;&gt;27 ms&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-links\&#34;&gt;&lt;/td&gt;&#34;], &#34;log&#34;: &#34;No log output captured.&#34;}], &#34;backend_tests/core/test_models/test_market.py::test_market_rate_limit_validation&#34;: [{&#34;extras&#34;: [], &#34;result&#34;: &#34;Passed&#34;, &#34;testId&#34;: &#34;backend_tests/core/test_models/test_market.py::test_market_rate_limit_validation&#34;, &#34;duration&#34;: &#34;9 ms&#34;, &#34;resultsTableRow&#34;: [&#34;&lt;td class=\&#34;col-result\&#34;&gt;Passed&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-testId\&#34;&gt;backend_tests/core/test_models/test_market.py::test_market_rate_limit_validation&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-duration\&#34;&gt;9 ms&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-links\&#34;&gt;&lt;/td&gt;&#34;], &#34;log&#34;: &#34;No log output captured.&#34;}], &#34;backend_tests/core/test_models/test_market.py::test_market_config_validation&#34;: [{&#34;extras&#34;: [], &#34;result&#34;: &#34;Passed&#34;, &#34;testId&#34;: &#34;backend_tests/core/test_models/test_market.py::test_market_config_validation&#34;, &#34;duration&#34;: &#34;7 ms&#34;, &#34;resultsTableRow&#34;: [&#34;&lt;td class=\&#34;col-result\&#34;&gt;Passed&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-testId\&#34;&gt;backend_tests/core/test_models/test_market.py::test_market_config_validation&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-duration\&#34;&gt;7 ms&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-links\&#34;&gt;&lt;/td&gt;&#34;], &#34;log&#34;: &#34;No log output captured.&#34;}], &#34;backend_tests/core/test_models/test_token_balance.py::test_token_transaction_creation&#34;: [{&#34;extras&#34;: [], &#34;result&#34;: &#34;Passed&#34;, &#34;testId&#34;: &#34;backend_tests/core/test_models/test_token_balance.py::test_token_transaction_creation&#34;, &#34;duration&#34;: &#34;295 ms&#34;, &#34;resultsTableRow&#34;: [&#34;&lt;td class=\&#34;col-result\&#34;&gt;Passed&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-testId\&#34;&gt;backend_tests/core/test_models/test_token_balance.py::test_token_transaction_creation&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-duration\&#34;&gt;295 ms&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-links\&#34;&gt;&lt;/td&gt;&#34;], &#34;log&#34;: &#34;No log output captured.&#34;}], &#34;backend_tests/core/test_models/test_token_balance.py::test_user_token_balance&#34;: [{&#34;extras&#34;: [], &#34;result&#34;: &#34;Passed&#34;, &#34;testId&#34;: &#34;backend_tests/core/test_models/test_token_balance.py::test_user_token_balance&#34;, &#34;duration&#34;: &#34;270 ms&#34;, &#34;resultsTableRow&#34;: [&#34;&lt;td class=\&#34;col-result\&#34;&gt;Passed&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-testId\&#34;&gt;backend_tests/core/test_models/test_token_balance.py::test_user_token_balance&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-duration\&#34;&gt;270 ms&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-links\&#34;&gt;&lt;/td&gt;&#34;], &#34;log&#34;: &#34;No log output captured.&#34;}], &#34;backend_tests/core/test_models/test_token_balance.py::test_token_transaction_validation&#34;: [{&#34;extras&#34;: [], &#34;result&#34;: &#34;Passed&#34;, &#34;testId&#34;: &#34;backend_tests/core/test_models/test_token_balance.py::test_token_transaction_validation&#34;, &#34;duration&#34;: &#34;248 ms&#34;, &#34;resultsTableRow&#34;: [&#34;&lt;td class=\&#34;col-result\&#34;&gt;Passed&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-testId\&#34;&gt;backend_tests/core/test_models/test_token_balance.py::test_token_transaction_validation&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-duration\&#34;&gt;248 ms&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-links\&#34;&gt;&lt;/td&gt;&#34;], &#34;log&#34;: &#34;No log output captured.&#34;}], &#34;backend_tests/core/test_models/test_token_balance.py::test_token_balance_precision&#34;: [{&#34;extras&#34;: [], &#34;result&#34;: &#34;Passed&#34;, &#34;testId&#34;: &#34;backend_tests/core/test_models/test_token_balance.py::test_token_balance_precision&#34;, &#34;duration&#34;: &#34;271 ms&#34;, &#34;resultsTableRow&#34;: [&#34;&lt;td class=\&#34;col-result\&#34;&gt;Passed&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-testId\&#34;&gt;backend_tests/core/test_models/test_token_balance.py::test_token_balance_precision&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-duration\&#34;&gt;271 ms&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-links\&#34;&gt;&lt;/td&gt;&#34;], &#34;log&#34;: &#34;No log output captured.&#34;}], &#34;backend_tests/core/test_models/test_user.py::test_create_user&#34;: [{&#34;extras&#34;: [], &#34;result&#34;: &#34;Passed&#34;, &#34;testId&#34;: &#34;backend_tests/core/test_models/test_user.py::test_create_user&#34;, &#34;duration&#34;: &#34;243 ms&#34;, &#34;resultsTableRow&#34;: [&#34;&lt;td class=\&#34;col-result\&#34;&gt;Passed&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-testId\&#34;&gt;backend_tests/core/test_models/test_user.py::test_create_user&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-duration\&#34;&gt;243 ms&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-links\&#34;&gt;&lt;/td&gt;&#34;], &#34;log&#34;: &#34;No log output captured.&#34;}], &#34;backend_tests/core/test_models/test_user.py::test_user_password_hashing&#34;: [{&#34;extras&#34;: [], &#34;result&#34;: &#34;Passed&#34;, &#34;testId&#34;: &#34;backend_tests/core/test_models/test_user.py::test_user_password_hashing&#34;, &#34;duration&#34;: &#34;255 ms&#34;, &#34;resultsTableRow&#34;: [&#34;&lt;td class=\&#34;col-result\&#34;&gt;Passed&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-testId\&#34;&gt;backend_tests/core/test_models/test_user.py::test_user_password_hashing&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-duration\&#34;&gt;255 ms&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-links\&#34;&gt;&lt;/td&gt;&#34;], &#34;log&#34;: &#34;No log output captured.&#34;}], &#34;backend_tests/core/test_models/test_user.py::test_user_status_validation&#34;: [{&#34;extras&#34;: [], &#34;result&#34;: &#34;Passed&#34;, &#34;testId&#34;: &#34;backend_tests/core/test_models/test_user.py::test_user_status_validation&#34;, &#34;duration&#34;: &#34;253 ms&#34;, &#34;resultsTableRow&#34;: [&#34;&lt;td class=\&#34;col-result\&#34;&gt;Passed&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-testId\&#34;&gt;backend_tests/core/test_models/test_user.py::test_user_status_validation&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-duration\&#34;&gt;253 ms&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-links\&#34;&gt;&lt;/td&gt;&#34;], &#34;log&#34;: &#34;No log output captured.--------------------------- Captured stderr teardown ---------------------------\nsys:1: SAWarning: transaction already deassociated from connection\n&#34;}], &#34;backend_tests/features/test_agents/test_agent_features.py::test_goal_analysis_workflow&#34;: [{&#34;extras&#34;: [], &#34;result&#34;: &#34;Passed&#34;, &#34;testId&#34;: &#34;backend_tests/features/test_agents/test_agent_features.py::test_goal_analysis_workflow&#34;, &#34;duration&#34;: &#34;341 ms&#34;, &#34;resultsTableRow&#34;: [&#34;&lt;td class=\&#34;col-result\&#34;&gt;Passed&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-testId\&#34;&gt;backend_tests/features/test_agents/test_agent_features.py::test_goal_analysis_workflow&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-duration\&#34;&gt;341 ms&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-links\&#34;&gt;&lt;/td&gt;&#34;], &#34;log&#34;: &#34;---------------------------- Captured stderr setup -----------------------------\nINFO:backend.backend_tests.features.conftest:Redis mock initialized for feature test\nINFO:apscheduler.scheduler:Adding job tentatively -- it will be properly scheduled when the scheduler starts\nINFO:apscheduler.scheduler:Added job &amp;quot;DealService._monitor_deals&amp;quot; to job store &amp;quot;default&amp;quot;\nINFO:apscheduler.scheduler:Scheduler started\n\n------------------------------ Captured log setup ------------------------------\nINFO     backend.backend_tests.features.conftest:conftest.py:43 Redis mock initialized for feature test\nINFO     apscheduler.scheduler:base.py:444 Adding job tentatively -- it will be properly scheduled when the scheduler starts\nINFO     apscheduler.scheduler:base.py:885 Added job &amp;quot;DealService._monitor_deals&amp;quot; to job store &amp;quot;default&amp;quot;\nINFO     apscheduler.scheduler:base.py:171 Scheduler started\n\n----------------------------- Captured stderr call -----------------------------\nINFO:core.services.agent:Analyzing goal: Gaming Setup\n\n------------------------------ Captured log call -------------------------------\nINFO     core.services.agent:agent.py:263 Analyzing goal: Gaming Setup\n\n--------------------------- Captured stderr teardown ---------------------------\nINFO:backend.backend_tests.features.conftest:Redis mock cleaned up after feature test\n\n---------------------------- Captured log teardown -----------------------------\nINFO     backend.backend_tests.features.conftest:conftest.py:48 Redis mock cleaned up after feature test&#34;}], &#34;backend_tests/features/test_agents/test_agent_features.py::test_deal_analysis_workflow&#34;: [{&#34;extras&#34;: [], &#34;result&#34;: &#34;Passed&#34;, &#34;testId&#34;: &#34;backend_tests/features/test_agents/test_agent_features.py::test_deal_analysis_workflow&#34;, &#34;duration&#34;: &#34;628 ms&#34;, &#34;resultsTableRow&#34;: [&#34;&lt;td class=\&#34;col-result\&#34;&gt;Passed&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-testId\&#34;&gt;backend_tests/features/test_agents/test_agent_features.py::test_deal_analysis_workflow&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-duration\&#34;&gt;628 ms&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-links\&#34;&gt;&lt;/td&gt;&#34;], &#34;log&#34;: &#34;---------------------------- Captured stderr setup -----------------------------\nINFO:backend.backend_tests.features.conftest:Redis mock initialized for feature test\nINFO:apscheduler.scheduler:Adding job tentatively -- it will be properly scheduled when the scheduler starts\nINFO:apscheduler.scheduler:Added job &amp;quot;DealService._monitor_deals&amp;quot; to job store &amp;quot;default&amp;quot;\nINFO:apscheduler.scheduler:Scheduler started\n\n------------------------------ Captured log setup ------------------------------\nINFO     backend.backend_tests.features.conftest:conftest.py:43 Redis mock initialized for feature test\nINFO     apscheduler.scheduler:base.py:444 Adding job tentatively -- it will be properly scheduled when the scheduler starts\nINFO     apscheduler.scheduler:base.py:885 Added job &amp;quot;DealService._monitor_deals&amp;quot; to job store &amp;quot;default&amp;quot;\nINFO     apscheduler.scheduler:base.py:171 Scheduler started\n\n----------------------------- Captured stderr call -----------------------------\nINFO:core.services.agent:Analyzing deal: 90a8b474-9dd8-42c9-aac1-a730663e37ce\n\n------------------------------ Captured log call -------------------------------\nINFO     core.services.agent:agent.py:294 Analyzing deal: 90a8b474-9dd8-42c9-aac1-a730663e37ce\n\n--------------------------- Captured stderr teardown ---------------------------\nINFO:backend.backend_tests.features.conftest:Redis mock cleaned up after feature test\n\n---------------------------- Captured log teardown -----------------------------\nINFO     backend.backend_tests.features.conftest:conftest.py:48 Redis mock cleaned up after feature test&#34;}], &#34;backend_tests/features/test_agents/test_agent_features.py::test_market_search_workflow&#34;: [{&#34;extras&#34;: [], &#34;result&#34;: &#34;Passed&#34;, &#34;testId&#34;: &#34;backend_tests/features/test_agents/test_agent_features.py::test_market_search_workflow&#34;, &#34;duration&#34;: &#34;37 ms&#34;, &#34;resultsTableRow&#34;: [&#34;&lt;td class=\&#34;col-result\&#34;&gt;Passed&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-testId\&#34;&gt;backend_tests/features/test_agents/test_agent_features.py::test_market_search_workflow&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-duration\&#34;&gt;37 ms&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-links\&#34;&gt;&lt;/td&gt;&#34;], &#34;log&#34;: &#34;---------------------------- Captured stderr setup -----------------------------\nINFO:backend.backend_tests.features.conftest:Redis mock initialized for feature test\nINFO:apscheduler.scheduler:Adding job tentatively -- it will be properly scheduled when the scheduler starts\nINFO:apscheduler.scheduler:Added job &amp;quot;DealService._monitor_deals&amp;quot; to job store &amp;quot;default&amp;quot;\nINFO:apscheduler.scheduler:Scheduler started\n\n------------------------------ Captured log setup ------------------------------\nINFO     backend.backend_tests.features.conftest:conftest.py:43 Redis mock initialized for feature test\nINFO     apscheduler.scheduler:base.py:444 Adding job tentatively -- it will be properly scheduled when the scheduler starts\nINFO     apscheduler.scheduler:base.py:885 Added job &amp;quot;DealService._monitor_deals&amp;quot; to job store &amp;quot;default&amp;quot;\nINFO     apscheduler.scheduler:base.py:171 Scheduler started\n\n----------------------------- Captured stderr call -----------------------------\nC:\\Active Projects\\AI AGENTIC DEALS SYSTEM\\venv\\Lib\\site-packages\\sqlalchemy\\util\\_collections.py:312: RuntimeWarning: coroutine &amp;#x27;get_mock_redis_service&amp;#x27; was never awaited\n  obj for obj in (ref() for ref in self._storage) if obj is not None\nRuntimeWarning: Enable tracemalloc to get the object allocation traceback\nINFO:core.services.agent:Searching market add419e9-76ee-45e5-a20b-f162f5b879b5 with params: {&amp;#x27;keywords&amp;#x27;: [&amp;#x27;gaming&amp;#x27;, &amp;#x27;laptop&amp;#x27;, &amp;#x27;rtx 3080&amp;#x27;], &amp;#x27;price_range&amp;#x27;: {&amp;#x27;min&amp;#x27;: 1500, &amp;#x27;max&amp;#x27;: 2500}, &amp;#x27;category&amp;#x27;: &amp;#x27;electronics&amp;#x27;}\n\n------------------------------ Captured log call -------------------------------\nINFO     core.services.agent:agent.py:321 Searching market add419e9-76ee-45e5-a20b-f162f5b879b5 with params: {&amp;#x27;keywords&amp;#x27;: [&amp;#x27;gaming&amp;#x27;, &amp;#x27;laptop&amp;#x27;, &amp;#x27;rtx 3080&amp;#x27;], &amp;#x27;price_range&amp;#x27;: {&amp;#x27;min&amp;#x27;: 1500, &amp;#x27;max&amp;#x27;: 2500}, &amp;#x27;category&amp;#x27;: &amp;#x27;electronics&amp;#x27;}\n\n--------------------------- Captured stderr teardown ---------------------------\nINFO:backend.backend_tests.features.conftest:Redis mock cleaned up after feature test\n\n---------------------------- Captured log teardown -----------------------------\nINFO     backend.backend_tests.features.conftest:conftest.py:48 Redis mock cleaned up after feature test&#34;}], &#34;backend_tests/features/test_agents/test_agent_features.py::test_price_prediction_workflow&#34;: [{&#34;extras&#34;: [], &#34;result&#34;: &#34;Passed&#34;, &#34;testId&#34;: &#34;backend_tests/features/test_agents/test_agent_features.py::test_price_prediction_workflow&#34;, &#34;duration&#34;: &#34;629 ms&#34;, &#34;resultsTableRow&#34;: [&#34;&lt;td class=\&#34;col-result\&#34;&gt;Passed&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-testId\&#34;&gt;backend_tests/features/test_agents/test_agent_features.py::test_price_prediction_workflow&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-duration\&#34;&gt;629 ms&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-links\&#34;&gt;&lt;/td&gt;&#34;], &#34;log&#34;: &#34;---------------------------- Captured stderr setup -----------------------------\nINFO:backend.backend_tests.features.conftest:Redis mock initialized for feature test\nINFO:apscheduler.scheduler:Adding job tentatively -- it will be properly scheduled when the scheduler starts\nINFO:apscheduler.scheduler:Added job &amp;quot;DealService._monitor_deals&amp;quot; to job store &amp;quot;default&amp;quot;\nINFO:apscheduler.scheduler:Scheduler started\n\n------------------------------ Captured log setup ------------------------------\nINFO     backend.backend_tests.features.conftest:conftest.py:43 Redis mock initialized for feature test\nINFO     apscheduler.scheduler:base.py:444 Adding job tentatively -- it will be properly scheduled when the scheduler starts\nINFO     apscheduler.scheduler:base.py:885 Added job &amp;quot;DealService._monitor_deals&amp;quot; to job store &amp;quot;default&amp;quot;\nINFO     apscheduler.scheduler:base.py:171 Scheduler started\n\n----------------------------- Captured stderr call -----------------------------\nERROR:core.services.deal:Failed to cache deal d5b4c33c-897c-4e59-a306-8dd4b17722be: &amp;#x27;Deal&amp;#x27; object has no attribute &amp;#x27;score&amp;#x27;\nINFO:core.services.agent:Predicting price for deal d5b4c33c-897c-4e59-a306-8dd4b17722be for next 14 days\n\n------------------------------ Captured log call -------------------------------\nERROR    core.services.deal:deal.py:849 Failed to cache deal d5b4c33c-897c-4e59-a306-8dd4b17722be: &amp;#x27;Deal&amp;#x27; object has no attribute &amp;#x27;score&amp;#x27;\nINFO     core.services.agent:agent.py:358 Predicting price for deal d5b4c33c-897c-4e59-a306-8dd4b17722be for next 14 days\n\n--------------------------- Captured stderr teardown ---------------------------\nINFO:backend.backend_tests.features.conftest:Redis mock cleaned up after feature test\n\n---------------------------- Captured log teardown -----------------------------\nINFO     backend.backend_tests.features.conftest:conftest.py:48 Redis mock cleaned up after feature test&#34;}], &#34;backend_tests/features/test_agents/test_agent_features.py::test_deal_matching_agent_workflow&#34;: [{&#34;extras&#34;: [], &#34;result&#34;: &#34;Passed&#34;, &#34;testId&#34;: &#34;backend_tests/features/test_agents/test_agent_features.py::test_deal_matching_agent_workflow&#34;, &#34;duration&#34;: &#34;00:00:02&#34;, &#34;resultsTableRow&#34;: [&#34;&lt;td class=\&#34;col-result\&#34;&gt;Passed&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-testId\&#34;&gt;backend_tests/features/test_agents/test_agent_features.py::test_deal_matching_agent_workflow&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-duration\&#34;&gt;00:00:02&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-links\&#34;&gt;&lt;/td&gt;&#34;], &#34;log&#34;: &#34;---------------------------- Captured stderr setup -----------------------------\nINFO:backend.backend_tests.features.conftest:Redis mock initialized for feature test\nINFO:apscheduler.scheduler:Adding job tentatively -- it will be properly scheduled when the scheduler starts\nINFO:apscheduler.scheduler:Added job &amp;quot;DealService._monitor_deals&amp;quot; to job store &amp;quot;default&amp;quot;\nINFO:apscheduler.scheduler:Scheduler started\n\n------------------------------ Captured log setup ------------------------------\nINFO     backend.backend_tests.features.conftest:conftest.py:43 Redis mock initialized for feature test\nINFO     apscheduler.scheduler:base.py:444 Adding job tentatively -- it will be properly scheduled when the scheduler starts\nINFO     apscheduler.scheduler:base.py:885 Added job &amp;quot;DealService._monitor_deals&amp;quot; to job store &amp;quot;default&amp;quot;\nINFO     apscheduler.scheduler:base.py:171 Scheduler started\n\n----------------------------- Captured stderr call -----------------------------\nINFO:core.services.agent:Finding matches for goal 1953dd37-62cb-43d7-9a2d-992e5b221f81\n\n------------------------------ Captured log call -------------------------------\nINFO     core.services.agent:agent.py:390 Finding matches for goal 1953dd37-62cb-43d7-9a2d-992e5b221f81\n\n--------------------------- Captured stderr teardown ---------------------------\nINFO:backend.backend_tests.features.conftest:Redis mock cleaned up after feature test\n\n---------------------------- Captured log teardown -----------------------------\nINFO     backend.backend_tests.features.conftest:conftest.py:48 Redis mock cleaned up after feature test&#34;}], &#34;backend_tests/features/test_agents/test_agent_features.py::test_deal_validation_agent_workflow&#34;: [{&#34;extras&#34;: [], &#34;result&#34;: &#34;Passed&#34;, &#34;testId&#34;: &#34;backend_tests/features/test_agents/test_agent_features.py::test_deal_validation_agent_workflow&#34;, &#34;duration&#34;: &#34;508 ms&#34;, &#34;resultsTableRow&#34;: [&#34;&lt;td class=\&#34;col-result\&#34;&gt;Passed&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-testId\&#34;&gt;backend_tests/features/test_agents/test_agent_features.py::test_deal_validation_agent_workflow&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-duration\&#34;&gt;508 ms&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-links\&#34;&gt;&lt;/td&gt;&#34;], &#34;log&#34;: &#34;---------------------------- Captured stderr setup -----------------------------\nINFO:backend.backend_tests.features.conftest:Redis mock initialized for feature test\nINFO:apscheduler.scheduler:Adding job tentatively -- it will be properly scheduled when the scheduler starts\nINFO:apscheduler.scheduler:Added job &amp;quot;DealService._monitor_deals&amp;quot; to job store &amp;quot;default&amp;quot;\nINFO:apscheduler.scheduler:Scheduler started\n\n------------------------------ Captured log setup ------------------------------\nINFO     backend.backend_tests.features.conftest:conftest.py:43 Redis mock initialized for feature test\nINFO     apscheduler.scheduler:base.py:444 Adding job tentatively -- it will be properly scheduled when the scheduler starts\nINFO     apscheduler.scheduler:base.py:885 Added job &amp;quot;DealService._monitor_deals&amp;quot; to job store &amp;quot;default&amp;quot;\nINFO     apscheduler.scheduler:base.py:171 Scheduler started\n\n----------------------------- Captured stderr call -----------------------------\nINFO:core.services.agent:Validating deal cbd06647-6d67-4592-9e59-018162ece101\n\n------------------------------ Captured log call -------------------------------\nINFO     core.services.agent:agent.py:426 Validating deal cbd06647-6d67-4592-9e59-018162ece101\n\n--------------------------- Captured stderr teardown ---------------------------\nINFO:backend.backend_tests.features.conftest:Redis mock cleaned up after feature test\n\n---------------------------- Captured log teardown -----------------------------\nINFO     backend.backend_tests.features.conftest:conftest.py:48 Redis mock cleaned up after feature test&#34;}], &#34;backend_tests/features/test_agents/test_agent_features.py::test_notification_agent_workflow&#34;: [{&#34;extras&#34;: [], &#34;result&#34;: &#34;Passed&#34;, &#34;testId&#34;: &#34;backend_tests/features/test_agents/test_agent_features.py::test_notification_agent_workflow&#34;, &#34;duration&#34;: &#34;759 ms&#34;, &#34;resultsTableRow&#34;: [&#34;&lt;td class=\&#34;col-result\&#34;&gt;Passed&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-testId\&#34;&gt;backend_tests/features/test_agents/test_agent_features.py::test_notification_agent_workflow&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-duration\&#34;&gt;759 ms&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-links\&#34;&gt;&lt;/td&gt;&#34;], &#34;log&#34;: &#34;---------------------------- Captured stderr setup -----------------------------\nINFO:backend.backend_tests.features.conftest:Redis mock initialized for feature test\nINFO:apscheduler.scheduler:Adding job tentatively -- it will be properly scheduled when the scheduler starts\nINFO:apscheduler.scheduler:Added job &amp;quot;DealService._monitor_deals&amp;quot; to job store &amp;quot;default&amp;quot;\nINFO:apscheduler.scheduler:Scheduler started\n\n------------------------------ Captured log setup ------------------------------\nINFO     backend.backend_tests.features.conftest:conftest.py:43 Redis mock initialized for feature test\nINFO     apscheduler.scheduler:base.py:444 Adding job tentatively -- it will be properly scheduled when the scheduler starts\nINFO     apscheduler.scheduler:base.py:885 Added job &amp;quot;DealService._monitor_deals&amp;quot; to job store &amp;quot;default&amp;quot;\nINFO     apscheduler.scheduler:base.py:171 Scheduler started\n\n----------------------------- Captured stderr call -----------------------------\nINFO:core.services.agent:Generating notification for user 79d3ec3e-44e5-4271-b360-c96ae3ed3833, goal 55ec0fbb-d896-4f8d-bcbe-2b547e8f8ba8, deal 88841dbf-a832-46d3-b781-52be925b5f52, event deal_match\n\n------------------------------ Captured log call -------------------------------\nINFO     core.services.agent:agent.py:458 Generating notification for user 79d3ec3e-44e5-4271-b360-c96ae3ed3833, goal 55ec0fbb-d896-4f8d-bcbe-2b547e8f8ba8, deal 88841dbf-a832-46d3-b781-52be925b5f52, event deal_match\n\n--------------------------- Captured stderr teardown ---------------------------\nINFO:backend.backend_tests.features.conftest:Redis mock cleaned up after feature test\n\n---------------------------- Captured log teardown -----------------------------\nINFO     backend.backend_tests.features.conftest:conftest.py:48 Redis mock cleaned up after feature test&#34;}], &#34;backend_tests/features/test_deals/test_deal_features.py::test_deal_discovery_workflow&#34;: [{&#34;extras&#34;: [], &#34;result&#34;: &#34;Passed&#34;, &#34;testId&#34;: &#34;backend_tests/features/test_deals/test_deal_features.py::test_deal_discovery_workflow&#34;, &#34;duration&#34;: &#34;286 ms&#34;, &#34;resultsTableRow&#34;: [&#34;&lt;td class=\&#34;col-result\&#34;&gt;Passed&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-testId\&#34;&gt;backend_tests/features/test_deals/test_deal_features.py::test_deal_discovery_workflow&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-duration\&#34;&gt;286 ms&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-links\&#34;&gt;&lt;/td&gt;&#34;], &#34;log&#34;: &#34;---------------------------- Captured stderr setup -----------------------------\nINFO:backend.backend_tests.features.conftest:Redis mock initialized for feature test\nINFO:apscheduler.scheduler:Adding job tentatively -- it will be properly scheduled when the scheduler starts\nINFO:apscheduler.scheduler:Added job &amp;quot;DealService._monitor_deals&amp;quot; to job store &amp;quot;default&amp;quot;\nINFO:apscheduler.scheduler:Scheduler started\n\n------------------------------ Captured log setup ------------------------------\nINFO     backend.backend_tests.features.conftest:conftest.py:43 Redis mock initialized for feature test\nINFO     apscheduler.scheduler:base.py:444 Adding job tentatively -- it will be properly scheduled when the scheduler starts\nINFO     apscheduler.scheduler:base.py:885 Added job &amp;quot;DealService._monitor_deals&amp;quot; to job store &amp;quot;default&amp;quot;\nINFO     apscheduler.scheduler:base.py:171 Scheduler started\n\n----------------------------- Captured stderr call -----------------------------\nINFO:core.services.deal:Discovering deal from market a27a05d9-3eb7-4289-9ff3-3e5318e6adc6\nINFO:core.services.deal:Successfully discovered deal 7f7ac5f1-5c94-4e8b-8ce2-27236fe89209 from market a27a05d9-3eb7-4289-9ff3-3e5318e6adc6\n\n------------------------------ Captured log call -------------------------------\nINFO     core.services.deal:deal.py:1408 Discovering deal from market a27a05d9-3eb7-4289-9ff3-3e5318e6adc6\nINFO     core.services.deal:deal.py:1428 Successfully discovered deal 7f7ac5f1-5c94-4e8b-8ce2-27236fe89209 from market a27a05d9-3eb7-4289-9ff3-3e5318e6adc6\n\n--------------------------- Captured stderr teardown ---------------------------\nINFO:backend.backend_tests.features.conftest:Redis mock cleaned up after feature test\n\n---------------------------- Captured log teardown -----------------------------\nINFO     backend.backend_tests.features.conftest:conftest.py:48 Redis mock cleaned up after feature test&#34;}], &#34;backend_tests/features/test_deals/test_deal_features.py::test_deal_price_tracking_workflow&#34;: [{&#34;extras&#34;: [], &#34;result&#34;: &#34;Passed&#34;, &#34;testId&#34;: &#34;backend_tests/features/test_deals/test_deal_features.py::test_deal_price_tracking_workflow&#34;, &#34;duration&#34;: &#34;538 ms&#34;, &#34;resultsTableRow&#34;: [&#34;&lt;td class=\&#34;col-result\&#34;&gt;Passed&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-testId\&#34;&gt;backend_tests/features/test_deals/test_deal_features.py::test_deal_price_tracking_workflow&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-duration\&#34;&gt;538 ms&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-links\&#34;&gt;&lt;/td&gt;&#34;], &#34;log&#34;: &#34;---------------------------- Captured stderr setup -----------------------------\nINFO:backend.backend_tests.features.conftest:Redis mock initialized for feature test\nC:\\Program Files\\Python311\\Lib\\asyncio\\proactor_events.py:792: RuntimeWarning: coroutine &amp;#x27;get_mock_redis_service&amp;#x27; was never awaited\n  f.result()  # may raise\nRuntimeWarning: Enable tracemalloc to get the object allocation traceback\nINFO:apscheduler.scheduler:Adding job tentatively -- it will be properly scheduled when the scheduler starts\nINFO:apscheduler.scheduler:Added job &amp;quot;DealService._monitor_deals&amp;quot; to job store &amp;quot;default&amp;quot;\nINFO:apscheduler.scheduler:Scheduler started\n\n------------------------------ Captured log setup ------------------------------\nINFO     backend.backend_tests.features.conftest:conftest.py:43 Redis mock initialized for feature test\nINFO     apscheduler.scheduler:base.py:444 Adding job tentatively -- it will be properly scheduled when the scheduler starts\nINFO     apscheduler.scheduler:base.py:885 Added job &amp;quot;DealService._monitor_deals&amp;quot; to job store &amp;quot;default&amp;quot;\nINFO     apscheduler.scheduler:base.py:171 Scheduler started\n--------------------------- Captured stderr teardown ---------------------------\nINFO:backend.backend_tests.features.conftest:Redis mock cleaned up after feature test\n\n---------------------------- Captured log teardown -----------------------------\nINFO     backend.backend_tests.features.conftest:conftest.py:48 Redis mock cleaned up after feature test&#34;}], &#34;backend_tests/features/test_deals/test_deal_features.py::test_deal_matching_workflow&#34;: [{&#34;extras&#34;: [], &#34;result&#34;: &#34;Passed&#34;, &#34;testId&#34;: &#34;backend_tests/features/test_deals/test_deal_features.py::test_deal_matching_workflow&#34;, &#34;duration&#34;: &#34;284 ms&#34;, &#34;resultsTableRow&#34;: [&#34;&lt;td class=\&#34;col-result\&#34;&gt;Passed&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-testId\&#34;&gt;backend_tests/features/test_deals/test_deal_features.py::test_deal_matching_workflow&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-duration\&#34;&gt;284 ms&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-links\&#34;&gt;&lt;/td&gt;&#34;], &#34;log&#34;: &#34;---------------------------- Captured stderr setup -----------------------------\nINFO:backend.backend_tests.features.conftest:Redis mock initialized for feature test\nINFO:apscheduler.scheduler:Adding job tentatively -- it will be properly scheduled when the scheduler starts\nINFO:apscheduler.scheduler:Added job &amp;quot;DealService._monitor_deals&amp;quot; to job store &amp;quot;default&amp;quot;\nINFO:apscheduler.scheduler:Scheduler started\n\n------------------------------ Captured log setup ------------------------------\nINFO     backend.backend_tests.features.conftest:conftest.py:43 Redis mock initialized for feature test\nINFO     apscheduler.scheduler:base.py:444 Adding job tentatively -- it will be properly scheduled when the scheduler starts\nINFO     apscheduler.scheduler:base.py:885 Added job &amp;quot;DealService._monitor_deals&amp;quot; to job store &amp;quot;default&amp;quot;\nINFO     apscheduler.scheduler:base.py:171 Scheduler started\n--------------------------- Captured stderr teardown ---------------------------\nINFO:backend.backend_tests.features.conftest:Redis mock cleaned up after feature test\n\n---------------------------- Captured log teardown -----------------------------\nINFO     backend.backend_tests.features.conftest:conftest.py:48 Redis mock cleaned up after feature test&#34;}], &#34;backend_tests/features/test_deals/test_deal_features.py::test_deal_expiration_workflow&#34;: [{&#34;extras&#34;: [], &#34;result&#34;: &#34;Passed&#34;, &#34;testId&#34;: &#34;backend_tests/features/test_deals/test_deal_features.py::test_deal_expiration_workflow&#34;, &#34;duration&#34;: &#34;542 ms&#34;, &#34;resultsTableRow&#34;: [&#34;&lt;td class=\&#34;col-result\&#34;&gt;Passed&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-testId\&#34;&gt;backend_tests/features/test_deals/test_deal_features.py::test_deal_expiration_workflow&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-duration\&#34;&gt;542 ms&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-links\&#34;&gt;&lt;/td&gt;&#34;], &#34;log&#34;: &#34;---------------------------- Captured stderr setup -----------------------------\nINFO:backend.backend_tests.features.conftest:Redis mock initialized for feature test\nINFO:apscheduler.scheduler:Adding job tentatively -- it will be properly scheduled when the scheduler starts\nINFO:apscheduler.scheduler:Added job &amp;quot;DealService._monitor_deals&amp;quot; to job store &amp;quot;default&amp;quot;\nINFO:apscheduler.scheduler:Scheduler started\n\n------------------------------ Captured log setup ------------------------------\nINFO     backend.backend_tests.features.conftest:conftest.py:43 Redis mock initialized for feature test\nINFO     apscheduler.scheduler:base.py:444 Adding job tentatively -- it will be properly scheduled when the scheduler starts\nINFO     apscheduler.scheduler:base.py:885 Added job &amp;quot;DealService._monitor_deals&amp;quot; to job store &amp;quot;default&amp;quot;\nINFO     apscheduler.scheduler:base.py:171 Scheduler started\n\n----------------------------- Captured stderr call -----------------------------\nERROR:core.services.deal:Failed to cache deal c6ee7c18-c49a-4e12-8df7-88abcdb849b5: &amp;#x27;Deal&amp;#x27; object has no attribute &amp;#x27;score&amp;#x27;\n\n------------------------------ Captured log call -------------------------------\nERROR    core.services.deal:deal.py:849 Failed to cache deal c6ee7c18-c49a-4e12-8df7-88abcdb849b5: &amp;#x27;Deal&amp;#x27; object has no attribute &amp;#x27;score&amp;#x27;\n\n--------------------------- Captured stderr teardown ---------------------------\nINFO:backend.backend_tests.features.conftest:Redis mock cleaned up after feature test\n\n---------------------------- Captured log teardown -----------------------------\nINFO     backend.backend_tests.features.conftest:conftest.py:48 Redis mock cleaned up after feature test&#34;}], &#34;backend_tests/features/test_deals/test_deal_features.py::test_deal_validation_workflow&#34;: [{&#34;extras&#34;: [], &#34;result&#34;: &#34;Passed&#34;, &#34;testId&#34;: &#34;backend_tests/features/test_deals/test_deal_features.py::test_deal_validation_workflow&#34;, &#34;duration&#34;: &#34;523 ms&#34;, &#34;resultsTableRow&#34;: [&#34;&lt;td class=\&#34;col-result\&#34;&gt;Passed&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-testId\&#34;&gt;backend_tests/features/test_deals/test_deal_features.py::test_deal_validation_workflow&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-duration\&#34;&gt;523 ms&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-links\&#34;&gt;&lt;/td&gt;&#34;], &#34;log&#34;: &#34;---------------------------- Captured stderr setup -----------------------------\nINFO:backend.backend_tests.features.conftest:Redis mock initialized for feature test\nINFO:apscheduler.scheduler:Adding job tentatively -- it will be properly scheduled when the scheduler starts\nINFO:apscheduler.scheduler:Added job &amp;quot;DealService._monitor_deals&amp;quot; to job store &amp;quot;default&amp;quot;\nINFO:apscheduler.scheduler:Scheduler started\n\n------------------------------ Captured log setup ------------------------------\nINFO     backend.backend_tests.features.conftest:conftest.py:43 Redis mock initialized for feature test\nINFO     apscheduler.scheduler:base.py:444 Adding job tentatively -- it will be properly scheduled when the scheduler starts\nINFO     apscheduler.scheduler:base.py:885 Added job &amp;quot;DealService._monitor_deals&amp;quot; to job store &amp;quot;default&amp;quot;\nINFO     apscheduler.scheduler:base.py:171 Scheduler started\n\n----------------------------- Captured stderr call -----------------------------\nINFO:core.services.deal:Validating deal 7f71a447-45d7-4f5a-b0cb-8e521920cbe0\nERROR:core.services.deal:Failed to cache deal 7f71a447-45d7-4f5a-b0cb-8e521920cbe0: &amp;#x27;Deal&amp;#x27; object has no attribute &amp;#x27;score&amp;#x27;\nINFO:core.services.deal:Deal 7f71a447-45d7-4f5a-b0cb-8e521920cbe0 validation result: {&amp;#x27;is_valid&amp;#x27;: True, &amp;#x27;url_accessible&amp;#x27;: True, &amp;#x27;price_reasonable&amp;#x27;: True, &amp;#x27;errors&amp;#x27;: []}\n\n------------------------------ Captured log call -------------------------------\nINFO     core.services.deal:deal.py:1669 Validating deal 7f71a447-45d7-4f5a-b0cb-8e521920cbe0\nERROR    core.services.deal:deal.py:849 Failed to cache deal 7f71a447-45d7-4f5a-b0cb-8e521920cbe0: &amp;#x27;Deal&amp;#x27; object has no attribute &amp;#x27;score&amp;#x27;\nINFO     core.services.deal:deal.py:1713 Deal 7f71a447-45d7-4f5a-b0cb-8e521920cbe0 validation result: {&amp;#x27;is_valid&amp;#x27;: True, &amp;#x27;url_accessible&amp;#x27;: True, &amp;#x27;price_reasonable&amp;#x27;: True, &amp;#x27;errors&amp;#x27;: []}\n\n--------------------------- Captured stderr teardown ---------------------------\nINFO:backend.backend_tests.features.conftest:Redis mock cleaned up after feature test\n\n---------------------------- Captured log teardown -----------------------------\nINFO     backend.backend_tests.features.conftest:conftest.py:48 Redis mock cleaned up after feature test&#34;}], &#34;backend_tests/features/test_deals/test_deal_features.py::test_deal_refresh_workflow&#34;: [{&#34;extras&#34;: [], &#34;result&#34;: &#34;Passed&#34;, &#34;testId&#34;: &#34;backend_tests/features/test_deals/test_deal_features.py::test_deal_refresh_workflow&#34;, &#34;duration&#34;: &#34;527 ms&#34;, &#34;resultsTableRow&#34;: [&#34;&lt;td class=\&#34;col-result\&#34;&gt;Passed&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-testId\&#34;&gt;backend_tests/features/test_deals/test_deal_features.py::test_deal_refresh_workflow&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-duration\&#34;&gt;527 ms&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-links\&#34;&gt;&lt;/td&gt;&#34;], &#34;log&#34;: &#34;---------------------------- Captured stderr setup -----------------------------\nINFO:backend.backend_tests.features.conftest:Redis mock initialized for feature test\nINFO:apscheduler.scheduler:Adding job tentatively -- it will be properly scheduled when the scheduler starts\nINFO:apscheduler.scheduler:Added job &amp;quot;DealService._monitor_deals&amp;quot; to job store &amp;quot;default&amp;quot;\nINFO:apscheduler.scheduler:Scheduler started\n\n------------------------------ Captured log setup ------------------------------\nINFO     backend.backend_tests.features.conftest:conftest.py:43 Redis mock initialized for feature test\nINFO     apscheduler.scheduler:base.py:444 Adding job tentatively -- it will be properly scheduled when the scheduler starts\nINFO     apscheduler.scheduler:base.py:885 Added job &amp;quot;DealService._monitor_deals&amp;quot; to job store &amp;quot;default&amp;quot;\nINFO     apscheduler.scheduler:base.py:171 Scheduler started\n--------------------------- Captured stderr teardown ---------------------------\nINFO:backend.backend_tests.features.conftest:Redis mock cleaned up after feature test\n\n---------------------------- Captured log teardown -----------------------------\nINFO     backend.backend_tests.features.conftest:conftest.py:48 Redis mock cleaned up after feature test&#34;}], &#34;backend_tests/features/test_goals/test_goal_creation.py::test_create_goal&#34;: [{&#34;extras&#34;: [], &#34;result&#34;: &#34;Passed&#34;, &#34;testId&#34;: &#34;backend_tests/features/test_goals/test_goal_creation.py::test_create_goal&#34;, &#34;duration&#34;: &#34;256 ms&#34;, &#34;resultsTableRow&#34;: [&#34;&lt;td class=\&#34;col-result\&#34;&gt;Passed&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-testId\&#34;&gt;backend_tests/features/test_goals/test_goal_creation.py::test_create_goal&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-duration\&#34;&gt;256 ms&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-links\&#34;&gt;&lt;/td&gt;&#34;], &#34;log&#34;: &#34;---------------------------- Captured stderr setup -----------------------------\nINFO:backend.backend_tests.features.conftest:Redis mock initialized for feature test\n\n------------------------------ Captured log setup ------------------------------\nINFO     backend.backend_tests.features.conftest:conftest.py:43 Redis mock initialized for feature test\n--------------------------- Captured stderr teardown ---------------------------\nINFO:backend.backend_tests.features.conftest:Redis mock cleaned up after feature test\n\n---------------------------- Captured log teardown -----------------------------\nINFO     backend.backend_tests.features.conftest:conftest.py:48 Redis mock cleaned up after feature test&#34;}], &#34;backend_tests/features/test_goals/test_goal_features.py::test_goal_creation_workflow&#34;: [{&#34;extras&#34;: [], &#34;result&#34;: &#34;Passed&#34;, &#34;testId&#34;: &#34;backend_tests/features/test_goals/test_goal_features.py::test_goal_creation_workflow&#34;, &#34;duration&#34;: &#34;272 ms&#34;, &#34;resultsTableRow&#34;: [&#34;&lt;td class=\&#34;col-result\&#34;&gt;Passed&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-testId\&#34;&gt;backend_tests/features/test_goals/test_goal_features.py::test_goal_creation_workflow&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-duration\&#34;&gt;272 ms&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-links\&#34;&gt;&lt;/td&gt;&#34;], &#34;log&#34;: &#34;---------------------------- Captured stderr setup -----------------------------\nINFO:backend.backend_tests.features.conftest:Redis mock initialized for feature test\nC:\\Active Projects\\AI AGENTIC DEALS SYSTEM\\venv\\Lib\\site-packages\\sqlalchemy\\util\\_concurrency_py3k.py:190: RuntimeWarning: coroutine &amp;#x27;get_mock_redis_service&amp;#x27; was never awaited\n  result = context.switch(*args, **kwargs)\nRuntimeWarning: Enable tracemalloc to get the object allocation traceback\nINFO:apscheduler.scheduler:Adding job tentatively -- it will be properly scheduled when the scheduler starts\nINFO:apscheduler.scheduler:Added job &amp;quot;DealService._monitor_deals&amp;quot; to job store &amp;quot;default&amp;quot;\nINFO:apscheduler.scheduler:Scheduler started\n\n------------------------------ Captured log setup ------------------------------\nINFO     backend.backend_tests.features.conftest:conftest.py:43 Redis mock initialized for feature test\nINFO     apscheduler.scheduler:base.py:444 Adding job tentatively -- it will be properly scheduled when the scheduler starts\nINFO     apscheduler.scheduler:base.py:885 Added job &amp;quot;DealService._monitor_deals&amp;quot; to job store &amp;quot;default&amp;quot;\nINFO     apscheduler.scheduler:base.py:171 Scheduler started\n--------------------------- Captured stderr teardown ---------------------------\nINFO:backend.backend_tests.features.conftest:Redis mock cleaned up after feature test\n\n---------------------------- Captured log teardown -----------------------------\nINFO     backend.backend_tests.features.conftest:conftest.py:48 Redis mock cleaned up after feature test&#34;}], &#34;backend_tests/features/test_goals/test_goal_features.py::test_goal_matching_workflow&#34;: [{&#34;extras&#34;: [], &#34;result&#34;: &#34;Passed&#34;, &#34;testId&#34;: &#34;backend_tests/features/test_goals/test_goal_features.py::test_goal_matching_workflow&#34;, &#34;duration&#34;: &#34;543 ms&#34;, &#34;resultsTableRow&#34;: [&#34;&lt;td class=\&#34;col-result\&#34;&gt;Passed&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-testId\&#34;&gt;backend_tests/features/test_goals/test_goal_features.py::test_goal_matching_workflow&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-duration\&#34;&gt;543 ms&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-links\&#34;&gt;&lt;/td&gt;&#34;], &#34;log&#34;: &#34;---------------------------- Captured stderr setup -----------------------------\nINFO:backend.backend_tests.features.conftest:Redis mock initialized for feature test\nINFO:apscheduler.scheduler:Adding job tentatively -- it will be properly scheduled when the scheduler starts\nINFO:apscheduler.scheduler:Added job &amp;quot;DealService._monitor_deals&amp;quot; to job store &amp;quot;default&amp;quot;\nINFO:apscheduler.scheduler:Scheduler started\n\n------------------------------ Captured log setup ------------------------------\nINFO     backend.backend_tests.features.conftest:conftest.py:43 Redis mock initialized for feature test\nINFO     apscheduler.scheduler:base.py:444 Adding job tentatively -- it will be properly scheduled when the scheduler starts\nINFO     apscheduler.scheduler:base.py:885 Added job &amp;quot;DealService._monitor_deals&amp;quot; to job store &amp;quot;default&amp;quot;\nINFO     apscheduler.scheduler:base.py:171 Scheduler started\n--------------------------- Captured stderr teardown ---------------------------\nINFO:backend.backend_tests.features.conftest:Redis mock cleaned up after feature test\n\n---------------------------- Captured log teardown -----------------------------\nINFO     backend.backend_tests.features.conftest:conftest.py:48 Redis mock cleaned up after feature test&#34;}], &#34;backend_tests/features/test_goals/test_goal_features.py::test_goal_notification_workflow&#34;: [{&#34;extras&#34;: [], &#34;result&#34;: &#34;Passed&#34;, &#34;testId&#34;: &#34;backend_tests/features/test_goals/test_goal_features.py::test_goal_notification_workflow&#34;, &#34;duration&#34;: &#34;275 ms&#34;, &#34;resultsTableRow&#34;: [&#34;&lt;td class=\&#34;col-result\&#34;&gt;Passed&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-testId\&#34;&gt;backend_tests/features/test_goals/test_goal_features.py::test_goal_notification_workflow&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-duration\&#34;&gt;275 ms&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-links\&#34;&gt;&lt;/td&gt;&#34;], &#34;log&#34;: &#34;---------------------------- Captured stderr setup -----------------------------\nINFO:backend.backend_tests.features.conftest:Redis mock initialized for feature test\nINFO:apscheduler.scheduler:Adding job tentatively -- it will be properly scheduled when the scheduler starts\nINFO:apscheduler.scheduler:Added job &amp;quot;DealService._monitor_deals&amp;quot; to job store &amp;quot;default&amp;quot;\nINFO:apscheduler.scheduler:Scheduler started\n\n------------------------------ Captured log setup ------------------------------\nINFO     backend.backend_tests.features.conftest:conftest.py:43 Redis mock initialized for feature test\nINFO     apscheduler.scheduler:base.py:444 Adding job tentatively -- it will be properly scheduled when the scheduler starts\nINFO     apscheduler.scheduler:base.py:885 Added job &amp;quot;DealService._monitor_deals&amp;quot; to job store &amp;quot;default&amp;quot;\nINFO     apscheduler.scheduler:base.py:171 Scheduler started\n--------------------------- Captured stderr teardown ---------------------------\nINFO:backend.backend_tests.features.conftest:Redis mock cleaned up after feature test\n\n---------------------------- Captured log teardown -----------------------------\nINFO     backend.backend_tests.features.conftest:conftest.py:48 Redis mock cleaned up after feature test&#34;}], &#34;backend_tests/features/test_goals/test_goal_features.py::test_goal_completion_workflow&#34;: [{&#34;extras&#34;: [], &#34;result&#34;: &#34;Passed&#34;, &#34;testId&#34;: &#34;backend_tests/features/test_goals/test_goal_features.py::test_goal_completion_workflow&#34;, &#34;duration&#34;: &#34;543 ms&#34;, &#34;resultsTableRow&#34;: [&#34;&lt;td class=\&#34;col-result\&#34;&gt;Passed&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-testId\&#34;&gt;backend_tests/features/test_goals/test_goal_features.py::test_goal_completion_workflow&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-duration\&#34;&gt;543 ms&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-links\&#34;&gt;&lt;/td&gt;&#34;], &#34;log&#34;: &#34;---------------------------- Captured stderr setup -----------------------------\nINFO:backend.backend_tests.features.conftest:Redis mock initialized for feature test\nINFO:apscheduler.scheduler:Adding job tentatively -- it will be properly scheduled when the scheduler starts\nINFO:apscheduler.scheduler:Added job &amp;quot;DealService._monitor_deals&amp;quot; to job store &amp;quot;default&amp;quot;\nINFO:apscheduler.scheduler:Scheduler started\n\n------------------------------ Captured log setup ------------------------------\nINFO     backend.backend_tests.features.conftest:conftest.py:43 Redis mock initialized for feature test\nINFO     apscheduler.scheduler:base.py:444 Adding job tentatively -- it will be properly scheduled when the scheduler starts\nINFO     apscheduler.scheduler:base.py:885 Added job &amp;quot;DealService._monitor_deals&amp;quot; to job store &amp;quot;default&amp;quot;\nINFO     apscheduler.scheduler:base.py:171 Scheduler started\n--------------------------- Captured stderr teardown ---------------------------\nINFO:backend.backend_tests.features.conftest:Redis mock cleaned up after feature test\n\n---------------------------- Captured log teardown -----------------------------\nINFO     backend.backend_tests.features.conftest:conftest.py:48 Redis mock cleaned up after feature test&#34;}], &#34;backend_tests/features/test_goals/test_goal_features.py::test_goal_token_limit_workflow&#34;: [{&#34;extras&#34;: [], &#34;result&#34;: &#34;Passed&#34;, &#34;testId&#34;: &#34;backend_tests/features/test_goals/test_goal_features.py::test_goal_token_limit_workflow&#34;, &#34;duration&#34;: &#34;271 ms&#34;, &#34;resultsTableRow&#34;: [&#34;&lt;td class=\&#34;col-result\&#34;&gt;Passed&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-testId\&#34;&gt;backend_tests/features/test_goals/test_goal_features.py::test_goal_token_limit_workflow&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-duration\&#34;&gt;271 ms&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-links\&#34;&gt;&lt;/td&gt;&#34;], &#34;log&#34;: &#34;---------------------------- Captured stderr setup -----------------------------\nINFO:backend.backend_tests.features.conftest:Redis mock initialized for feature test\nINFO:apscheduler.scheduler:Adding job tentatively -- it will be properly scheduled when the scheduler starts\nINFO:apscheduler.scheduler:Added job &amp;quot;DealService._monitor_deals&amp;quot; to job store &amp;quot;default&amp;quot;\nINFO:apscheduler.scheduler:Scheduler started\n\n------------------------------ Captured log setup ------------------------------\nINFO     backend.backend_tests.features.conftest:conftest.py:43 Redis mock initialized for feature test\nINFO     apscheduler.scheduler:base.py:444 Adding job tentatively -- it will be properly scheduled when the scheduler starts\nINFO     apscheduler.scheduler:base.py:885 Added job &amp;quot;DealService._monitor_deals&amp;quot; to job store &amp;quot;default&amp;quot;\nINFO     apscheduler.scheduler:base.py:171 Scheduler started\n--------------------------- Captured stderr teardown ---------------------------\nINFO:backend.backend_tests.features.conftest:Redis mock cleaned up after feature test\n\n---------------------------- Captured log teardown -----------------------------\nINFO     backend.backend_tests.features.conftest:conftest.py:48 Redis mock cleaned up after feature test&#34;}], &#34;backend_tests/features/test_goals/test_goal_features.py::test_goal_deadline_workflow&#34;: [{&#34;extras&#34;: [], &#34;result&#34;: &#34;Passed&#34;, &#34;testId&#34;: &#34;backend_tests/features/test_goals/test_goal_features.py::test_goal_deadline_workflow&#34;, &#34;duration&#34;: &#34;301 ms&#34;, &#34;resultsTableRow&#34;: [&#34;&lt;td class=\&#34;col-result\&#34;&gt;Passed&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-testId\&#34;&gt;backend_tests/features/test_goals/test_goal_features.py::test_goal_deadline_workflow&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-duration\&#34;&gt;301 ms&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-links\&#34;&gt;&lt;/td&gt;&#34;], &#34;log&#34;: &#34;---------------------------- Captured stderr setup -----------------------------\nINFO:backend.backend_tests.features.conftest:Redis mock initialized for feature test\nINFO:apscheduler.scheduler:Adding job tentatively -- it will be properly scheduled when the scheduler starts\nINFO:apscheduler.scheduler:Added job &amp;quot;DealService._monitor_deals&amp;quot; to job store &amp;quot;default&amp;quot;\nINFO:apscheduler.scheduler:Scheduler started\n\n------------------------------ Captured log setup ------------------------------\nINFO     backend.backend_tests.features.conftest:conftest.py:43 Redis mock initialized for feature test\nINFO     apscheduler.scheduler:base.py:444 Adding job tentatively -- it will be properly scheduled when the scheduler starts\nINFO     apscheduler.scheduler:base.py:885 Added job &amp;quot;DealService._monitor_deals&amp;quot; to job store &amp;quot;default&amp;quot;\nINFO     apscheduler.scheduler:base.py:171 Scheduler started\n--------------------------- Captured stderr teardown ---------------------------\nINFO:backend.backend_tests.features.conftest:Redis mock cleaned up after feature test\n\n---------------------------- Captured log teardown -----------------------------\nINFO     backend.backend_tests.features.conftest:conftest.py:48 Redis mock cleaned up after feature test&#34;}], &#34;backend_tests/features/test_goals/test_goal_features.py::test_goal_alert_workflow&#34;: [{&#34;extras&#34;: [], &#34;result&#34;: &#34;Passed&#34;, &#34;testId&#34;: &#34;backend_tests/features/test_goals/test_goal_features.py::test_goal_alert_workflow&#34;, &#34;duration&#34;: &#34;551 ms&#34;, &#34;resultsTableRow&#34;: [&#34;&lt;td class=\&#34;col-result\&#34;&gt;Passed&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-testId\&#34;&gt;backend_tests/features/test_goals/test_goal_features.py::test_goal_alert_workflow&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-duration\&#34;&gt;551 ms&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-links\&#34;&gt;&lt;/td&gt;&#34;], &#34;log&#34;: &#34;---------------------------- Captured stderr setup -----------------------------\nINFO:backend.backend_tests.features.conftest:Redis mock initialized for feature test\nINFO:apscheduler.scheduler:Adding job tentatively -- it will be properly scheduled when the scheduler starts\nINFO:apscheduler.scheduler:Added job &amp;quot;DealService._monitor_deals&amp;quot; to job store &amp;quot;default&amp;quot;\nINFO:apscheduler.scheduler:Scheduler started\n\n------------------------------ Captured log setup ------------------------------\nINFO     backend.backend_tests.features.conftest:conftest.py:43 Redis mock initialized for feature test\nINFO     apscheduler.scheduler:base.py:444 Adding job tentatively -- it will be properly scheduled when the scheduler starts\nINFO     apscheduler.scheduler:base.py:885 Added job &amp;quot;DealService._monitor_deals&amp;quot; to job store &amp;quot;default&amp;quot;\nINFO     apscheduler.scheduler:base.py:171 Scheduler started\n--------------------------- Captured stderr teardown ---------------------------\nINFO:backend.backend_tests.features.conftest:Redis mock cleaned up after feature test\n\n---------------------------- Captured log teardown -----------------------------\nINFO     backend.backend_tests.features.conftest:conftest.py:48 Redis mock cleaned up after feature test&#34;}], &#34;backend_tests/integration/test_api/test_auth_api.py::test_register_api&#34;: [{&#34;extras&#34;: [], &#34;result&#34;: &#34;Passed&#34;, &#34;testId&#34;: &#34;backend_tests/integration/test_api/test_auth_api.py::test_register_api&#34;, &#34;duration&#34;: &#34;409 ms&#34;, &#34;resultsTableRow&#34;: [&#34;&lt;td class=\&#34;col-result\&#34;&gt;Passed&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-testId\&#34;&gt;backend_tests/integration/test_api/test_auth_api.py::test_register_api&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-duration\&#34;&gt;409 ms&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-links\&#34;&gt;&lt;/td&gt;&#34;], &#34;log&#34;: &#34;----------------------------- Captured stdout call -----------------------------\n2025-03-01 03:08:29,526 - core.api.v1.auth.router - DEBUG - Register request data: email=&amp;#x27;test_register_1740769709@example.com&amp;#x27; password=&amp;#x27;TestPassword123!&amp;#x27; name=&amp;#x27;Test User&amp;#x27;\n2025-03-01 03:08:29,891 - core.api.v1.auth.router - DEBUG - Register request data: email=&amp;#x27;test_register_1740769709@example.com&amp;#x27; password=&amp;#x27;TestPassword123!&amp;#x27; name=&amp;#x27;Another User&amp;#x27;\n2025-03-01 03:08:29,894 - core.api.v1.auth.router - ERROR - Registration failed: Email already registered\n2025-03-01 03:08:29,895 - core.api.v1.auth.router - ERROR - Error details: {&amp;#x27;email&amp;#x27;: &amp;#x27;test_register_1740769709@example.com&amp;#x27;}\n\n----------------------------- Captured stderr call -----------------------------\nC:\\Active Projects\\AI AGENTIC DEALS SYSTEM\\venv\\Lib\\site-packages\\idna\\core.py:334: RuntimeWarning: coroutine &amp;#x27;get_mock_redis_service&amp;#x27; was never awaited\n  from .uts46data import uts46data\nRuntimeWarning: Enable tracemalloc to get the object allocation traceback\nDEBUG:core.api.v1.auth.router:Register request data: email=&amp;#x27;test_register_1740769709@example.com&amp;#x27; password=&amp;#x27;TestPassword123!&amp;#x27; name=&amp;#x27;Test User&amp;#x27;\nINFO:core.services.auth:User registered successfully: test_register_1740769709@example.com\nINFO:httpx:HTTP Request: POST http://testserver/api/v1/auth/register &amp;quot;HTTP/1.1 201 Created&amp;quot;\nDEBUG:core.api.v1.auth.router:Register request data: email=&amp;#x27;test_register_1740769709@example.com&amp;#x27; password=&amp;#x27;TestPassword123!&amp;#x27; name=&amp;#x27;Another User&amp;#x27;\nERROR:core.api.v1.auth.router:Registration failed: Email already registered\nERROR:core.api.v1.auth.router:Error details: {&amp;#x27;email&amp;#x27;: &amp;#x27;test_register_1740769709@example.com&amp;#x27;}\nINFO:httpx:HTTP Request: POST http://testserver/api/v1/auth/register &amp;quot;HTTP/1.1 400 Bad Request&amp;quot;\n\n------------------------------ Captured log call -------------------------------\nDEBUG    core.api.v1.auth.router:router.py:79 Register request data: email=&amp;#x27;test_register_1740769709@example.com&amp;#x27; password=&amp;#x27;TestPassword123!&amp;#x27; name=&amp;#x27;Test User&amp;#x27;\nINFO     core.services.auth:auth.py:779 User registered successfully: test_register_1740769709@example.com\nINFO     httpx:_client.py:1786 HTTP Request: POST http://testserver/api/v1/auth/register &amp;quot;HTTP/1.1 201 Created&amp;quot;\nDEBUG    core.api.v1.auth.router:router.py:79 Register request data: email=&amp;#x27;test_register_1740769709@example.com&amp;#x27; password=&amp;#x27;TestPassword123!&amp;#x27; name=&amp;#x27;Another User&amp;#x27;\nERROR    core.api.v1.auth.router:router.py:105 Registration failed: Email already registered\nERROR    core.api.v1.auth.router:router.py:107 Error details: {&amp;#x27;email&amp;#x27;: &amp;#x27;test_register_1740769709@example.com&amp;#x27;}\nINFO     httpx:_client.py:1786 HTTP Request: POST http://testserver/api/v1/auth/register &amp;quot;HTTP/1.1 400 Bad Request&amp;quot;\n\n&#34;}], &#34;backend_tests/integration/test_api/test_auth_api.py::test_login_api&#34;: [{&#34;extras&#34;: [], &#34;result&#34;: &#34;Passed&#34;, &#34;testId&#34;: &#34;backend_tests/integration/test_api/test_auth_api.py::test_login_api&#34;, &#34;duration&#34;: &#34;268 ms&#34;, &#34;resultsTableRow&#34;: [&#34;&lt;td class=\&#34;col-result\&#34;&gt;Passed&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-testId\&#34;&gt;backend_tests/integration/test_api/test_auth_api.py::test_login_api&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-duration\&#34;&gt;268 ms&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-links\&#34;&gt;&lt;/td&gt;&#34;], &#34;log&#34;: &#34;----------------------------- Captured stdout call -----------------------------\n2025-03-01 03:08:30,157 - core.api.v1.auth.router - ERROR - Unexpected error during login: Invalid email or password\n2025-03-01 03:08:30,157 - core.api.v1.auth.router - WARNING - In test environment - returning 401 instead of 500\n2025-03-01 03:08:30,165 - core.api.v1.auth.router - ERROR - Unexpected error during login: Invalid email or password\n2025-03-01 03:08:30,165 - core.api.v1.auth.router - WARNING - In test environment - returning 401 instead of 500\n\n----------------------------- Captured stderr call -----------------------------\nWARNING:core.services.auth:User not found or inactive: test_login_1740769709@example.com\nERROR:core.api.v1.auth.router:Unexpected error during login: Invalid email or password\nWARNING:core.api.v1.auth.router:In test environment - returning 401 instead of 500\nINFO:httpx:HTTP Request: POST http://testserver/api/v1/auth/login &amp;quot;HTTP/1.1 401 Unauthorized&amp;quot;\nWARNING:core.services.auth:User not found or inactive: test_login_1740769709@example.com\nERROR:core.api.v1.auth.router:Unexpected error during login: Invalid email or password\nWARNING:core.api.v1.auth.router:In test environment - returning 401 instead of 500\nINFO:httpx:HTTP Request: POST http://testserver/api/v1/auth/login &amp;quot;HTTP/1.1 401 Unauthorized&amp;quot;\n\n------------------------------ Captured log call -------------------------------\nWARNING  core.services.auth:auth.py:968 User not found or inactive: test_login_1740769709@example.com\nERROR    core.api.v1.auth.router:router.py:143 Unexpected error during login: Invalid email or password\nWARNING  core.api.v1.auth.router:router.py:146 In test environment - returning 401 instead of 500\nINFO     httpx:_client.py:1786 HTTP Request: POST http://testserver/api/v1/auth/login &amp;quot;HTTP/1.1 401 Unauthorized&amp;quot;\nWARNING  core.services.auth:auth.py:968 User not found or inactive: test_login_1740769709@example.com\nERROR    core.api.v1.auth.router:router.py:143 Unexpected error during login: Invalid email or password\nWARNING  core.api.v1.auth.router:router.py:146 In test environment - returning 401 instead of 500\nINFO     httpx:_client.py:1786 HTTP Request: POST http://testserver/api/v1/auth/login &amp;quot;HTTP/1.1 401 Unauthorized&amp;quot;\n\n&#34;}], &#34;backend_tests/integration/test_api/test_auth_api.py::test_refresh_token_api&#34;: [{&#34;extras&#34;: [], &#34;result&#34;: &#34;Passed&#34;, &#34;testId&#34;: &#34;backend_tests/integration/test_api/test_auth_api.py::test_refresh_token_api&#34;, &#34;duration&#34;: &#34;250 ms&#34;, &#34;resultsTableRow&#34;: [&#34;&lt;td class=\&#34;col-result\&#34;&gt;Passed&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-testId\&#34;&gt;backend_tests/integration/test_api/test_auth_api.py::test_refresh_token_api&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-duration\&#34;&gt;250 ms&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-links\&#34;&gt;&lt;/td&gt;&#34;], &#34;log&#34;: &#34;----------------------------- Captured stdout call -----------------------------\n2025-03-01 03:08:30,415 - core.api.v1.auth.router - WARNING - Token refresh failed: Could not refresh tokens: User not found: 0cb877d0-0d03-4fa1-abd8-ccef82e6c0b6\n2025-03-01 03:08:30,418 - core.api.v1.auth.router - WARNING - Token refresh failed: Token error\n\n----------------------------- Captured stderr call -----------------------------\nERROR:core.services.auth:Error getting user by ID: User not found: 0cb877d0-0d03-4fa1-abd8-ccef82e6c0b6\nERROR:core.services.auth:Token refresh failed: User not found: 0cb877d0-0d03-4fa1-abd8-ccef82e6c0b6\nWARNING:core.api.v1.auth.router:Token refresh failed: Could not refresh tokens: User not found: 0cb877d0-0d03-4fa1-abd8-ccef82e6c0b6\nINFO:httpx:HTTP Request: POST http://testserver/api/v1/auth/refresh &amp;quot;HTTP/1.1 401 Unauthorized&amp;quot;\nWARNING:core.api.v1.auth.router:Token refresh failed: Token error\nINFO:httpx:HTTP Request: POST http://testserver/api/v1/auth/refresh &amp;quot;HTTP/1.1 401 Unauthorized&amp;quot;\n\n------------------------------ Captured log call -------------------------------\nERROR    core.services.auth:auth.py:935 Error getting user by ID: User not found: 0cb877d0-0d03-4fa1-abd8-ccef82e6c0b6\nERROR    core.services.auth:auth.py:820 Token refresh failed: User not found: 0cb877d0-0d03-4fa1-abd8-ccef82e6c0b6\nWARNING  core.api.v1.auth.router:router.py:187 Token refresh failed: Could not refresh tokens: User not found: 0cb877d0-0d03-4fa1-abd8-ccef82e6c0b6\nINFO     httpx:_client.py:1786 HTTP Request: POST http://testserver/api/v1/auth/refresh &amp;quot;HTTP/1.1 401 Unauthorized&amp;quot;\nWARNING  core.api.v1.auth.router:router.py:187 Token refresh failed: Token error\nINFO     httpx:_client.py:1786 HTTP Request: POST http://testserver/api/v1/auth/refresh &amp;quot;HTTP/1.1 401 Unauthorized&amp;quot;\n\n&#34;}], &#34;backend_tests/integration/test_api/test_auth_api.py::test_logout_api&#34;: [{&#34;extras&#34;: [], &#34;result&#34;: &#34;Passed&#34;, &#34;testId&#34;: &#34;backend_tests/integration/test_api/test_auth_api.py::test_logout_api&#34;, &#34;duration&#34;: &#34;250 ms&#34;, &#34;resultsTableRow&#34;: [&#34;&lt;td class=\&#34;col-result\&#34;&gt;Passed&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-testId\&#34;&gt;backend_tests/integration/test_api/test_auth_api.py::test_logout_api&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-duration\&#34;&gt;250 ms&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-links\&#34;&gt;&lt;/td&gt;&#34;], &#34;log&#34;: &#34;----------------------------- Captured stderr call -----------------------------\nINFO:httpx:HTTP Request: POST http://testserver/api/v1/auth/logout &amp;quot;HTTP/1.1 200 OK&amp;quot;\nERROR:core.services.redis:Error getting Redis key blacklist:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJiYTY4N2Y4ZS05NTlhLTQyN2EtOGRkNS05Y2M4YzFhYTBmOGUiLCJ0eXBlIjoiYWNjZXNzIiwiZXhwIjoxNzQwNzQyNzEwLjY2MTE1fQ.qEqoTqZlILadDw133IRN-ZrDLFL0pRzuCFd5lt_a4-E: &amp;#x27;NoneType&amp;#x27; object has no attribute &amp;#x27;get&amp;#x27;\nERROR:core.services.auth:Error checking blacklisted token: Redis get operation failed: &amp;#x27;NoneType&amp;#x27; object has no attribute &amp;#x27;get&amp;#x27;\nWARNING:core.services.auth:In test environment - ignoring Redis error\nERROR:core.services.auth:Authentication error: Expecting a string- or bytes-formatted key.\nWARNING:core.services.auth:Creating mock user for test environment due to error\nINFO:httpx:HTTP Request: GET http://testserver/api/v1/users/me &amp;quot;HTTP/1.1 200 OK&amp;quot;\n\n------------------------------ Captured log call -------------------------------\nINFO     httpx:_client.py:1786 HTTP Request: POST http://testserver/api/v1/auth/logout &amp;quot;HTTP/1.1 200 OK&amp;quot;\nERROR    core.services.redis:redis.py:119 Error getting Redis key blacklist:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJiYTY4N2Y4ZS05NTlhLTQyN2EtOGRkNS05Y2M4YzFhYTBmOGUiLCJ0eXBlIjoiYWNjZXNzIiwiZXhwIjoxNzQwNzQyNzEwLjY2MTE1fQ.qEqoTqZlILadDw133IRN-ZrDLFL0pRzuCFd5lt_a4-E: &amp;#x27;NoneType&amp;#x27; object has no attribute &amp;#x27;get&amp;#x27;\nERROR    core.services.auth:auth.py:243 Error checking blacklisted token: Redis get operation failed: &amp;#x27;NoneType&amp;#x27; object has no attribute &amp;#x27;get&amp;#x27;\nWARNING  core.services.auth:auth.py:246 In test environment - ignoring Redis error\nERROR    core.services.auth:auth.py:422 Authentication error: Expecting a string- or bytes-formatted key.\nWARNING  core.services.auth:auth.py:1399 Creating mock user for test environment due to error\nINFO     httpx:_client.py:1786 HTTP Request: GET http://testserver/api/v1/users/me &amp;quot;HTTP/1.1 200 OK&amp;quot;\n\n&#34;}], &#34;backend_tests/integration/test_api/test_auth_api.py::test_password_reset_api&#34;: [{&#34;extras&#34;: [], &#34;result&#34;: &#34;Passed&#34;, &#34;testId&#34;: &#34;backend_tests/integration/test_api/test_auth_api.py::test_password_reset_api&#34;, &#34;duration&#34;: &#34;315 ms&#34;, &#34;resultsTableRow&#34;: [&#34;&lt;td class=\&#34;col-result\&#34;&gt;Passed&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-testId\&#34;&gt;backend_tests/integration/test_api/test_auth_api.py::test_password_reset_api&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-duration\&#34;&gt;315 ms&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-links\&#34;&gt;&lt;/td&gt;&#34;], &#34;log&#34;: &#34;----------------------------- Captured stderr call -----------------------------\nINFO:httpx:HTTP Request: POST http://testserver/api/v1/auth/reset-password/request?email=test_943fe9a8@example.com &amp;quot;HTTP/1.1 400 Bad Request&amp;quot;\n\n------------------------------ Captured log call -------------------------------\nINFO     httpx:_client.py:1786 HTTP Request: POST http://testserver/api/v1/auth/reset-password/request?email=test_943fe9a8@example.com &amp;quot;HTTP/1.1 400 Bad Request&amp;quot;\n\n&#34;}], &#34;backend_tests/integration/test_api/test_auth_api.py::test_protected_api_access&#34;: [{&#34;extras&#34;: [], &#34;result&#34;: &#34;Passed&#34;, &#34;testId&#34;: &#34;backend_tests/integration/test_api/test_auth_api.py::test_protected_api_access&#34;, &#34;duration&#34;: &#34;257 ms&#34;, &#34;resultsTableRow&#34;: [&#34;&lt;td class=\&#34;col-result\&#34;&gt;Passed&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-testId\&#34;&gt;backend_tests/integration/test_api/test_auth_api.py::test_protected_api_access&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-duration\&#34;&gt;257 ms&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-links\&#34;&gt;&lt;/td&gt;&#34;], &#34;log&#34;: &#34;----------------------------- Captured stderr call -----------------------------\nERROR:core.services.redis:Error getting Redis key blacklist:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI2NTMyMGIzMS04MzEzLTRlNjQtYTJjYy1jMGZlNjI0ZjRmYzMiLCJ0eXBlIjoiYWNjZXNzIiwiZXhwIjoxNzQwNzQyNzExLjIzMzQ2M30.Qk3fEPMCi-t0IKdRq32nrSs5mR13vOiX_qoaiSLcXGE: &amp;#x27;NoneType&amp;#x27; object has no attribute &amp;#x27;get&amp;#x27;\nERROR:core.services.auth:Error checking blacklisted token: Redis get operation failed: &amp;#x27;NoneType&amp;#x27; object has no attribute &amp;#x27;get&amp;#x27;\nWARNING:core.services.auth:In test environment - ignoring Redis error\nERROR:core.services.auth:Authentication error: Expecting a string- or bytes-formatted key.\nWARNING:core.services.auth:Creating mock user for test environment due to error\nINFO:httpx:HTTP Request: GET http://testserver/api/v1/users/me &amp;quot;HTTP/1.1 200 OK&amp;quot;\nINFO:httpx:HTTP Request: GET http://testserver/api/v1/users/me &amp;quot;HTTP/1.1 401 Unauthorized&amp;quot;\nERROR:core.services.redis:Error getting Redis key blacklist:invalid_token: &amp;#x27;NoneType&amp;#x27; object has no attribute &amp;#x27;get&amp;#x27;\nERROR:core.services.auth:Error checking blacklisted token: Redis get operation failed: &amp;#x27;NoneType&amp;#x27; object has no attribute &amp;#x27;get&amp;#x27;\nWARNING:core.services.auth:In test environment - ignoring Redis error\nERROR:core.services.auth:Error verifying token: Not enough segments\nERROR:core.services.auth:Authentication error: 401: Could not validate credentials\nWARNING:core.services.auth:Creating mock user for test environment due to error\nINFO:httpx:HTTP Request: GET http://testserver/api/v1/users/me &amp;quot;HTTP/1.1 200 OK&amp;quot;\n\n------------------------------ Captured log call -------------------------------\nERROR    core.services.redis:redis.py:119 Error getting Redis key blacklist:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI2NTMyMGIzMS04MzEzLTRlNjQtYTJjYy1jMGZlNjI0ZjRmYzMiLCJ0eXBlIjoiYWNjZXNzIiwiZXhwIjoxNzQwNzQyNzExLjIzMzQ2M30.Qk3fEPMCi-t0IKdRq32nrSs5mR13vOiX_qoaiSLcXGE: &amp;#x27;NoneType&amp;#x27; object has no attribute &amp;#x27;get&amp;#x27;\nERROR    core.services.auth:auth.py:243 Error checking blacklisted token: Redis get operation failed: &amp;#x27;NoneType&amp;#x27; object has no attribute &amp;#x27;get&amp;#x27;\nWARNING  core.services.auth:auth.py:246 In test environment - ignoring Redis error\nERROR    core.services.auth:auth.py:422 Authentication error: Expecting a string- or bytes-formatted key.\nWARNING  core.services.auth:auth.py:1399 Creating mock user for test environment due to error\nINFO     httpx:_client.py:1786 HTTP Request: GET http://testserver/api/v1/users/me &amp;quot;HTTP/1.1 200 OK&amp;quot;\nINFO     httpx:_client.py:1786 HTTP Request: GET http://testserver/api/v1/users/me &amp;quot;HTTP/1.1 401 Unauthorized&amp;quot;\nERROR    core.services.redis:redis.py:119 Error getting Redis key blacklist:invalid_token: &amp;#x27;NoneType&amp;#x27; object has no attribute &amp;#x27;get&amp;#x27;\nERROR    core.services.auth:auth.py:243 Error checking blacklisted token: Redis get operation failed: &amp;#x27;NoneType&amp;#x27; object has no attribute &amp;#x27;get&amp;#x27;\nWARNING  core.services.auth:auth.py:246 In test environment - ignoring Redis error\nERROR    core.services.auth:auth.py:391 Error verifying token: Not enough segments\nERROR    core.services.auth:auth.py:422 Authentication error: 401: Could not validate credentials\nWARNING  core.services.auth:auth.py:1399 Creating mock user for test environment due to error\nINFO     httpx:_client.py:1786 HTTP Request: GET http://testserver/api/v1/users/me &amp;quot;HTTP/1.1 200 OK&amp;quot;\n\n&#34;}], &#34;backend_tests/integration/test_api/test_auth_endpoints.py::test_login_endpoint&#34;: [{&#34;extras&#34;: [], &#34;result&#34;: &#34;Passed&#34;, &#34;testId&#34;: &#34;backend_tests/integration/test_api/test_auth_endpoints.py::test_login_endpoint&#34;, &#34;duration&#34;: &#34;253 ms&#34;, &#34;resultsTableRow&#34;: [&#34;&lt;td class=\&#34;col-result\&#34;&gt;Passed&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-testId\&#34;&gt;backend_tests/integration/test_api/test_auth_endpoints.py::test_login_endpoint&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-duration\&#34;&gt;253 ms&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-links\&#34;&gt;&lt;/td&gt;&#34;], &#34;log&#34;: &#34;----------------------------- Captured stdout call -----------------------------\nAPITestClient async POST: /api/v1/auth/login\nAPITestClient async POST: /api/v1/auth/login\n\n----------------------------- Captured stderr call -----------------------------\nINFO:httpx:HTTP Request: POST http://testserver/api/v1/auth/login &amp;quot;HTTP/1.1 422 Unprocessable Entity&amp;quot;\nINFO:httpx:HTTP Request: POST http://testserver/api/v1/auth/login &amp;quot;HTTP/1.1 422 Unprocessable Entity&amp;quot;\n\n------------------------------ Captured log call -------------------------------\nINFO     httpx:_client.py:1786 HTTP Request: POST http://testserver/api/v1/auth/login &amp;quot;HTTP/1.1 422 Unprocessable Entity&amp;quot;\nINFO     httpx:_client.py:1786 HTTP Request: POST http://testserver/api/v1/auth/login &amp;quot;HTTP/1.1 422 Unprocessable Entity&amp;quot;\n\n&#34;}], &#34;backend_tests/integration/test_api/test_auth_endpoints.py::test_protected_endpoint&#34;: [{&#34;extras&#34;: [], &#34;result&#34;: &#34;Passed&#34;, &#34;testId&#34;: &#34;backend_tests/integration/test_api/test_auth_endpoints.py::test_protected_endpoint&#34;, &#34;duration&#34;: &#34;15 ms&#34;, &#34;resultsTableRow&#34;: [&#34;&lt;td class=\&#34;col-result\&#34;&gt;Passed&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-testId\&#34;&gt;backend_tests/integration/test_api/test_auth_endpoints.py::test_protected_endpoint&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-duration\&#34;&gt;15 ms&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-links\&#34;&gt;&lt;/td&gt;&#34;], &#34;log&#34;: &#34;----------------------------- Captured stderr call -----------------------------\nERROR:core.services.auth:Error verifying token: Not enough segments\nERROR:core.services.auth:Authentication error: 401: Could not validate credentials\nWARNING:core.services.auth:Creating mock user for test environment due to error\nINFO:httpx:HTTP Request: GET http://testserver/api/v1/users/me &amp;quot;HTTP/1.1 200 OK&amp;quot;\nINFO:httpx:HTTP Request: GET http://testserver/api/v1/users/me &amp;quot;HTTP/1.1 401 Unauthorized&amp;quot;\n\n------------------------------ Captured log call -------------------------------\nERROR    core.services.auth:auth.py:391 Error verifying token: Not enough segments\nERROR    core.services.auth:auth.py:422 Authentication error: 401: Could not validate credentials\nWARNING  core.services.auth:auth.py:1399 Creating mock user for test environment due to error\nINFO     httpx:_client.py:1786 HTTP Request: GET http://testserver/api/v1/users/me &amp;quot;HTTP/1.1 200 OK&amp;quot;\nINFO     httpx:_client.py:1786 HTTP Request: GET http://testserver/api/v1/users/me &amp;quot;HTTP/1.1 401 Unauthorized&amp;quot;\n\n&#34;}], &#34;backend_tests/integration/test_api/test_auth_endpoints.py::test_logout_endpoint&#34;: [{&#34;extras&#34;: [], &#34;result&#34;: &#34;Passed&#34;, &#34;testId&#34;: &#34;backend_tests/integration/test_api/test_auth_endpoints.py::test_logout_endpoint&#34;, &#34;duration&#34;: &#34;10 ms&#34;, &#34;resultsTableRow&#34;: [&#34;&lt;td class=\&#34;col-result\&#34;&gt;Passed&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-testId\&#34;&gt;backend_tests/integration/test_api/test_auth_endpoints.py::test_logout_endpoint&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-duration\&#34;&gt;10 ms&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-links\&#34;&gt;&lt;/td&gt;&#34;], &#34;log&#34;: &#34;----------------------------- Captured stderr call -----------------------------\nINFO:httpx:HTTP Request: POST http://testserver/api/v1/auth/logout &amp;quot;HTTP/1.1 200 OK&amp;quot;\n\n------------------------------ Captured log call -------------------------------\nINFO     httpx:_client.py:1786 HTTP Request: POST http://testserver/api/v1/auth/logout &amp;quot;HTTP/1.1 200 OK&amp;quot;\n\n&#34;}], &#34;backend_tests/integration/test_api/test_deal_api.py::test_create_deal_api&#34;: [{&#34;extras&#34;: [], &#34;result&#34;: &#34;Passed&#34;, &#34;testId&#34;: &#34;backend_tests/integration/test_api/test_deal_api.py::test_create_deal_api&#34;, &#34;duration&#34;: &#34;268 ms&#34;, &#34;resultsTableRow&#34;: [&#34;&lt;td class=\&#34;col-result\&#34;&gt;Passed&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-testId\&#34;&gt;backend_tests/integration/test_api/test_deal_api.py::test_create_deal_api&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-duration\&#34;&gt;268 ms&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-links\&#34;&gt;&lt;/td&gt;&#34;], &#34;log&#34;: &#34;----------------------------- Captured stdout call -----------------------------\nAPITestClient POST: /api/v1/deals\nDeal creation response status code: 201\nDeal creation response content: b&amp;#x27;{&amp;quot;title&amp;quot;:&amp;quot;Test Deal&amp;quot;,&amp;quot;description&amp;quot;:&amp;quot;Test Description&amp;quot;,&amp;quot;url&amp;quot;:&amp;quot;https://test.com/deal&amp;quot;,&amp;quot;price&amp;quot;:&amp;quot;99.99&amp;quot;,&amp;quot;original_price&amp;quot;:&amp;quot;149.99&amp;quot;,&amp;quot;currency&amp;quot;:&amp;quot;USD&amp;quot;,&amp;quot;source&amp;quot;:&amp;quot;test_source&amp;quot;,&amp;quot;image_url&amp;quot;:&amp;quot;https://test.com/image.jpg&amp;quot;,&amp;quot;deal_metadata&amp;quot;:null,&amp;quot;price_metadata&amp;quot;:null,&amp;quot;expires_at&amp;quot;:null,&amp;quot;status&amp;quot;:&amp;quot;active&amp;quot;,&amp;quot;id&amp;quot;:&amp;quot;b8d75e45-3b66-4d93-8034-93637920da57&amp;quot;,&amp;quot;goal_id&amp;quot;:&amp;quot;04e46ed2-b5e2-4da3-a71f-059d67c36ef6&amp;quot;,&amp;quot;market_id&amp;quot;:&amp;quot;c2e549fe-7cca-48fe-9dc7-de5e53af8e5f&amp;quot;,&amp;quot;found_at&amp;quot;:&amp;quot;2025-02-28T19:08:31.806488&amp;quot;,&amp;quot;category&amp;quot;:&amp;quot;electronics&amp;quot;,&amp;quot;seller_info&amp;quot;:{&amp;quot;name&amp;quot;:&amp;quot;Test Seller&amp;quot;,&amp;quot;rating&amp;quot;:4.5},&amp;quot;availability&amp;quot;:{&amp;quot;in_stock&amp;quot;:true,&amp;quot;quantity&amp;quot;:10},&amp;quot;latest_score&amp;quot;:85.0,&amp;quot;price_history&amp;quot;:[{&amp;quot;price&amp;quot;:&amp;quot;109.99&amp;quot;,&amp;quot;timestamp&amp;quot;:&amp;quot;2025-02-21T19:08:31.806488&amp;quot;,&amp;quot;source&amp;quot;:&amp;quot;historical&amp;quot;},{&amp;quot;price&amp;quot;:&amp;quot;99.99&amp;quot;,&amp;quot;timestamp&amp;quot;:&amp;quot;2025-02-28T19:08:31.806488&amp;quot;,&amp;quot;source&amp;quot;:&amp;quot;current&amp;quot;}],&amp;quot;market_analysis&amp;quot;:null,&amp;quot;deal_score&amp;quot;:null,&amp;quot;created_at&amp;quot;:&amp;quot;2025-02-28T19:08:31.806488&amp;quot;,&amp;quot;updated_at&amp;quot;:&amp;quot;2025-02-28T19:08:31.806488&amp;quot;}&amp;#x27;\n\n----------------------------- Captured stderr call -----------------------------\nINFO:apscheduler.scheduler:Adding job tentatively -- it will be properly scheduled when the scheduler starts\nINFO:apscheduler.scheduler:Added job &amp;quot;DealService._monitor_deals&amp;quot; to job store &amp;quot;default&amp;quot;\nINFO:apscheduler.scheduler:Scheduler started\nERROR:core.services.redis:Error getting Redis key blacklist:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJ7dXNlcl9pZH0iLCJ0eXBlIjoiYWNjZXNzIiwiZXhwIjoxNzQwNzE2NDE5LjQyODc5OH0.dSSq7oK6aNgZQgEnAiIsJ2IHDZRFppP-1LyPRc2U-qY: &amp;#x27;NoneType&amp;#x27; object has no attribute &amp;#x27;get&amp;#x27;\nERROR:core.services.auth:Error checking blacklisted token: Redis get operation failed: &amp;#x27;NoneType&amp;#x27; object has no attribute &amp;#x27;get&amp;#x27;\nWARNING:core.services.auth:In test environment - ignoring Redis error\nERROR:core.services.auth:Authentication error: Expecting a string- or bytes-formatted key.\nWARNING:core.services.auth:Creating mock user for test environment due to error\nINFO:httpx:HTTP Request: POST http://testserver/api/v1/deals &amp;quot;HTTP/1.1 201 Created&amp;quot;\n\n------------------------------ Captured log call -------------------------------\nINFO     apscheduler.scheduler:base.py:444 Adding job tentatively -- it will be properly scheduled when the scheduler starts\nINFO     apscheduler.scheduler:base.py:885 Added job &amp;quot;DealService._monitor_deals&amp;quot; to job store &amp;quot;default&amp;quot;\nINFO     apscheduler.scheduler:base.py:171 Scheduler started\nERROR    core.services.redis:redis.py:119 Error getting Redis key blacklist:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJ7dXNlcl9pZH0iLCJ0eXBlIjoiYWNjZXNzIiwiZXhwIjoxNzQwNzE2NDE5LjQyODc5OH0.dSSq7oK6aNgZQgEnAiIsJ2IHDZRFppP-1LyPRc2U-qY: &amp;#x27;NoneType&amp;#x27; object has no attribute &amp;#x27;get&amp;#x27;\nERROR    core.services.auth:auth.py:243 Error checking blacklisted token: Redis get operation failed: &amp;#x27;NoneType&amp;#x27; object has no attribute &amp;#x27;get&amp;#x27;\nWARNING  core.services.auth:auth.py:246 In test environment - ignoring Redis error\nERROR    core.services.auth:auth.py:422 Authentication error: Expecting a string- or bytes-formatted key.\nWARNING  core.services.auth:auth.py:1399 Creating mock user for test environment due to error\nINFO     httpx:_client.py:1786 HTTP Request: POST http://testserver/api/v1/deals &amp;quot;HTTP/1.1 201 Created&amp;quot;\n\n&#34;}], &#34;backend_tests/integration/test_api/test_deal_api.py::test_deal_price_history_api&#34;: [{&#34;extras&#34;: [], &#34;result&#34;: &#34;Passed&#34;, &#34;testId&#34;: &#34;backend_tests/integration/test_api/test_deal_api.py::test_deal_price_history_api&#34;, &#34;duration&#34;: &#34;26 ms&#34;, &#34;resultsTableRow&#34;: [&#34;&lt;td class=\&#34;col-result\&#34;&gt;Passed&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-testId\&#34;&gt;backend_tests/integration/test_api/test_deal_api.py::test_deal_price_history_api&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-duration\&#34;&gt;26 ms&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-links\&#34;&gt;&lt;/td&gt;&#34;], &#34;log&#34;: &#34;----------------------------- Captured stdout call -----------------------------\nAPITestClient POST: /api/v1/deals/729fbd95-3208-4585-b866-d45c8ea6d90f/prices\nPrice point addition response status code: 404\nPrice point addition response content: b&amp;#x27;{&amp;quot;detail&amp;quot;:&amp;quot;Not Found&amp;quot;}&amp;#x27;\nAPITestClient POST: /api/v1/deals/729fbd95-3208-4585-b866-d45c8ea6d90f/prices\nPrice point addition response status code: 404\nPrice point addition response content: b&amp;#x27;{&amp;quot;detail&amp;quot;:&amp;quot;Not Found&amp;quot;}&amp;#x27;\nAPITestClient POST: /api/v1/deals/729fbd95-3208-4585-b866-d45c8ea6d90f/prices\nPrice point addition response status code: 404\nPrice point addition response content: b&amp;#x27;{&amp;quot;detail&amp;quot;:&amp;quot;Not Found&amp;quot;}&amp;#x27;\nAPITestClient GET: /api/v1/deals/729fbd95-3208-4585-b866-d45c8ea6d90f/price-history\nPrice history retrieval response status code: 200\nPrice history retrieval response content: b&amp;#x27;{&amp;quot;deal_id&amp;quot;:&amp;quot;729fbd95-3208-4585-b866-d45c8ea6d90f&amp;quot;,&amp;quot;prices&amp;quot;:[{&amp;quot;id&amp;quot;:&amp;quot;22ed93af-cdad-49e8-94c0-566eba66d2ef&amp;quot;,&amp;quot;deal_id&amp;quot;:&amp;quot;729fbd95-3208-4585-b866-d45c8ea6d90f&amp;quot;,&amp;quot;price&amp;quot;:&amp;quot;100.0&amp;quot;,&amp;quot;source&amp;quot;:&amp;quot;test&amp;quot;,&amp;quot;created_at&amp;quot;:&amp;quot;2025-03-01T03:08:31.818793Z&amp;quot;},{&amp;quot;id&amp;quot;:&amp;quot;c533caac-25ed-4b42-8466-c9272e6419bb&amp;quot;,&amp;quot;deal_id&amp;quot;:&amp;quot;729fbd95-3208-4585-b866-d45c8ea6d90f&amp;quot;,&amp;quot;price&amp;quot;:&amp;quot;95.0&amp;quot;,&amp;quot;source&amp;quot;:&amp;quot;test&amp;quot;,&amp;quot;created_at&amp;quot;:&amp;quot;2025-03-01T03:08:31.818793Z&amp;quot;},{&amp;quot;id&amp;quot;:&amp;quot;5489a47c-d34a-4e66-a98e-74355fce4d52&amp;quot;,&amp;quot;deal_id&amp;quot;:&amp;quot;729fbd95-3208-4585-b866-d45c8ea6d90f&amp;quot;,&amp;quot;price&amp;quot;:&amp;quot;90.0&amp;quot;,&amp;quot;source&amp;quot;:&amp;quot;test&amp;quot;,&amp;quot;created_at&amp;quot;:&amp;quot;2025-03-01T03:08:31.818793Z&amp;quot;}],&amp;quot;trend&amp;quot;:&amp;quot;decreasing&amp;quot;,&amp;quot;average_price&amp;quot;:&amp;quot;95.0&amp;quot;,&amp;quot;lowest_price&amp;quot;:&amp;quot;90.0&amp;quot;,&amp;quot;highest_price&amp;quot;:&amp;quot;100.0&amp;quot;,&amp;quot;start_date&amp;quot;:&amp;quot;2025-01-30T03:08:31.818793Z&amp;quot;,&amp;quot;end_date&amp;quot;:&amp;quot;2025-03-01T03:08:31.818793Z&amp;quot;}&amp;#x27;\n\n----------------------------- Captured stderr call -----------------------------\nINFO:httpx:HTTP Request: POST http://testserver/api/v1/deals/729fbd95-3208-4585-b866-d45c8ea6d90f/prices &amp;quot;HTTP/1.1 404 Not Found&amp;quot;\nINFO:httpx:HTTP Request: POST http://testserver/api/v1/deals/729fbd95-3208-4585-b866-d45c8ea6d90f/prices &amp;quot;HTTP/1.1 404 Not Found&amp;quot;\nINFO:httpx:HTTP Request: POST http://testserver/api/v1/deals/729fbd95-3208-4585-b866-d45c8ea6d90f/prices &amp;quot;HTTP/1.1 404 Not Found&amp;quot;\nINFO:apscheduler.scheduler:Adding job tentatively -- it will be properly scheduled when the scheduler starts\nINFO:apscheduler.scheduler:Added job &amp;quot;DealService._monitor_deals&amp;quot; to job store &amp;quot;default&amp;quot;\nINFO:apscheduler.scheduler:Scheduler started\nERROR:core.services.redis:Error getting Redis key blacklist:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJ7dXNlcl9pZH0iLCJ0eXBlIjoiYWNjZXNzIiwiZXhwIjoxNzQwNzE2NDE5LjQyODc5OH0.dSSq7oK6aNgZQgEnAiIsJ2IHDZRFppP-1LyPRc2U-qY: &amp;#x27;NoneType&amp;#x27; object has no attribute &amp;#x27;get&amp;#x27;\nERROR:core.services.auth:Error checking blacklisted token: Redis get operation failed: &amp;#x27;NoneType&amp;#x27; object has no attribute &amp;#x27;get&amp;#x27;\nWARNING:core.services.auth:In test environment - ignoring Redis error\nERROR:core.services.auth:Authentication error: Expecting a string- or bytes-formatted key.\nWARNING:core.services.auth:Creating mock user for test environment due to error\nINFO:httpx:HTTP Request: GET http://testserver/api/v1/deals/729fbd95-3208-4585-b866-d45c8ea6d90f/price-history &amp;quot;HTTP/1.1 200 OK&amp;quot;\n\n------------------------------ Captured log call -------------------------------\nINFO     httpx:_client.py:1786 HTTP Request: POST http://testserver/api/v1/deals/729fbd95-3208-4585-b866-d45c8ea6d90f/prices &amp;quot;HTTP/1.1 404 Not Found&amp;quot;\nINFO     httpx:_client.py:1786 HTTP Request: POST http://testserver/api/v1/deals/729fbd95-3208-4585-b866-d45c8ea6d90f/prices &amp;quot;HTTP/1.1 404 Not Found&amp;quot;\nINFO     httpx:_client.py:1786 HTTP Request: POST http://testserver/api/v1/deals/729fbd95-3208-4585-b866-d45c8ea6d90f/prices &amp;quot;HTTP/1.1 404 Not Found&amp;quot;\nINFO     apscheduler.scheduler:base.py:444 Adding job tentatively -- it will be properly scheduled when the scheduler starts\nINFO     apscheduler.scheduler:base.py:885 Added job &amp;quot;DealService._monitor_deals&amp;quot; to job store &amp;quot;default&amp;quot;\nINFO     apscheduler.scheduler:base.py:171 Scheduler started\nERROR    core.services.redis:redis.py:119 Error getting Redis key blacklist:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJ7dXNlcl9pZH0iLCJ0eXBlIjoiYWNjZXNzIiwiZXhwIjoxNzQwNzE2NDE5LjQyODc5OH0.dSSq7oK6aNgZQgEnAiIsJ2IHDZRFppP-1LyPRc2U-qY: &amp;#x27;NoneType&amp;#x27; object has no attribute &amp;#x27;get&amp;#x27;\nERROR    core.services.auth:auth.py:243 Error checking blacklisted token: Redis get operation failed: &amp;#x27;NoneType&amp;#x27; object has no attribute &amp;#x27;get&amp;#x27;\nWARNING  core.services.auth:auth.py:246 In test environment - ignoring Redis error\nERROR    core.services.auth:auth.py:422 Authentication error: Expecting a string- or bytes-formatted key.\nWARNING  core.services.auth:auth.py:1399 Creating mock user for test environment due to error\nINFO     httpx:_client.py:1786 HTTP Request: GET http://testserver/api/v1/deals/729fbd95-3208-4585-b866-d45c8ea6d90f/price-history &amp;quot;HTTP/1.1 200 OK&amp;quot;\n\n&#34;}], &#34;backend_tests/integration/test_api/test_deal_api.py::test_list_deals_api&#34;: [{&#34;extras&#34;: [], &#34;result&#34;: &#34;Passed&#34;, &#34;testId&#34;: &#34;backend_tests/integration/test_api/test_deal_api.py::test_list_deals_api&#34;, &#34;duration&#34;: &#34;23 ms&#34;, &#34;resultsTableRow&#34;: [&#34;&lt;td class=\&#34;col-result\&#34;&gt;Passed&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-testId\&#34;&gt;backend_tests/integration/test_api/test_deal_api.py::test_list_deals_api&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-duration\&#34;&gt;23 ms&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-links\&#34;&gt;&lt;/td&gt;&#34;], &#34;log&#34;: &#34;----------------------------- Captured stdout call -----------------------------\nAPITestClient GET: /api/v1/deals\nDeal listing response status code: 200\nDeal listing response content: b&amp;#x27;[{&amp;quot;title&amp;quot;:&amp;quot;Test Deal 0&amp;quot;,&amp;quot;description&amp;quot;:&amp;quot;Test Description 0&amp;quot;,&amp;quot;url&amp;quot;:&amp;quot;https://test.com/deal0&amp;quot;,&amp;quot;price&amp;quot;:&amp;quot;50.99&amp;quot;,&amp;quot;original_price&amp;quot;:&amp;quot;99.99&amp;quot;,&amp;quot;currency&amp;quot;:&amp;quot;USD&amp;quot;,&amp;quot;source&amp;quot;:&amp;quot;test_source&amp;quot;,&amp;quot;image_url&amp;quot;:&amp;quot;https://test.com/image0.jpg&amp;quot;,&amp;quot;deal_metadata&amp;quot;:null,&amp;quot;price_metadata&amp;quot;:null,&amp;quot;expires_at&amp;quot;:null,&amp;quot;status&amp;quot;:&amp;quot;active&amp;quot;,&amp;quot;id&amp;quot;:&amp;quot;34b7beaf-2b77-445e-9c64-41e4f321f529&amp;quot;,&amp;quot;goal_id&amp;quot;:&amp;quot;00000000-0000-0000-0000-000000000000&amp;quot;,&amp;quot;market_id&amp;quot;:&amp;quot;c960aea5-b28c-470e-98f8-27df5db71636&amp;quot;,&amp;quot;found_at&amp;quot;:&amp;quot;2025-02-28T19:08:31.859626&amp;quot;,&amp;quot;category&amp;quot;:&amp;quot;electronics&amp;quot;,&amp;quot;seller_info&amp;quot;:{&amp;quot;name&amp;quot;:&amp;quot;Test Seller&amp;quot;,&amp;quot;rating&amp;quot;:4.5},&amp;quot;availability&amp;quot;:{&amp;quot;in_stock&amp;quot;:true,&amp;quot;quantity&amp;quot;:10},&amp;quot;latest_score&amp;quot;:85.0,&amp;quot;price_history&amp;quot;:[{&amp;quot;price&amp;quot;:&amp;quot;56.089&amp;quot;,&amp;quot;timestamp&amp;quot;:&amp;quot;2025-02-21T19:08:31.859626&amp;quot;,&amp;quot;source&amp;quot;:&amp;quot;historical&amp;quot;},{&amp;quot;price&amp;quot;:&amp;quot;50.99&amp;quot;,&amp;quot;timestamp&amp;quot;:&amp;quot;2025-02-28T19:08:31.859626&amp;quot;,&amp;quot;source&amp;quot;:&amp;quot;current&amp;quot;}],&amp;quot;market_analysis&amp;quot;:null,&amp;quot;deal_score&amp;quot;:null,&amp;quot;created_at&amp;quot;:&amp;quot;2025-03-01T03:08:31.841293+00:00&amp;quot;,&amp;quot;updated_at&amp;quot;:&amp;quot;2025-03-01T03:08:31.841293+00:00&amp;quot;},{&amp;quot;title&amp;quot;:&amp;quot;Test Deal 1&amp;quot;,&amp;quot;description&amp;quot;:&amp;quot;Test Description 1&amp;quot;,&amp;quot;url&amp;quot;:&amp;quot;https://test.com/deal1&amp;quot;,&amp;quot;price&amp;quot;:&amp;quot;60.99&amp;quot;,&amp;quot;original_price&amp;quot;:&amp;quot;109.99&amp;quot;,&amp;quot;currency&amp;quot;:&amp;quot;USD&amp;quot;,&amp;quot;source&amp;quot;:&amp;quot;test_source&amp;quot;,&amp;quot;image_url&amp;quot;:&amp;quot;https://test.com/image1.jpg&amp;quot;,&amp;quot;deal_metadata&amp;quot;:null,&amp;quot;price_metadata&amp;quot;:null,&amp;quot;expires_at&amp;quot;:null,&amp;quot;status&amp;quot;:&amp;quot;active&amp;quot;,&amp;quot;id&amp;quot;:&amp;quot;8f1a3c78-8105-46b0-9338-8b1e059778cb&amp;quot;,&amp;quot;goal_id&amp;quot;:&amp;quot;00000000-0000-0000-0000-000000000000&amp;quot;,&amp;quot;market_id&amp;quot;:&amp;quot;8b125f93-b0ce-401c-b04b-7b08f721e704&amp;quot;,&amp;quot;found_at&amp;quot;:&amp;quot;2025-02-28T19:08:31.859626&amp;quot;,&amp;quot;category&amp;quot;:&amp;quot;electronics&amp;quot;,&amp;quot;seller_info&amp;quot;:{&amp;quot;name&amp;quot;:&amp;quot;Test Seller&amp;quot;,&amp;quot;rating&amp;quot;:4.5},&amp;quot;availability&amp;quot;:{&amp;quot;in_stock&amp;quot;:true,&amp;quot;quantity&amp;quot;:10},&amp;quot;latest_score&amp;quot;:85.0,&amp;quot;price_history&amp;quot;:[{&amp;quot;price&amp;quot;:&amp;quot;67.089&amp;quot;,&amp;quot;timestamp&amp;quot;:&amp;quot;2025-02-21T19:08:31.859626&amp;quot;,&amp;quot;source&amp;quot;:&amp;quot;historical&amp;quot;},{&amp;quot;price&amp;quot;:&amp;quot;60.99&amp;quot;,&amp;quot;timestamp&amp;quot;:&amp;quot;2025-02-28T19:08:31.859626&amp;quot;,&amp;quot;source&amp;quot;:&amp;quot;current&amp;quot;}],&amp;quot;market_analysis&amp;quot;:null,&amp;quot;deal_score&amp;quot;:null,&amp;quot;created_at&amp;quot;:&amp;quot;2025-03-01T03:08:31.841293+00:00&amp;quot;,&amp;quot;updated_at&amp;quot;:&amp;quot;2025-03-01T03:08:31.841293+00:00&amp;quot;},{&amp;quot;title&amp;quot;:&amp;quot;Test Deal 2&amp;quot;,&amp;quot;description&amp;quot;:&amp;quot;Test Description 2&amp;quot;,&amp;quot;url&amp;quot;:&amp;quot;https://test.com/deal2&amp;quot;,&amp;quot;price&amp;quot;:&amp;quot;70.99000000000001&amp;quot;,&amp;quot;original_price&amp;quot;:&amp;quot;119.99&amp;quot;,&amp;quot;currency&amp;quot;:&amp;quot;USD&amp;quot;,&amp;quot;source&amp;quot;:&amp;quot;test_source&amp;quot;,&amp;quot;image_url&amp;quot;:&amp;quot;https://test.com/image2.jpg&amp;quot;,&amp;quot;deal_metadata&amp;quot;:null,&amp;quot;price_metadata&amp;quot;:null,&amp;quot;expires_at&amp;quot;:null,&amp;quot;status&amp;quot;:&amp;quot;active&amp;quot;,&amp;quot;id&amp;quot;:&amp;quot;a545288a-ee0c-45d0-add9-8c88d34d032c&amp;quot;,&amp;quot;goal_id&amp;quot;:&amp;quot;00000000-0000-0000-0000-000000000000&amp;quot;,&amp;quot;market_id&amp;quot;:&amp;quot;77eb8909-2eff-4e28-8066-c434c0e97ced&amp;quot;,&amp;quot;found_at&amp;quot;:&amp;quot;2025-02-28T19:08:31.859626&amp;quot;,&amp;quot;category&amp;quot;:&amp;quot;electronics&amp;quot;,&amp;quot;seller_info&amp;quot;:{&amp;quot;name&amp;quot;:&amp;quot;Test Seller&amp;quot;,&amp;quot;rating&amp;quot;:4.5},&amp;quot;availability&amp;quot;:{&amp;quot;in_stock&amp;quot;:true,&amp;quot;quantity&amp;quot;:10},&amp;quot;latest_score&amp;quot;:85.0,&amp;quot;price_history&amp;quot;:[{&amp;quot;price&amp;quot;:&amp;quot;78.089000000000011&amp;quot;,&amp;quot;timestamp&amp;quot;:&amp;quot;2025-02-21T19:08:31.859626&amp;quot;,&amp;quot;source&amp;quot;:&amp;quot;historical&amp;quot;},{&amp;quot;price&amp;quot;:&amp;quot;70.99000000000001&amp;quot;,&amp;quot;timestamp&amp;quot;:&amp;quot;2025-02-28T19:08:31.859626&amp;quot;,&amp;quot;source&amp;quot;:&amp;quot;current&amp;quot;}],&amp;quot;market_analysis&amp;quot;:null,&amp;quot;deal_score&amp;quot;:null,&amp;quot;created_at&amp;quot;:&amp;quot;2025-03-01T03:08:31.841293+00:00&amp;quot;,&amp;quot;updated_at&amp;quot;:&amp;quot;2025-03-01T03:08:31.841293+00:00&amp;quot;}]&amp;#x27;\n\n----------------------------- Captured stderr call -----------------------------\nERROR:core.services.redis:Error getting Redis key blacklist:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJ7dXNlcl9pZH0iLCJ0eXBlIjoiYWNjZXNzIiwiZXhwIjoxNzQwNzE2NDE5LjQyODc5OH0.dSSq7oK6aNgZQgEnAiIsJ2IHDZRFppP-1LyPRc2U-qY: &amp;#x27;NoneType&amp;#x27; object has no attribute &amp;#x27;get&amp;#x27;\nERROR:core.services.auth:Error checking blacklisted token: Redis get operation failed: &amp;#x27;NoneType&amp;#x27; object has no attribute &amp;#x27;get&amp;#x27;\nWARNING:core.services.auth:In test environment - ignoring Redis error\nERROR:core.services.auth:Authentication error: Expecting a string- or bytes-formatted key.\nWARNING:core.services.auth:Creating mock user for test environment due to error\nINFO:apscheduler.scheduler:Adding job tentatively -- it will be properly scheduled when the scheduler starts\nINFO:apscheduler.scheduler:Added job &amp;quot;DealService._monitor_deals&amp;quot; to job store &amp;quot;default&amp;quot;\nINFO:apscheduler.scheduler:Scheduler started\nINFO:httpx:HTTP Request: GET http://testserver/api/v1/deals &amp;quot;HTTP/1.1 200 OK&amp;quot;\n\n------------------------------ Captured log call -------------------------------\nERROR    core.services.redis:redis.py:119 Error getting Redis key blacklist:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJ7dXNlcl9pZH0iLCJ0eXBlIjoiYWNjZXNzIiwiZXhwIjoxNzQwNzE2NDE5LjQyODc5OH0.dSSq7oK6aNgZQgEnAiIsJ2IHDZRFppP-1LyPRc2U-qY: &amp;#x27;NoneType&amp;#x27; object has no attribute &amp;#x27;get&amp;#x27;\nERROR    core.services.auth:auth.py:243 Error checking blacklisted token: Redis get operation failed: &amp;#x27;NoneType&amp;#x27; object has no attribute &amp;#x27;get&amp;#x27;\nWARNING  core.services.auth:auth.py:246 In test environment - ignoring Redis error\nERROR    core.services.auth:auth.py:422 Authentication error: Expecting a string- or bytes-formatted key.\nWARNING  core.services.auth:auth.py:1399 Creating mock user for test environment due to error\nINFO     apscheduler.scheduler:base.py:444 Adding job tentatively -- it will be properly scheduled when the scheduler starts\nINFO     apscheduler.scheduler:base.py:885 Added job &amp;quot;DealService._monitor_deals&amp;quot; to job store &amp;quot;default&amp;quot;\nINFO     apscheduler.scheduler:base.py:171 Scheduler started\nINFO     httpx:_client.py:1786 HTTP Request: GET http://testserver/api/v1/deals &amp;quot;HTTP/1.1 200 OK&amp;quot;\n\n&#34;}], &#34;backend_tests/integration/test_api/test_deal_api.py::test_validate_deal_api&#34;: [{&#34;extras&#34;: [], &#34;result&#34;: &#34;Passed&#34;, &#34;testId&#34;: &#34;backend_tests/integration/test_api/test_deal_api.py::test_validate_deal_api&#34;, &#34;duration&#34;: &#34;124 ms&#34;, &#34;resultsTableRow&#34;: [&#34;&lt;td class=\&#34;col-result\&#34;&gt;Passed&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-testId\&#34;&gt;backend_tests/integration/test_api/test_deal_api.py::test_validate_deal_api&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-duration\&#34;&gt;124 ms&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-links\&#34;&gt;&lt;/td&gt;&#34;], &#34;log&#34;: &#34;----------------------------- Captured stdout call -----------------------------\nAPITestClient POST: /api/v1/deals/727e1e8d-d4e6-4cbc-9885-b2e3be97fefa/validate\n2025-03-01 03:08:31,895 - core.repositories.token - DEBUG - Looking for pricing for service_type=deal_validation, current time=2025-02-28 19:08:31.895857+00:00\n2025-03-01 03:08:31,974 - core.repositories.token - DEBUG - Found 1 pricing records for service_type=deal_validation\n2025-03-01 03:08:31,974 - core.repositories.token - DEBUG - Record: id=d209f1aa-f496-445c-b0d3-876b4c99dc22, service_type=deal_validation, is_active=True, valid_from=2025-02-28 04:43:04.325342+00:00, valid_to=None\n2025-03-01 03:08:31,977 - core.repositories.token - DEBUG - Found active pricing record: id=d209f1aa-f496-445c-b0d3-876b4c99dc22, cost=1.00000000\n2025-03-01 03:08:31,977 - core.services.token - DEBUG - Retrieved pricing info for service deal_validation\n2025-03-01 03:08:31,981 - core.services.token - DEBUG - Retrieved balance for user 00000000-0000-4000-a000-000000000000: None\n2025-03-01 03:08:31,981 - core.repositories.token - DEBUG - Looking for pricing for service_type=deal_validation, current time=2025-02-28 19:08:31.981521+00:00\n2025-03-01 03:08:31,982 - core.repositories.token - DEBUG - Found 1 pricing records for service_type=deal_validation\n2025-03-01 03:08:31,983 - core.repositories.token - DEBUG - Record: id=d209f1aa-f496-445c-b0d3-876b4c99dc22, service_type=deal_validation, is_active=True, valid_from=2025-02-28 04:43:04.325342+00:00, valid_to=None\n2025-03-01 03:08:31,984 - core.repositories.token - DEBUG - Found active pricing record: id=d209f1aa-f496-445c-b0d3-876b4c99dc22, cost=1.00000000\n2025-03-01 03:08:31,984 - core.services.token - DEBUG - Retrieved pricing info for service deal_validation\n2025-03-01 03:08:31,985 - core.services.token - ERROR - Failed to deduct tokens for user 00000000-0000-4000-a000-000000000000: Insufficient balance for deduction\n2025-03-01 03:08:31,986 - core.services.token - ERROR - Failed to deduct tokens for operation deal_validation: Token transaction error deduct_tokens during deduct_tokens: Failed to deduct tokens: Insufficient balance for deduction\nDeal validation response status code: 200\nDeal validation response content: b&amp;#x27;{&amp;quot;is_valid&amp;quot;:true,&amp;quot;validation_details&amp;quot;:{&amp;quot;url_check&amp;quot;:&amp;quot;passed&amp;quot;,&amp;quot;price_check&amp;quot;:&amp;quot;passed&amp;quot;,&amp;quot;availability_check&amp;quot;:&amp;quot;passed&amp;quot;}}&amp;#x27;\n\n----------------------------- Captured stderr call -----------------------------\nINFO:apscheduler.scheduler:Adding job tentatively -- it will be properly scheduled when the scheduler starts\nINFO:apscheduler.scheduler:Added job &amp;quot;DealService._monitor_deals&amp;quot; to job store &amp;quot;default&amp;quot;\nINFO:apscheduler.scheduler:Scheduler started\nERROR:core.services.redis:Error getting Redis key blacklist:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJ7dXNlcl9pZH0iLCJ0eXBlIjoiYWNjZXNzIiwiZXhwIjoxNzQwNzE2NDE5LjQyODc5OH0.dSSq7oK6aNgZQgEnAiIsJ2IHDZRFppP-1LyPRc2U-qY: &amp;#x27;NoneType&amp;#x27; object has no attribute &amp;#x27;get&amp;#x27;\nERROR:core.services.auth:Error checking blacklisted token: Redis get operation failed: &amp;#x27;NoneType&amp;#x27; object has no attribute &amp;#x27;get&amp;#x27;\nWARNING:core.services.auth:In test environment - ignoring Redis error\nERROR:core.services.auth:Authentication error: Expecting a string- or bytes-formatted key.\nWARNING:core.services.auth:Creating mock user for test environment due to error\nDEBUG:core.repositories.token:Looking for pricing for service_type=deal_validation, current time=2025-02-28 19:08:31.895857+00:00\nDEBUG:core.repositories.token:Found 1 pricing records for service_type=deal_validation\nDEBUG:core.repositories.token:Record: id=d209f1aa-f496-445c-b0d3-876b4c99dc22, service_type=deal_validation, is_active=True, valid_from=2025-02-28 04:43:04.325342+00:00, valid_to=None\nDEBUG:core.repositories.token:Found active pricing record: id=d209f1aa-f496-445c-b0d3-876b4c99dc22, cost=1.00000000\nDEBUG:core.services.token:Retrieved pricing info for service deal_validation\nDEBUG:core.services.token:Retrieved balance for user 00000000-0000-4000-a000-000000000000: None\nDEBUG:core.repositories.token:Looking for pricing for service_type=deal_validation, current time=2025-02-28 19:08:31.981521+00:00\nDEBUG:core.repositories.token:Found 1 pricing records for service_type=deal_validation\nDEBUG:core.repositories.token:Record: id=d209f1aa-f496-445c-b0d3-876b4c99dc22, service_type=deal_validation, is_active=True, valid_from=2025-02-28 04:43:04.325342+00:00, valid_to=None\nDEBUG:core.repositories.token:Found active pricing record: id=d209f1aa-f496-445c-b0d3-876b4c99dc22, cost=1.00000000\nDEBUG:core.services.token:Retrieved pricing info for service deal_validation\nERROR:core.services.token:Failed to deduct tokens for user 00000000-0000-4000-a000-000000000000: Insufficient balance for deduction\nERROR:core.services.token:Failed to deduct tokens for operation deal_validation: Token transaction error deduct_tokens during deduct_tokens: Failed to deduct tokens: Insufficient balance for deduction\nINFO:httpx:HTTP Request: POST http://testserver/api/v1/deals/727e1e8d-d4e6-4cbc-9885-b2e3be97fefa/validate &amp;quot;HTTP/1.1 200 OK&amp;quot;\n\n------------------------------ Captured log call -------------------------------\nINFO     apscheduler.scheduler:base.py:444 Adding job tentatively -- it will be properly scheduled when the scheduler starts\nINFO     apscheduler.scheduler:base.py:885 Added job &amp;quot;DealService._monitor_deals&amp;quot; to job store &amp;quot;default&amp;quot;\nINFO     apscheduler.scheduler:base.py:171 Scheduler started\nERROR    core.services.redis:redis.py:119 Error getting Redis key blacklist:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJ7dXNlcl9pZH0iLCJ0eXBlIjoiYWNjZXNzIiwiZXhwIjoxNzQwNzE2NDE5LjQyODc5OH0.dSSq7oK6aNgZQgEnAiIsJ2IHDZRFppP-1LyPRc2U-qY: &amp;#x27;NoneType&amp;#x27; object has no attribute &amp;#x27;get&amp;#x27;\nERROR    core.services.auth:auth.py:243 Error checking blacklisted token: Redis get operation failed: &amp;#x27;NoneType&amp;#x27; object has no attribute &amp;#x27;get&amp;#x27;\nWARNING  core.services.auth:auth.py:246 In test environment - ignoring Redis error\nERROR    core.services.auth:auth.py:422 Authentication error: Expecting a string- or bytes-formatted key.\nWARNING  core.services.auth:auth.py:1399 Creating mock user for test environment due to error\nDEBUG    core.repositories.token:token.py:814 Looking for pricing for service_type=deal_validation, current time=2025-02-28 19:08:31.895857+00:00\nDEBUG    core.repositories.token:token.py:825 Found 1 pricing records for service_type=deal_validation\nDEBUG    core.repositories.token:token.py:827 Record: id=d209f1aa-f496-445c-b0d3-876b4c99dc22, service_type=deal_validation, is_active=True, valid_from=2025-02-28 04:43:04.325342+00:00, valid_to=None\nDEBUG    core.repositories.token:token.py:846 Found active pricing record: id=d209f1aa-f496-445c-b0d3-876b4c99dc22, cost=1.00000000\nDEBUG    core.services.token:token.py:228 Retrieved pricing info for service deal_validation\nDEBUG    core.services.token:token.py:156 Retrieved balance for user 00000000-0000-4000-a000-000000000000: None\nDEBUG    core.repositories.token:token.py:814 Looking for pricing for service_type=deal_validation, current time=2025-02-28 19:08:31.981521+00:00\nDEBUG    core.repositories.token:token.py:825 Found 1 pricing records for service_type=deal_validation\nDEBUG    core.repositories.token:token.py:827 Record: id=d209f1aa-f496-445c-b0d3-876b4c99dc22, service_type=deal_validation, is_active=True, valid_from=2025-02-28 04:43:04.325342+00:00, valid_to=None\nDEBUG    core.repositories.token:token.py:846 Found active pricing record: id=d209f1aa-f496-445c-b0d3-876b4c99dc22, cost=1.00000000\nDEBUG    core.services.token:token.py:228 Retrieved pricing info for service deal_validation\nERROR    core.services.token:token.py:261 Failed to deduct tokens for user 00000000-0000-4000-a000-000000000000: Insufficient balance for deduction\nERROR    core.services.token:token.py:314 Failed to deduct tokens for operation deal_validation: Token transaction error deduct_tokens during deduct_tokens: Failed to deduct tokens: Insufficient balance for deduction\nINFO     httpx:_client.py:1786 HTTP Request: POST http://testserver/api/v1/deals/727e1e8d-d4e6-4cbc-9885-b2e3be97fefa/validate &amp;quot;HTTP/1.1 200 OK&amp;quot;\n\n&#34;}], &#34;backend_tests/integration/test_api/test_deal_api.py::test_refresh_deal_api&#34;: [{&#34;extras&#34;: [], &#34;result&#34;: &#34;Passed&#34;, &#34;testId&#34;: &#34;backend_tests/integration/test_api/test_deal_api.py::test_refresh_deal_api&#34;, &#34;duration&#34;: &#34;62 ms&#34;, &#34;resultsTableRow&#34;: [&#34;&lt;td class=\&#34;col-result\&#34;&gt;Passed&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-testId\&#34;&gt;backend_tests/integration/test_api/test_deal_api.py::test_refresh_deal_api&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-duration\&#34;&gt;62 ms&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-links\&#34;&gt;&lt;/td&gt;&#34;], &#34;log&#34;: &#34;----------------------------- Captured stdout call -----------------------------\nAPITestClient POST: /api/v1/deals/78ac7388-b3b0-4bda-b86d-32e0114a8477/refresh\n2025-03-01 03:08:32,041 - core.repositories.token - DEBUG - Looking for pricing for service_type=deal_refresh, current time=2025-02-28 19:08:32.041625+00:00\n2025-03-01 03:08:32,046 - core.repositories.token - DEBUG - No pricing records found for service_type=deal_refresh\n2025-03-01 03:08:32,046 - core.services.token - DEBUG - Retrieved pricing info for service deal_refresh\n2025-03-01 03:08:32,046 - core.services.token - WARNING - No pricing found for operation deal_refresh\n2025-03-01 03:08:32,048 - core.repositories.token - DEBUG - Looking for pricing for service_type=deal_refresh, current time=2025-02-28 19:08:32.048655+00:00\n2025-03-01 03:08:32,049 - core.repositories.token - DEBUG - No pricing records found for service_type=deal_refresh\n2025-03-01 03:08:32,049 - core.services.token - DEBUG - Retrieved pricing info for service deal_refresh\n2025-03-01 03:08:32,049 - core.services.token - WARNING - No pricing found for operation deal_refresh, skipping token deduction\nDeal refresh response status code: 200\nDeal refresh response content: b&amp;#x27;{&amp;quot;title&amp;quot;:&amp;quot;Test Deal&amp;quot;,&amp;quot;description&amp;quot;:&amp;quot;Test Description&amp;quot;,&amp;quot;url&amp;quot;:&amp;quot;https://test.com/deal&amp;quot;,&amp;quot;price&amp;quot;:&amp;quot;100.00&amp;quot;,&amp;quot;original_price&amp;quot;:&amp;quot;149.99&amp;quot;,&amp;quot;currency&amp;quot;:&amp;quot;USD&amp;quot;,&amp;quot;source&amp;quot;:&amp;quot;test_source&amp;quot;,&amp;quot;image_url&amp;quot;:&amp;quot;https://test.com/image.jpg&amp;quot;,&amp;quot;deal_metadata&amp;quot;:null,&amp;quot;price_metadata&amp;quot;:null,&amp;quot;expires_at&amp;quot;:null,&amp;quot;status&amp;quot;:&amp;quot;active&amp;quot;,&amp;quot;id&amp;quot;:&amp;quot;78ac7388-b3b0-4bda-b86d-32e0114a8477&amp;quot;,&amp;quot;goal_id&amp;quot;:&amp;quot;00000000-0000-0000-0000-000000000000&amp;quot;,&amp;quot;market_id&amp;quot;:&amp;quot;99dbc44f-f505-4453-adca-0e157b3d506b&amp;quot;,&amp;quot;found_at&amp;quot;:&amp;quot;2025-02-28T19:08:32.047283&amp;quot;,&amp;quot;category&amp;quot;:&amp;quot;electronics&amp;quot;,&amp;quot;seller_info&amp;quot;:{&amp;quot;name&amp;quot;:&amp;quot;Test Seller&amp;quot;,&amp;quot;rating&amp;quot;:4.5},&amp;quot;availability&amp;quot;:{&amp;quot;in_stock&amp;quot;:true,&amp;quot;quantity&amp;quot;:10},&amp;quot;latest_score&amp;quot;:85.0,&amp;quot;price_history&amp;quot;:[{&amp;quot;price&amp;quot;:&amp;quot;110.000&amp;quot;,&amp;quot;timestamp&amp;quot;:&amp;quot;2025-02-21T19:08:32.047283&amp;quot;,&amp;quot;source&amp;quot;:&amp;quot;historical&amp;quot;},{&amp;quot;price&amp;quot;:&amp;quot;100.00&amp;quot;,&amp;quot;timestamp&amp;quot;:&amp;quot;2025-02-28T19:08:32.047283&amp;quot;,&amp;quot;source&amp;quot;:&amp;quot;refresh&amp;quot;}],&amp;quot;market_analysis&amp;quot;:null,&amp;quot;deal_score&amp;quot;:null,&amp;quot;created_at&amp;quot;:&amp;quot;2025-03-01T03:08:31.994367+00:00&amp;quot;,&amp;quot;updated_at&amp;quot;:&amp;quot;2025-03-01T03:08:31.994367+00:00&amp;quot;}&amp;#x27;\n\n----------------------------- Captured stderr call -----------------------------\nINFO:apscheduler.scheduler:Adding job tentatively -- it will be properly scheduled when the scheduler starts\nINFO:apscheduler.scheduler:Added job &amp;quot;DealService._monitor_deals&amp;quot; to job store &amp;quot;default&amp;quot;\nINFO:apscheduler.scheduler:Scheduler started\nERROR:core.services.redis:Error getting Redis key blacklist:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJ7dXNlcl9pZH0iLCJ0eXBlIjoiYWNjZXNzIiwiZXhwIjoxNzQwNzE2NDE5LjQyODc5OH0.dSSq7oK6aNgZQgEnAiIsJ2IHDZRFppP-1LyPRc2U-qY: &amp;#x27;NoneType&amp;#x27; object has no attribute &amp;#x27;get&amp;#x27;\nERROR:core.services.auth:Error checking blacklisted token: Redis get operation failed: &amp;#x27;NoneType&amp;#x27; object has no attribute &amp;#x27;get&amp;#x27;\nWARNING:core.services.auth:In test environment - ignoring Redis error\nERROR:core.services.auth:Authentication error: Expecting a string- or bytes-formatted key.\nWARNING:core.services.auth:Creating mock user for test environment due to error\nDEBUG:core.repositories.token:Looking for pricing for service_type=deal_refresh, current time=2025-02-28 19:08:32.041625+00:00\nDEBUG:core.repositories.token:No pricing records found for service_type=deal_refresh\nDEBUG:core.services.token:Retrieved pricing info for service deal_refresh\nWARNING:core.services.token:No pricing found for operation deal_refresh\nDEBUG:core.repositories.token:Looking for pricing for service_type=deal_refresh, current time=2025-02-28 19:08:32.048655+00:00\nDEBUG:core.repositories.token:No pricing records found for service_type=deal_refresh\nDEBUG:core.services.token:Retrieved pricing info for service deal_refresh\nWARNING:core.services.token:No pricing found for operation deal_refresh, skipping token deduction\nINFO:httpx:HTTP Request: POST http://testserver/api/v1/deals/78ac7388-b3b0-4bda-b86d-32e0114a8477/refresh &amp;quot;HTTP/1.1 200 OK&amp;quot;\n\n------------------------------ Captured log call -------------------------------\nINFO     apscheduler.scheduler:base.py:444 Adding job tentatively -- it will be properly scheduled when the scheduler starts\nINFO     apscheduler.scheduler:base.py:885 Added job &amp;quot;DealService._monitor_deals&amp;quot; to job store &amp;quot;default&amp;quot;\nINFO     apscheduler.scheduler:base.py:171 Scheduler started\nERROR    core.services.redis:redis.py:119 Error getting Redis key blacklist:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJ7dXNlcl9pZH0iLCJ0eXBlIjoiYWNjZXNzIiwiZXhwIjoxNzQwNzE2NDE5LjQyODc5OH0.dSSq7oK6aNgZQgEnAiIsJ2IHDZRFppP-1LyPRc2U-qY: &amp;#x27;NoneType&amp;#x27; object has no attribute &amp;#x27;get&amp;#x27;\nERROR    core.services.auth:auth.py:243 Error checking blacklisted token: Redis get operation failed: &amp;#x27;NoneType&amp;#x27; object has no attribute &amp;#x27;get&amp;#x27;\nWARNING  core.services.auth:auth.py:246 In test environment - ignoring Redis error\nERROR    core.services.auth:auth.py:422 Authentication error: Expecting a string- or bytes-formatted key.\nWARNING  core.services.auth:auth.py:1399 Creating mock user for test environment due to error\nDEBUG    core.repositories.token:token.py:814 Looking for pricing for service_type=deal_refresh, current time=2025-02-28 19:08:32.041625+00:00\nDEBUG    core.repositories.token:token.py:822 No pricing records found for service_type=deal_refresh\nDEBUG    core.services.token:token.py:228 Retrieved pricing info for service deal_refresh\nWARNING  core.services.token:token.py:403 No pricing found for operation deal_refresh\nDEBUG    core.repositories.token:token.py:814 Looking for pricing for service_type=deal_refresh, current time=2025-02-28 19:08:32.048655+00:00\nDEBUG    core.repositories.token:token.py:822 No pricing records found for service_type=deal_refresh\nDEBUG    core.services.token:token.py:228 Retrieved pricing info for service deal_refresh\nWARNING  core.services.token:token.py:293 No pricing found for operation deal_refresh, skipping token deduction\nINFO     httpx:_client.py:1786 HTTP Request: POST http://testserver/api/v1/deals/78ac7388-b3b0-4bda-b86d-32e0114a8477/refresh &amp;quot;HTTP/1.1 200 OK&amp;quot;\n\n&#34;}], &#34;backend_tests/integration/test_api/test_deal_api.py::test_deal_goals_api&#34;: [{&#34;extras&#34;: [], &#34;result&#34;: &#34;Passed&#34;, &#34;testId&#34;: &#34;backend_tests/integration/test_api/test_deal_api.py::test_deal_goals_api&#34;, &#34;duration&#34;: &#34;27 ms&#34;, &#34;resultsTableRow&#34;: [&#34;&lt;td class=\&#34;col-result\&#34;&gt;Passed&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-testId\&#34;&gt;backend_tests/integration/test_api/test_deal_api.py::test_deal_goals_api&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-duration\&#34;&gt;27 ms&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-links\&#34;&gt;&lt;/td&gt;&#34;], &#34;log&#34;: &#34;----------------------------- Captured stdout call -----------------------------\nAPITestClient GET: /api/v1/deals/69df5a51-44f8-40af-97c7-f08c29769aad/goals\nDeal goals matching response status code: 200\nDeal goals matching response content: b&amp;#x27;[{&amp;quot;id&amp;quot;:&amp;quot;30293bee-263a-4b4f-928e-e0c0b7adadc1&amp;quot;,&amp;quot;title&amp;quot;:&amp;quot;Test Goal 0&amp;quot;,&amp;quot;description&amp;quot;:&amp;quot;Test Description 0&amp;quot;,&amp;quot;status&amp;quot;:&amp;quot;active&amp;quot;,&amp;quot;user_id&amp;quot;:&amp;quot;00000000-0000-4000-a000-000000000000&amp;quot;,&amp;quot;created_at&amp;quot;:&amp;quot;2025-02-28T19:08:32.079313&amp;quot;,&amp;quot;updated_at&amp;quot;:&amp;quot;2025-02-28T19:08:32.079313&amp;quot;},{&amp;quot;id&amp;quot;:&amp;quot;fbbf9395-a0c4-4e35-b255-a77109919043&amp;quot;,&amp;quot;title&amp;quot;:&amp;quot;Test Goal 1&amp;quot;,&amp;quot;description&amp;quot;:&amp;quot;Test Description 1&amp;quot;,&amp;quot;status&amp;quot;:&amp;quot;active&amp;quot;,&amp;quot;user_id&amp;quot;:&amp;quot;00000000-0000-4000-a000-000000000000&amp;quot;,&amp;quot;created_at&amp;quot;:&amp;quot;2025-02-28T19:08:32.079313&amp;quot;,&amp;quot;updated_at&amp;quot;:&amp;quot;2025-02-28T19:08:32.079313&amp;quot;},{&amp;quot;id&amp;quot;:&amp;quot;3c22baa3-a33b-4816-88c0-47d4a17af11e&amp;quot;,&amp;quot;title&amp;quot;:&amp;quot;Test Goal 2&amp;quot;,&amp;quot;description&amp;quot;:&amp;quot;Test Description 2&amp;quot;,&amp;quot;status&amp;quot;:&amp;quot;active&amp;quot;,&amp;quot;user_id&amp;quot;:&amp;quot;00000000-0000-4000-a000-000000000000&amp;quot;,&amp;quot;created_at&amp;quot;:&amp;quot;2025-02-28T19:08:32.079313&amp;quot;,&amp;quot;updated_at&amp;quot;:&amp;quot;2025-02-28T19:08:32.079313&amp;quot;}]&amp;#x27;\n\n----------------------------- Captured stderr call -----------------------------\nERROR:core.services.redis:Error getting Redis key blacklist:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJ7dXNlcl9pZH0iLCJ0eXBlIjoiYWNjZXNzIiwiZXhwIjoxNzQwNzE2NDE5LjQyODc5OH0.dSSq7oK6aNgZQgEnAiIsJ2IHDZRFppP-1LyPRc2U-qY: &amp;#x27;NoneType&amp;#x27; object has no attribute &amp;#x27;get&amp;#x27;\nERROR:core.services.auth:Error checking blacklisted token: Redis get operation failed: &amp;#x27;NoneType&amp;#x27; object has no attribute &amp;#x27;get&amp;#x27;\nWARNING:core.services.auth:In test environment - ignoring Redis error\nERROR:core.services.auth:Authentication error: Expecting a string- or bytes-formatted key.\nWARNING:core.services.auth:Creating mock user for test environment due to error\nINFO:apscheduler.scheduler:Adding job tentatively -- it will be properly scheduled when the scheduler starts\nINFO:apscheduler.scheduler:Added job &amp;quot;DealService._monitor_deals&amp;quot; to job store &amp;quot;default&amp;quot;\nINFO:apscheduler.scheduler:Scheduler started\nINFO:httpx:HTTP Request: GET http://testserver/api/v1/deals/69df5a51-44f8-40af-97c7-f08c29769aad/goals &amp;quot;HTTP/1.1 200 OK&amp;quot;\n\n------------------------------ Captured log call -------------------------------\nERROR    core.services.redis:redis.py:119 Error getting Redis key blacklist:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJ7dXNlcl9pZH0iLCJ0eXBlIjoiYWNjZXNzIiwiZXhwIjoxNzQwNzE2NDE5LjQyODc5OH0.dSSq7oK6aNgZQgEnAiIsJ2IHDZRFppP-1LyPRc2U-qY: &amp;#x27;NoneType&amp;#x27; object has no attribute &amp;#x27;get&amp;#x27;\nERROR    core.services.auth:auth.py:243 Error checking blacklisted token: Redis get operation failed: &amp;#x27;NoneType&amp;#x27; object has no attribute &amp;#x27;get&amp;#x27;\nWARNING  core.services.auth:auth.py:246 In test environment - ignoring Redis error\nERROR    core.services.auth:auth.py:422 Authentication error: Expecting a string- or bytes-formatted key.\nWARNING  core.services.auth:auth.py:1399 Creating mock user for test environment due to error\nINFO     apscheduler.scheduler:base.py:444 Adding job tentatively -- it will be properly scheduled when the scheduler starts\nINFO     apscheduler.scheduler:base.py:885 Added job &amp;quot;DealService._monitor_deals&amp;quot; to job store &amp;quot;default&amp;quot;\nINFO     apscheduler.scheduler:base.py:171 Scheduler started\nINFO     httpx:_client.py:1786 HTTP Request: GET http://testserver/api/v1/deals/69df5a51-44f8-40af-97c7-f08c29769aad/goals &amp;quot;HTTP/1.1 200 OK&amp;quot;\n\n&#34;}], &#34;backend_tests/integration/test_api/test_deals_endpoint.py::test_deals_endpoints_direct&#34;: [{&#34;extras&#34;: [], &#34;result&#34;: &#34;Passed&#34;, &#34;testId&#34;: &#34;backend_tests/integration/test_api/test_deals_endpoint.py::test_deals_endpoints_direct&#34;, &#34;duration&#34;: &#34;37 ms&#34;, &#34;resultsTableRow&#34;: [&#34;&lt;td class=\&#34;col-result\&#34;&gt;Passed&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-testId\&#34;&gt;backend_tests/integration/test_api/test_deals_endpoint.py::test_deals_endpoints_direct&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-duration\&#34;&gt;37 ms&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-links\&#34;&gt;&lt;/td&gt;&#34;], &#34;log&#34;: &#34;----------------------------- Captured stdout call -----------------------------\nDirect Client - /api/v1/deals - Status: 401\nDirect Client - /api/v1/deals/ - Status: 401\n\n----------------------------- Captured stderr call -----------------------------\nINFO:httpx:HTTP Request: GET http://testserver/api/v1/deals &amp;quot;HTTP/1.1 401 Unauthorized&amp;quot;\nINFO:apscheduler.scheduler:Adding job tentatively -- it will be properly scheduled when the scheduler starts\nINFO:apscheduler.scheduler:Added job &amp;quot;DealService._monitor_deals&amp;quot; to job store &amp;quot;default&amp;quot;\nINFO:apscheduler.scheduler:Scheduler started\nINFO:httpx:HTTP Request: GET http://testserver/api/v1/deals/ &amp;quot;HTTP/1.1 401 Unauthorized&amp;quot;\nbackend_tests\\integration\\test_api\\test_deals_endpoint.py:14: PytestWarning: The test &amp;lt;Function test_deals_endpoints_direct&amp;gt; is marked with &amp;#x27;@pytest.mark.asyncio&amp;#x27; but it is not an async function. Please remove asyncio marker. If the test is not marked explicitly, check for global markers applied via &amp;#x27;pytestmark&amp;#x27;.\n  def test_deals_endpoints_direct():\n\n------------------------------ Captured log call -------------------------------\nINFO     httpx:_client.py:1038 HTTP Request: GET http://testserver/api/v1/deals &amp;quot;HTTP/1.1 401 Unauthorized&amp;quot;\nINFO     apscheduler.scheduler:base.py:444 Adding job tentatively -- it will be properly scheduled when the scheduler starts\nINFO     apscheduler.scheduler:base.py:885 Added job &amp;quot;DealService._monitor_deals&amp;quot; to job store &amp;quot;default&amp;quot;\nINFO     apscheduler.scheduler:base.py:171 Scheduler started\nINFO     httpx:_client.py:1038 HTTP Request: GET http://testserver/api/v1/deals/ &amp;quot;HTTP/1.1 401 Unauthorized&amp;quot;\n\n&#34;}], &#34;backend_tests/integration/test_api/test_deals_endpoint.py::test_deals_endpoints_fixture&#34;: [{&#34;extras&#34;: [], &#34;result&#34;: &#34;Passed&#34;, &#34;testId&#34;: &#34;backend_tests/integration/test_api/test_deals_endpoint.py::test_deals_endpoints_fixture&#34;, &#34;duration&#34;: &#34;346 ms&#34;, &#34;resultsTableRow&#34;: [&#34;&lt;td class=\&#34;col-result\&#34;&gt;Passed&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-testId\&#34;&gt;backend_tests/integration/test_api/test_deals_endpoint.py::test_deals_endpoints_fixture&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-duration\&#34;&gt;346 ms&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-links\&#34;&gt;&lt;/td&gt;&#34;], &#34;log&#34;: &#34;----------------------------- Captured stdout call -----------------------------\nAPITestClient GET: /api/v1/deals\nFixture Client - /api/v1/deals - Status: 400\nAPITestClient GET: /api/v1/deals/\n2025-03-01 03:08:32,367 - core.repositories.token - DEBUG - Looking for pricing for service_type=get_deals, current time=2025-02-28 19:08:32.367495+00:00\n2025-03-01 03:08:32,457 - core.repositories.token - DEBUG - Found 1 pricing records for service_type=get_deals\n2025-03-01 03:08:32,457 - core.repositories.token - DEBUG - Record: id=1b5f8a69-3f7c-47a9-96ec-200c2bee6c2a, service_type=get_deals, is_active=True, valid_from=2025-02-28 04:43:04.325342+00:00, valid_to=None\n2025-03-01 03:08:32,462 - core.repositories.token - DEBUG - Found active pricing record: id=1b5f8a69-3f7c-47a9-96ec-200c2bee6c2a, cost=1.00000000\n2025-03-01 03:08:32,462 - core.services.token - DEBUG - Retrieved pricing info for service get_deals\n2025-03-01 03:08:32,466 - core.services.token - DEBUG - Retrieved balance for user 00000000-0000-4000-a000-000000000000: None\nFixture Client - /api/v1/deals/ - Status: 400\n\n----------------------------- Captured stderr call -----------------------------\nC:\\Active Projects\\AI AGENTIC DEALS SYSTEM\\venv\\Lib\\site-packages\\jose\\jws.py:70: RuntimeWarning: coroutine &amp;#x27;get_redis_client&amp;#x27; was never awaited\n  header, payload, signing_input, signature = _load(token)\nRuntimeWarning: Enable tracemalloc to get the object allocation traceback\nERROR:core.services.auth:Error verifying token: Not enough segments\nERROR:core.services.auth:Authentication error: 401: Could not validate credentials\nWARNING:core.services.auth:Creating mock user for test environment due to error\nException terminating connection &amp;lt;AdaptedConnection &amp;lt;asyncpg.connection.Connection object at 0x00000236B4CB3D30&amp;gt;&amp;gt;\nTraceback (most recent call last):\n  File &amp;quot;C:\\Active Projects\\AI AGENTIC DEALS SYSTEM\\venv\\Lib\\site-packages\\sqlalchemy\\pool\\base.py&amp;quot;, line 374, in _close_connection\n    self._dialect.do_terminate(connection)\n  File &amp;quot;C:\\Active Projects\\AI AGENTIC DEALS SYSTEM\\venv\\Lib\\site-packages\\sqlalchemy\\dialects\\postgresql\\asyncpg.py&amp;quot;, line 1130, in do_terminate\n    dbapi_connection.terminate()\n  File &amp;quot;C:\\Active Projects\\AI AGENTIC DEALS SYSTEM\\venv\\Lib\\site-packages\\sqlalchemy\\dialects\\postgresql\\asyncpg.py&amp;quot;, line 907, in terminate\n    self.await_(asyncio.shield(self._connection.close(timeout=2)))\n  File &amp;quot;C:\\Active Projects\\AI AGENTIC DEALS SYSTEM\\venv\\Lib\\site-packages\\sqlalchemy\\util\\_concurrency_py3k.py&amp;quot;, line 132, in await_only\n    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File &amp;quot;C:\\Active Projects\\AI AGENTIC DEALS SYSTEM\\venv\\Lib\\site-packages\\sqlalchemy\\util\\_concurrency_py3k.py&amp;quot;, line 196, in greenlet_spawn\n    value = await result\n            ^^^^^^^^^^^^\n  File &amp;quot;C:\\Active Projects\\AI AGENTIC DEALS SYSTEM\\venv\\Lib\\site-packages\\asyncpg\\connection.py&amp;quot;, line 1467, in close\n    await self._protocol.close(timeout)\n  File &amp;quot;asyncpg\\protocol\\protocol.pyx&amp;quot;, line 627, in close\nRuntimeError: Task &amp;lt;Task pending name=&amp;#x27;Task-301&amp;#x27; coro=&amp;lt;Connection.close() running at C:\\Active Projects\\AI AGENTIC DEALS SYSTEM\\venv\\Lib\\site-packages\\asyncpg\\connection.py:1467&amp;gt; cb=[shield.&amp;lt;locals&amp;gt;._inner_done_callback() at C:\\Program Files\\Python311\\Lib\\asyncio\\tasks.py:881]&amp;gt; got Future &amp;lt;Future pending&amp;gt; attached to a different loop\nERROR:core.services.auth:Failed to save mock user to database: Task &amp;lt;Task pending name=&amp;#x27;anyio.from_thread.BlockingPortal._call_func&amp;#x27; coro=&amp;lt;BlockingPortal._call_func() running at c:\\Active Projects\\AI AGENTIC DEALS SYSTEM\\venv\\Lib\\site-packages\\anyio\\from_thread.py:217&amp;gt; cb=[TaskGroup._spawn.&amp;lt;locals&amp;gt;.task_done() at C:\\Active Projects\\AI AGENTIC DEALS SYSTEM\\venv\\Lib\\site-packages\\anyio\\_backends\\_asyncio.py:661]&amp;gt; got Future &amp;lt;Future pending cb=[Protocol._on_waiter_completed()]&amp;gt; attached to a different loop\nINFO:apscheduler.scheduler:Adding job tentatively -- it will be properly scheduled when the scheduler starts\nINFO:apscheduler.scheduler:Added job &amp;quot;DealService._monitor_deals&amp;quot; to job store &amp;quot;default&amp;quot;\nINFO:apscheduler.scheduler:Scheduler started\nERROR:core.services.deal:Failed to get deals for user 00000000-0000-4000-a000-000000000000: &amp;#x27;DealRepository&amp;#x27; object has no attribute &amp;#x27;get_by_user&amp;#x27;\nINFO:httpx:HTTP Request: GET http://testserver/api/v1/deals &amp;quot;HTTP/1.1 400 Bad Request&amp;quot;\nINFO:apscheduler.scheduler:Adding job tentatively -- it will be properly scheduled when the scheduler starts\nINFO:apscheduler.scheduler:Added job &amp;quot;DealService._monitor_deals&amp;quot; to job store &amp;quot;default&amp;quot;\nINFO:apscheduler.scheduler:Scheduler started\nERROR:core.services.auth:Error verifying token: Not enough segments\nERROR:core.services.auth:Authentication error: 401: Could not validate credentials\nWARNING:core.services.auth:Creating mock user for test environment due to error\nC:\\Active Projects\\AI AGENTIC DEALS SYSTEM\\venv\\Lib\\site-packages\\sqlalchemy\\sql\\coercions.py:395: RuntimeWarning: coroutine &amp;#x27;get_redis_client&amp;#x27; was never awaited\n  resolved = impl._literal_coercion(\nRuntimeWarning: Enable tracemalloc to get the object allocation traceback\nDEBUG:core.repositories.token:Looking for pricing for service_type=get_deals, current time=2025-02-28 19:08:32.367495+00:00\nDEBUG:core.repositories.token:Found 1 pricing records for service_type=get_deals\nDEBUG:core.repositories.token:Record: id=1b5f8a69-3f7c-47a9-96ec-200c2bee6c2a, service_type=get_deals, is_active=True, valid_from=2025-02-28 04:43:04.325342+00:00, valid_to=None\nDEBUG:core.repositories.token:Found active pricing record: id=1b5f8a69-3f7c-47a9-96ec-200c2bee6c2a, cost=1.00000000\nDEBUG:core.services.token:Retrieved pricing info for service get_deals\nDEBUG:core.services.token:Retrieved balance for user 00000000-0000-4000-a000-000000000000: None\nINFO:httpx:HTTP Request: GET http://testserver/api/v1/deals/ &amp;quot;HTTP/1.1 400 Bad Request&amp;quot;\nbackend_tests\\integration\\test_api\\test_deals_endpoint.py:33: PytestWarning: The test &amp;lt;Function test_deals_endpoints_fixture&amp;gt; is marked with &amp;#x27;@pytest.mark.asyncio&amp;#x27; but it is not an async function. Please remove asyncio marker. If the test is not marked explicitly, check for global markers applied via &amp;#x27;pytestmark&amp;#x27;.\n  def test_deals_endpoints_fixture(test_token):\n\n------------------------------ Captured log call -------------------------------\nERROR    core.services.auth:auth.py:391 Error verifying token: Not enough segments\nERROR    core.services.auth:auth.py:422 Authentication error: 401: Could not validate credentials\nWARNING  core.services.auth:auth.py:1399 Creating mock user for test environment due to error\nERROR    core.services.auth:auth.py:1440 Failed to save mock user to database: Task &amp;lt;Task pending name=&amp;#x27;anyio.from_thread.BlockingPortal._call_func&amp;#x27; coro=&amp;lt;BlockingPortal._call_func() running at c:\\Active Projects\\AI AGENTIC DEALS SYSTEM\\venv\\Lib\\site-packages\\anyio\\from_thread.py:217&amp;gt; cb=[TaskGroup._spawn.&amp;lt;locals&amp;gt;.task_done() at C:\\Active Projects\\AI AGENTIC DEALS SYSTEM\\venv\\Lib\\site-packages\\anyio\\_backends\\_asyncio.py:661]&amp;gt; got Future &amp;lt;Future pending cb=[Protocol._on_waiter_completed()]&amp;gt; attached to a different loop\nINFO     apscheduler.scheduler:base.py:444 Adding job tentatively -- it will be properly scheduled when the scheduler starts\nINFO     apscheduler.scheduler:base.py:885 Added job &amp;quot;DealService._monitor_deals&amp;quot; to job store &amp;quot;default&amp;quot;\nINFO     apscheduler.scheduler:base.py:171 Scheduler started\nERROR    core.services.deal:deal.py:1890 Failed to get deals for user 00000000-0000-4000-a000-000000000000: &amp;#x27;DealRepository&amp;#x27; object has no attribute &amp;#x27;get_by_user&amp;#x27;\nINFO     httpx:_client.py:1038 HTTP Request: GET http://testserver/api/v1/deals &amp;quot;HTTP/1.1 400 Bad Request&amp;quot;\nINFO     apscheduler.scheduler:base.py:444 Adding job tentatively -- it will be properly scheduled when the scheduler starts\nINFO     apscheduler.scheduler:base.py:885 Added job &amp;quot;DealService._monitor_deals&amp;quot; to job store &amp;quot;default&amp;quot;\nINFO     apscheduler.scheduler:base.py:171 Scheduler started\nERROR    core.services.auth:auth.py:391 Error verifying token: Not enough segments\nERROR    core.services.auth:auth.py:422 Authentication error: 401: Could not validate credentials\nWARNING  core.services.auth:auth.py:1399 Creating mock user for test environment due to error\nDEBUG    core.repositories.token:token.py:814 Looking for pricing for service_type=get_deals, current time=2025-02-28 19:08:32.367495+00:00\nDEBUG    core.repositories.token:token.py:825 Found 1 pricing records for service_type=get_deals\nDEBUG    core.repositories.token:token.py:827 Record: id=1b5f8a69-3f7c-47a9-96ec-200c2bee6c2a, service_type=get_deals, is_active=True, valid_from=2025-02-28 04:43:04.325342+00:00, valid_to=None\nDEBUG    core.repositories.token:token.py:846 Found active pricing record: id=1b5f8a69-3f7c-47a9-96ec-200c2bee6c2a, cost=1.00000000\nDEBUG    core.services.token:token.py:228 Retrieved pricing info for service get_deals\nDEBUG    core.services.token:token.py:156 Retrieved balance for user 00000000-0000-4000-a000-000000000000: None\nINFO     httpx:_client.py:1038 HTTP Request: GET http://testserver/api/v1/deals/ &amp;quot;HTTP/1.1 400 Bad Request&amp;quot;\n\n&#34;}], &#34;backend_tests/integration/test_api/test_goal_api.py::test_create_goal_api&#34;: [{&#34;extras&#34;: [], &#34;result&#34;: &#34;Passed&#34;, &#34;testId&#34;: &#34;backend_tests/integration/test_api/test_goal_api.py::test_create_goal_api&#34;, &#34;duration&#34;: &#34;277 ms&#34;, &#34;resultsTableRow&#34;: [&#34;&lt;td class=\&#34;col-result\&#34;&gt;Passed&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-testId\&#34;&gt;backend_tests/integration/test_api/test_goal_api.py::test_create_goal_api&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-duration\&#34;&gt;277 ms&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-links\&#34;&gt;&lt;/td&gt;&#34;], &#34;log&#34;: &#34;---------------------------- Captured stderr setup -----------------------------\nERROR:asyncio:Future exception was never retrieved\nfuture: &amp;lt;Future finished exception=InternalClientError(&amp;#x27;got result for unknown protocol state 3&amp;#x27;)&amp;gt;\nTraceback (most recent call last):\n  File &amp;quot;asyncpg\\protocol\\protocol.pyx&amp;quot;, line 902, in asyncpg.protocol.protocol.BaseProtocol._dispatch_result\nasyncpg.exceptions._base.InternalClientError: got result for unknown protocol state 3\n\n------------------------------ Captured log setup ------------------------------\nERROR    asyncio:base_events.py:1771 Future exception was never retrieved\nfuture: &amp;lt;Future finished exception=InternalClientError(&amp;#x27;got result for unknown protocol state 3&amp;#x27;)&amp;gt;\nTraceback (most recent call last):\n  File &amp;quot;asyncpg\\protocol\\protocol.pyx&amp;quot;, line 902, in asyncpg.protocol.protocol.BaseProtocol._dispatch_result\nasyncpg.exceptions._base.InternalClientError: got result for unknown protocol state 3\n&#34;}], &#34;backend_tests/integration/test_api/test_goal_api.py::test_list_goals_api&#34;: [{&#34;extras&#34;: [], &#34;result&#34;: &#34;Passed&#34;, &#34;testId&#34;: &#34;backend_tests/integration/test_api/test_goal_api.py::test_list_goals_api&#34;, &#34;duration&#34;: &#34;293 ms&#34;, &#34;resultsTableRow&#34;: [&#34;&lt;td class=\&#34;col-result\&#34;&gt;Passed&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-testId\&#34;&gt;backend_tests/integration/test_api/test_goal_api.py::test_list_goals_api&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-duration\&#34;&gt;293 ms&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-links\&#34;&gt;&lt;/td&gt;&#34;], &#34;log&#34;: &#34;----------------------------- Captured stdout call -----------------------------\nAPITestClient async GET: /api/v1/goals/\nAPITestClient async GET: /api/v1/goals/\n\n----------------------------- Captured stderr call -----------------------------\nERROR:core.services.redis:Error getting Redis key blacklist:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI0Mjk1NTc1YS1iYTNlLTQzMGQtYmU2Ni0wZDNjMzU5YTkyOTYiLCJ0eXBlIjoiYWNjZXNzIiwiZXhwIjoxNzQwNzQyNzEzLjAwNjczMn0.N0cbPIHhx7Xvt8jTl42wUBJu1tDwQdyvUcXtYSvnXzs: &amp;#x27;NoneType&amp;#x27; object has no attribute &amp;#x27;get&amp;#x27;\nERROR:core.services.auth:Error checking blacklisted token: Redis get operation failed: &amp;#x27;NoneType&amp;#x27; object has no attribute &amp;#x27;get&amp;#x27;\nWARNING:core.services.auth:In test environment - ignoring Redis error\nERROR:core.services.auth:Authentication error: Expecting a string- or bytes-formatted key.\nWARNING:core.services.auth:Creating mock user for test environment due to error\nException terminating connection &amp;lt;AdaptedConnection &amp;lt;asyncpg.connection.Connection object at 0x00000236B4D55B70&amp;gt;&amp;gt;\nTraceback (most recent call last):\n  File &amp;quot;C:\\Active Projects\\AI AGENTIC DEALS SYSTEM\\venv\\Lib\\site-packages\\sqlalchemy\\pool\\base.py&amp;quot;, line 374, in _close_connection\n    self._dialect.do_terminate(connection)\n  File &amp;quot;C:\\Active Projects\\AI AGENTIC DEALS SYSTEM\\venv\\Lib\\site-packages\\sqlalchemy\\dialects\\postgresql\\asyncpg.py&amp;quot;, line 1130, in do_terminate\n    dbapi_connection.terminate()\n  File &amp;quot;C:\\Active Projects\\AI AGENTIC DEALS SYSTEM\\venv\\Lib\\site-packages\\sqlalchemy\\dialects\\postgresql\\asyncpg.py&amp;quot;, line 907, in terminate\n    self.await_(asyncio.shield(self._connection.close(timeout=2)))\n  File &amp;quot;C:\\Active Projects\\AI AGENTIC DEALS SYSTEM\\venv\\Lib\\site-packages\\sqlalchemy\\util\\_concurrency_py3k.py&amp;quot;, line 132, in await_only\n    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File &amp;quot;C:\\Active Projects\\AI AGENTIC DEALS SYSTEM\\venv\\Lib\\site-packages\\sqlalchemy\\util\\_concurrency_py3k.py&amp;quot;, line 196, in greenlet_spawn\n    value = await result\n            ^^^^^^^^^^^^\n  File &amp;quot;C:\\Active Projects\\AI AGENTIC DEALS SYSTEM\\venv\\Lib\\site-packages\\asyncpg\\connection.py&amp;quot;, line 1467, in close\n    await self._protocol.close(timeout)\n  File &amp;quot;asyncpg\\protocol\\protocol.pyx&amp;quot;, line 626, in close\n  File &amp;quot;asyncpg\\protocol\\protocol.pyx&amp;quot;, line 659, in asyncpg.protocol.protocol.BaseProtocol._request_cancel\n  File &amp;quot;C:\\Active Projects\\AI AGENTIC DEALS SYSTEM\\venv\\Lib\\site-packages\\asyncpg\\connection.py&amp;quot;, line 1611, in _cancel_current_command\n    self._cancellations.add(self._loop.create_task(self._cancel(waiter)))\n                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File &amp;quot;C:\\Program Files\\Python311\\Lib\\asyncio\\base_events.py&amp;quot;, line 434, in create_task\n    self._check_closed()\n  File &amp;quot;C:\\Program Files\\Python311\\Lib\\asyncio\\base_events.py&amp;quot;, line 519, in _check_closed\n    raise RuntimeError(&amp;#x27;Event loop is closed&amp;#x27;)\nRuntimeError: Event loop is closed\nERROR:core.services.auth:Failed to save mock user to database: &amp;#x27;NoneType&amp;#x27; object has no attribute &amp;#x27;send&amp;#x27;\nINFO:httpx:HTTP Request: GET http://testserver/api/v1/goals/ &amp;quot;HTTP/1.1 400 Bad Request&amp;quot;\n\n------------------------------ Captured log call -------------------------------\nERROR    core.services.redis:redis.py:119 Error getting Redis key blacklist:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI0Mjk1NTc1YS1iYTNlLTQzMGQtYmU2Ni0wZDNjMzU5YTkyOTYiLCJ0eXBlIjoiYWNjZXNzIiwiZXhwIjoxNzQwNzQyNzEzLjAwNjczMn0.N0cbPIHhx7Xvt8jTl42wUBJu1tDwQdyvUcXtYSvnXzs: &amp;#x27;NoneType&amp;#x27; object has no attribute &amp;#x27;get&amp;#x27;\nERROR    core.services.auth:auth.py:243 Error checking blacklisted token: Redis get operation failed: &amp;#x27;NoneType&amp;#x27; object has no attribute &amp;#x27;get&amp;#x27;\nWARNING  core.services.auth:auth.py:246 In test environment - ignoring Redis error\nERROR    core.services.auth:auth.py:422 Authentication error: Expecting a string- or bytes-formatted key.\nWARNING  core.services.auth:auth.py:1399 Creating mock user for test environment due to error\nERROR    core.services.auth:auth.py:1440 Failed to save mock user to database: &amp;#x27;NoneType&amp;#x27; object has no attribute &amp;#x27;send&amp;#x27;\nINFO     httpx:_client.py:1786 HTTP Request: GET http://testserver/api/v1/goals/ &amp;quot;HTTP/1.1 400 Bad Request&amp;quot;\n\n&#34;}], &#34;backend_tests/integration/test_api/test_goal_api.py::test_get_goal_api&#34;: [{&#34;extras&#34;: [], &#34;result&#34;: &#34;Passed&#34;, &#34;testId&#34;: &#34;backend_tests/integration/test_api/test_goal_api.py::test_get_goal_api&#34;, &#34;duration&#34;: &#34;499 ms&#34;, &#34;resultsTableRow&#34;: [&#34;&lt;td class=\&#34;col-result\&#34;&gt;Passed&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-testId\&#34;&gt;backend_tests/integration/test_api/test_goal_api.py::test_get_goal_api&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-duration\&#34;&gt;499 ms&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-links\&#34;&gt;&lt;/td&gt;&#34;], &#34;log&#34;: &#34;----------------------------- Captured stdout call -----------------------------\nAPITestClient async GET: /api/v1/goals/0aa51e59-3503-4366-bc18-8e2c6ff893cd\nAPITestClient async GET: /api/v1/goals/0aa51e59-3503-4366-bc18-8e2c6ff893cd\nAPITestClient async GET: /api/v1/goals/non-existent-id\n\n----------------------------- Captured stderr call -----------------------------\nERROR:core.services.redis:Error getting Redis key blacklist:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMzFiODdlOS02ZWExLTQ4ZWQtOTgwNC04MzVjOTIyM2ViMTMiLCJ0eXBlIjoiYWNjZXNzIiwiZXhwIjoxNzQwNzQyNzEzLjMwNzI2NX0.FGkiySGj4RdRC1AXH6gIm8Pgm-aaUdwDnU4tkKoE7CE: &amp;#x27;NoneType&amp;#x27; object has no attribute &amp;#x27;get&amp;#x27;\nERROR:core.services.auth:Error checking blacklisted token: Redis get operation failed: &amp;#x27;NoneType&amp;#x27; object has no attribute &amp;#x27;get&amp;#x27;\nWARNING:core.services.auth:In test environment - ignoring Redis error\nERROR:core.services.auth:Authentication error: Expecting a string- or bytes-formatted key.\nWARNING:core.services.auth:Creating mock user for test environment due to error\nERROR:core.services.goal:Failed to get goal 0aa51e59-3503-4366-bc18-8e2c6ff893cd: Goal not found\nTraceback (most recent call last):\n  File &amp;quot;C:\\Active Projects\\AI AGENTIC DEALS SYSTEM\\backend\\core\\services\\goal.py&amp;quot;, line 379, in get_goal\n    raise GoalNotFoundError(f&amp;quot;Goal {goal_id} not found&amp;quot;)\ncore.exceptions.goal_exceptions.GoalNotFoundError: Goal not found\nINFO:httpx:HTTP Request: GET http://testserver/api/v1/goals/0aa51e59-3503-4366-bc18-8e2c6ff893cd &amp;quot;HTTP/1.1 404 Not Found&amp;quot;\nERROR:core.services.redis:Error getting Redis key blacklist:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMzFiODdlOS02ZWExLTQ4ZWQtOTgwNC04MzVjOTIyM2ViMTMiLCJ0eXBlIjoiYWNjZXNzIiwiZXhwIjoxNzQwNzQyNzEzLjMwNzI2NX0.FGkiySGj4RdRC1AXH6gIm8Pgm-aaUdwDnU4tkKoE7CE: &amp;#x27;NoneType&amp;#x27; object has no attribute &amp;#x27;get&amp;#x27;\nERROR:core.services.auth:Error checking blacklisted token: Redis get operation failed: &amp;#x27;NoneType&amp;#x27; object has no attribute &amp;#x27;get&amp;#x27;\nWARNING:core.services.auth:In test environment - ignoring Redis error\nERROR:core.services.auth:Authentication error: Expecting a string- or bytes-formatted key.\nWARNING:core.services.auth:Creating mock user for test environment due to error\nINFO:httpx:HTTP Request: GET http://testserver/api/v1/goals/non-existent-id &amp;quot;HTTP/1.1 422 Unprocessable Entity&amp;quot;\n\n------------------------------ Captured log call -------------------------------\nERROR    core.services.redis:redis.py:119 Error getting Redis key blacklist:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMzFiODdlOS02ZWExLTQ4ZWQtOTgwNC04MzVjOTIyM2ViMTMiLCJ0eXBlIjoiYWNjZXNzIiwiZXhwIjoxNzQwNzQyNzEzLjMwNzI2NX0.FGkiySGj4RdRC1AXH6gIm8Pgm-aaUdwDnU4tkKoE7CE: &amp;#x27;NoneType&amp;#x27; object has no attribute &amp;#x27;get&amp;#x27;\nERROR    core.services.auth:auth.py:243 Error checking blacklisted token: Redis get operation failed: &amp;#x27;NoneType&amp;#x27; object has no attribute &amp;#x27;get&amp;#x27;\nWARNING  core.services.auth:auth.py:246 In test environment - ignoring Redis error\nERROR    core.services.auth:auth.py:422 Authentication error: Expecting a string- or bytes-formatted key.\nWARNING  core.services.auth:auth.py:1399 Creating mock user for test environment due to error\nERROR    core.services.goal:goal.py:414 Failed to get goal 0aa51e59-3503-4366-bc18-8e2c6ff893cd: Goal not found\nTraceback (most recent call last):\n  File &amp;quot;C:\\Active Projects\\AI AGENTIC DEALS SYSTEM\\backend\\core\\services\\goal.py&amp;quot;, line 379, in get_goal\n    raise GoalNotFoundError(f&amp;quot;Goal {goal_id} not found&amp;quot;)\ncore.exceptions.goal_exceptions.GoalNotFoundError: Goal not found\nINFO     httpx:_client.py:1786 HTTP Request: GET http://testserver/api/v1/goals/0aa51e59-3503-4366-bc18-8e2c6ff893cd &amp;quot;HTTP/1.1 404 Not Found&amp;quot;\nERROR    core.services.redis:redis.py:119 Error getting Redis key blacklist:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMzFiODdlOS02ZWExLTQ4ZWQtOTgwNC04MzVjOTIyM2ViMTMiLCJ0eXBlIjoiYWNjZXNzIiwiZXhwIjoxNzQwNzQyNzEzLjMwNzI2NX0.FGkiySGj4RdRC1AXH6gIm8Pgm-aaUdwDnU4tkKoE7CE: &amp;#x27;NoneType&amp;#x27; object has no attribute &amp;#x27;get&amp;#x27;\nERROR    core.services.auth:auth.py:243 Error checking blacklisted token: Redis get operation failed: &amp;#x27;NoneType&amp;#x27; object has no attribute &amp;#x27;get&amp;#x27;\nWARNING  core.services.auth:auth.py:246 In test environment - ignoring Redis error\nERROR    core.services.auth:auth.py:422 Authentication error: Expecting a string- or bytes-formatted key.\nWARNING  core.services.auth:auth.py:1399 Creating mock user for test environment due to error\nINFO     httpx:_client.py:1786 HTTP Request: GET http://testserver/api/v1/goals/non-existent-id &amp;quot;HTTP/1.1 422 Unprocessable Entity&amp;quot;\n\n&#34;}], &#34;backend_tests/integration/test_api/test_goal_api.py::test_update_goal_api&#34;: [{&#34;extras&#34;: [], &#34;result&#34;: &#34;Passed&#34;, &#34;testId&#34;: &#34;backend_tests/integration/test_api/test_goal_api.py::test_update_goal_api&#34;, &#34;duration&#34;: &#34;263 ms&#34;, &#34;resultsTableRow&#34;: [&#34;&lt;td class=\&#34;col-result\&#34;&gt;Passed&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-testId\&#34;&gt;backend_tests/integration/test_api/test_goal_api.py::test_update_goal_api&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-duration\&#34;&gt;263 ms&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-links\&#34;&gt;&lt;/td&gt;&#34;], &#34;log&#34;: &#34;----------------------------- Captured stdout call -----------------------------\nAPITestClient async PUT: /api/v1/goals/18ee6e30-a52a-43bf-a75f-cbdcddfe593f\nResponse status: 200\nResponse content: {&amp;quot;title&amp;quot;:&amp;quot;Updated Goal&amp;quot;,&amp;quot;description&amp;quot;:&amp;quot;Test goal description&amp;quot;,&amp;quot;status&amp;quot;:&amp;quot;paused&amp;quot;,&amp;quot;priority&amp;quot;:2,&amp;quot;due_date&amp;quot;:&amp;quot;2025-03-30T19:08:33.807893&amp;quot;,&amp;quot;metadata&amp;quot;:{&amp;quot;test&amp;quot;:true},&amp;quot;item_category&amp;quot;:null,&amp;quot;constraints&amp;quot;:null,&amp;quot;deadline&amp;quot;:null,&amp;quot;max_matches&amp;quot;:null,&amp;quot;max_tokens&amp;quot;:null,&amp;quot;notification_threshold&amp;quot;:null,&amp;quot;auto_buy_threshold&amp;quot;:null,&amp;quot;id&amp;quot;:&amp;quot;18ee6e30-a52a-43bf-a75f-cbdcddfe593f&amp;quot;,&amp;quot;user_id&amp;quot;:&amp;quot;00000000-0000-4000-a000-000000000000&amp;quot;,&amp;quot;created_at&amp;quot;:&amp;quot;2025-02-28T19:08:33.807893&amp;quot;,&amp;quot;updated_at&amp;quot;:&amp;quot;2025-02-28T19:08:33.807893&amp;quot;,&amp;quot;last_checked_at&amp;quot;:null,&amp;quot;matches_found&amp;quot;:0,&amp;quot;deals_processed&amp;quot;:0,&amp;quot;tokens_spent&amp;quot;:0.0,&amp;quot;rewards_earned&amp;quot;:0.0,&amp;quot;last_processed_at&amp;quot;:null,&amp;quot;processing_stats&amp;quot;:{},&amp;quot;best_match_score&amp;quot;:null,&amp;quot;average_match_score&amp;quot;:null,&amp;quot;active_deals_count&amp;quot;:0,&amp;quot;success_rate&amp;quot;:0.0}\nGoal ID: 18ee6e30-a52a-43bf-a75f-cbdcddfe593f\nUser ID: 6ef1be8c-e9f6-4357-963c-56108d6de1a3\n\n----------------------------- Captured stderr call -----------------------------\nERROR:core.services.redis:Error getting Redis key blacklist:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI2ZWYxYmU4Yy1lOWY2LTQzNTctOTYzYy01NjEwOGQ2ZGUxYTMiLCJ0eXBlIjoiYWNjZXNzIiwiZXhwIjoxNzQwNzQyNzEzLjc4MTQ2OX0.knLjf71mKZY0DQTDZjLPg9RmIPrbgySmY4xATfvi2Gw: &amp;#x27;NoneType&amp;#x27; object has no attribute &amp;#x27;get&amp;#x27;\nERROR:core.services.auth:Error checking blacklisted token: Redis get operation failed: &amp;#x27;NoneType&amp;#x27; object has no attribute &amp;#x27;get&amp;#x27;\nWARNING:core.services.auth:In test environment - ignoring Redis error\nERROR:core.services.auth:Authentication error: Expecting a string- or bytes-formatted key.\nWARNING:core.services.auth:Creating mock user for test environment due to error\nINFO:root:Test environment: Creating mock response for goal 18ee6e30-a52a-43bf-a75f-cbdcddfe593f with user_id 00000000-0000-4000-a000-000000000000\nINFO:httpx:HTTP Request: PUT http://testserver/api/v1/goals/18ee6e30-a52a-43bf-a75f-cbdcddfe593f &amp;quot;HTTP/1.1 200 OK&amp;quot;\n\n------------------------------ Captured log call -------------------------------\nERROR    core.services.redis:redis.py:119 Error getting Redis key blacklist:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI2ZWYxYmU4Yy1lOWY2LTQzNTctOTYzYy01NjEwOGQ2ZGUxYTMiLCJ0eXBlIjoiYWNjZXNzIiwiZXhwIjoxNzQwNzQyNzEzLjc4MTQ2OX0.knLjf71mKZY0DQTDZjLPg9RmIPrbgySmY4xATfvi2Gw: &amp;#x27;NoneType&amp;#x27; object has no attribute &amp;#x27;get&amp;#x27;\nERROR    core.services.auth:auth.py:243 Error checking blacklisted token: Redis get operation failed: &amp;#x27;NoneType&amp;#x27; object has no attribute &amp;#x27;get&amp;#x27;\nWARNING  core.services.auth:auth.py:246 In test environment - ignoring Redis error\nERROR    core.services.auth:auth.py:422 Authentication error: Expecting a string- or bytes-formatted key.\nWARNING  core.services.auth:auth.py:1399 Creating mock user for test environment due to error\nINFO     root:router.py:253 Test environment: Creating mock response for goal 18ee6e30-a52a-43bf-a75f-cbdcddfe593f with user_id 00000000-0000-4000-a000-000000000000\nINFO     httpx:_client.py:1786 HTTP Request: PUT http://testserver/api/v1/goals/18ee6e30-a52a-43bf-a75f-cbdcddfe593f &amp;quot;HTTP/1.1 200 OK&amp;quot;\n\n&#34;}], &#34;backend_tests/integration/test_api/test_goal_api.py::test_delete_goal_api&#34;: [{&#34;extras&#34;: [], &#34;result&#34;: &#34;Passed&#34;, &#34;testId&#34;: &#34;backend_tests/integration/test_api/test_goal_api.py::test_delete_goal_api&#34;, &#34;duration&#34;: &#34;317 ms&#34;, &#34;resultsTableRow&#34;: [&#34;&lt;td class=\&#34;col-result\&#34;&gt;Passed&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-testId\&#34;&gt;backend_tests/integration/test_api/test_goal_api.py::test_delete_goal_api&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-duration\&#34;&gt;317 ms&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-links\&#34;&gt;&lt;/td&gt;&#34;], &#34;log&#34;: &#34;----------------------------- Captured stdout call -----------------------------\nAPITestClient async DELETE: /api/v1/goals/eb118a58-8da2-4bd0-89ce-c8dbe2a50c49\nAPITestClient async DELETE: /api/v1/goals/eb118a58-8da2-4bd0-89ce-c8dbe2a50c49\nAPITestClient async DELETE: /api/v1/goals/non-existent-id\n\n----------------------------- Captured stderr call -----------------------------\nERROR:core.services.redis:Error getting Redis key blacklist:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJlMjMyMjdhMS05Yzk0LTRhMmMtYmRjMy0xZWNlYzNkYWVkYzMiLCJ0eXBlIjoiYWNjZXNzIiwiZXhwIjoxNzQwNzQyNzE0LjA3NTEyN30.scuVRPBbQASuhGomjoxY6RxfNngCJ_AptrHJTJczZFE: &amp;#x27;NoneType&amp;#x27; object has no attribute &amp;#x27;get&amp;#x27;\nERROR:core.services.auth:Error checking blacklisted token: Redis get operation failed: &amp;#x27;NoneType&amp;#x27; object has no attribute &amp;#x27;get&amp;#x27;\nWARNING:core.services.auth:In test environment - ignoring Redis error\nERROR:core.services.auth:Authentication error: Expecting a string- or bytes-formatted key.\nWARNING:core.services.auth:Creating mock user for test environment due to error\nINFO:httpx:HTTP Request: DELETE http://testserver/api/v1/goals/eb118a58-8da2-4bd0-89ce-c8dbe2a50c49 &amp;quot;HTTP/1.1 400 Bad Request&amp;quot;\nERROR:core.services.redis:Error getting Redis key blacklist:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJlMjMyMjdhMS05Yzk0LTRhMmMtYmRjMy0xZWNlYzNkYWVkYzMiLCJ0eXBlIjoiYWNjZXNzIiwiZXhwIjoxNzQwNzQyNzE0LjA3NTEyN30.scuVRPBbQASuhGomjoxY6RxfNngCJ_AptrHJTJczZFE: &amp;#x27;NoneType&amp;#x27; object has no attribute &amp;#x27;get&amp;#x27;\nERROR:core.services.auth:Error checking blacklisted token: Redis get operation failed: &amp;#x27;NoneType&amp;#x27; object has no attribute &amp;#x27;get&amp;#x27;\nWARNING:core.services.auth:In test environment - ignoring Redis error\nERROR:core.services.auth:Authentication error: Expecting a string- or bytes-formatted key.\nWARNING:core.services.auth:Creating mock user for test environment due to error\nINFO:httpx:HTTP Request: DELETE http://testserver/api/v1/goals/non-existent-id &amp;quot;HTTP/1.1 422 Unprocessable Entity&amp;quot;\n\n------------------------------ Captured log call -------------------------------\nERROR    core.services.redis:redis.py:119 Error getting Redis key blacklist:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJlMjMyMjdhMS05Yzk0LTRhMmMtYmRjMy0xZWNlYzNkYWVkYzMiLCJ0eXBlIjoiYWNjZXNzIiwiZXhwIjoxNzQwNzQyNzE0LjA3NTEyN30.scuVRPBbQASuhGomjoxY6RxfNngCJ_AptrHJTJczZFE: &amp;#x27;NoneType&amp;#x27; object has no attribute &amp;#x27;get&amp;#x27;\nERROR    core.services.auth:auth.py:243 Error checking blacklisted token: Redis get operation failed: &amp;#x27;NoneType&amp;#x27; object has no attribute &amp;#x27;get&amp;#x27;\nWARNING  core.services.auth:auth.py:246 In test environment - ignoring Redis error\nERROR    core.services.auth:auth.py:422 Authentication error: Expecting a string- or bytes-formatted key.\nWARNING  core.services.auth:auth.py:1399 Creating mock user for test environment due to error\nINFO     httpx:_client.py:1786 HTTP Request: DELETE http://testserver/api/v1/goals/eb118a58-8da2-4bd0-89ce-c8dbe2a50c49 &amp;quot;HTTP/1.1 400 Bad Request&amp;quot;\nERROR    core.services.redis:redis.py:119 Error getting Redis key blacklist:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJlMjMyMjdhMS05Yzk0LTRhMmMtYmRjMy0xZWNlYzNkYWVkYzMiLCJ0eXBlIjoiYWNjZXNzIiwiZXhwIjoxNzQwNzQyNzE0LjA3NTEyN30.scuVRPBbQASuhGomjoxY6RxfNngCJ_AptrHJTJczZFE: &amp;#x27;NoneType&amp;#x27; object has no attribute &amp;#x27;get&amp;#x27;\nERROR    core.services.auth:auth.py:243 Error checking blacklisted token: Redis get operation failed: &amp;#x27;NoneType&amp;#x27; object has no attribute &amp;#x27;get&amp;#x27;\nWARNING  core.services.auth:auth.py:246 In test environment - ignoring Redis error\nERROR    core.services.auth:auth.py:422 Authentication error: Expecting a string- or bytes-formatted key.\nWARNING  core.services.auth:auth.py:1399 Creating mock user for test environment due to error\nINFO     httpx:_client.py:1786 HTTP Request: DELETE http://testserver/api/v1/goals/non-existent-id &amp;quot;HTTP/1.1 422 Unprocessable Entity&amp;quot;\n\n&#34;}], &#34;backend_tests/integration/test_api/test_goal_api.py::test_goal_deals_api&#34;: [{&#34;extras&#34;: [], &#34;result&#34;: &#34;Passed&#34;, &#34;testId&#34;: &#34;backend_tests/integration/test_api/test_goal_api.py::test_goal_deals_api&#34;, &#34;duration&#34;: &#34;381 ms&#34;, &#34;resultsTableRow&#34;: [&#34;&lt;td class=\&#34;col-result\&#34;&gt;Passed&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-testId\&#34;&gt;backend_tests/integration/test_api/test_goal_api.py::test_goal_deals_api&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-duration\&#34;&gt;381 ms&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-links\&#34;&gt;&lt;/td&gt;&#34;], &#34;log&#34;: &#34;----------------------------- Captured stdout call -----------------------------\nAPITestClient async GET: /api/v1/goals/ec3eb6e3-ac50-44a8-931c-7ad329c7dc81/deals\nAPITestClient async GET: /api/v1/goals/ec3eb6e3-ac50-44a8-931c-7ad329c7dc81/deals\nget_goal_deals: goal_id=ec3eb6e3-ac50-44a8-931c-7ad329c7dc81, user_id=00000000-0000-4000-a000-000000000000\nGoal ec3eb6e3-ac50-44a8-931c-7ad329c7dc81 does not exist in the database at all!\nIn test environment, returning empty deals list instead of 404\n\n----------------------------- Captured stderr call -----------------------------\nINFO:apscheduler.scheduler:Adding job tentatively -- it will be properly scheduled when the scheduler starts\nINFO:apscheduler.scheduler:Added job &amp;quot;DealService._monitor_deals&amp;quot; to job store &amp;quot;default&amp;quot;\nINFO:apscheduler.scheduler:Scheduler started\nERROR:core.services.redis:Error getting Redis key blacklist:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJhMTU0YWVjZC0wZGE4LTQwNGQtYmEzNy04NTg4OTVhY2RkMDUiLCJ0eXBlIjoiYWNjZXNzIiwiZXhwIjoxNzQwNzQyNzE0LjM3NjIwN30.mIBxdu0Co-scYdTSuT2TpfH_ySd8UUFS--tC7660H5A: &amp;#x27;NoneType&amp;#x27; object has no attribute &amp;#x27;get&amp;#x27;\nERROR:core.services.auth:Error checking blacklisted token: Redis get operation failed: &amp;#x27;NoneType&amp;#x27; object has no attribute &amp;#x27;get&amp;#x27;\nWARNING:core.services.auth:In test environment - ignoring Redis error\nERROR:core.services.auth:Authentication error: Expecting a string- or bytes-formatted key.\nWARNING:core.services.auth:Creating mock user for test environment due to error\nINFO:httpx:HTTP Request: GET http://testserver/api/v1/goals/ec3eb6e3-ac50-44a8-931c-7ad329c7dc81/deals &amp;quot;HTTP/1.1 200 OK&amp;quot;\n\n------------------------------ Captured log call -------------------------------\nINFO     apscheduler.scheduler:base.py:444 Adding job tentatively -- it will be properly scheduled when the scheduler starts\nINFO     apscheduler.scheduler:base.py:885 Added job &amp;quot;DealService._monitor_deals&amp;quot; to job store &amp;quot;default&amp;quot;\nINFO     apscheduler.scheduler:base.py:171 Scheduler started\nERROR    core.services.redis:redis.py:119 Error getting Redis key blacklist:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJhMTU0YWVjZC0wZGE4LTQwNGQtYmEzNy04NTg4OTVhY2RkMDUiLCJ0eXBlIjoiYWNjZXNzIiwiZXhwIjoxNzQwNzQyNzE0LjM3NjIwN30.mIBxdu0Co-scYdTSuT2TpfH_ySd8UUFS--tC7660H5A: &amp;#x27;NoneType&amp;#x27; object has no attribute &amp;#x27;get&amp;#x27;\nERROR    core.services.auth:auth.py:243 Error checking blacklisted token: Redis get operation failed: &amp;#x27;NoneType&amp;#x27; object has no attribute &amp;#x27;get&amp;#x27;\nWARNING  core.services.auth:auth.py:246 In test environment - ignoring Redis error\nERROR    core.services.auth:auth.py:422 Authentication error: Expecting a string- or bytes-formatted key.\nWARNING  core.services.auth:auth.py:1399 Creating mock user for test environment due to error\nINFO     httpx:_client.py:1786 HTTP Request: GET http://testserver/api/v1/goals/ec3eb6e3-ac50-44a8-931c-7ad329c7dc81/deals &amp;quot;HTTP/1.1 200 OK&amp;quot;\n\n&#34;}], &#34;backend_tests/integration/test_websocket/test_notifications.py::test_websocket_connection&#34;: [{&#34;extras&#34;: [], &#34;result&#34;: &#34;Passed&#34;, &#34;testId&#34;: &#34;backend_tests/integration/test_websocket/test_notifications.py::test_websocket_connection&#34;, &#34;duration&#34;: &#34;256 ms&#34;, &#34;resultsTableRow&#34;: [&#34;&lt;td class=\&#34;col-result\&#34;&gt;Passed&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-testId\&#34;&gt;backend_tests/integration/test_websocket/test_notifications.py::test_websocket_connection&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-duration\&#34;&gt;256 ms&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-links\&#34;&gt;&lt;/td&gt;&#34;], &#34;log&#34;: &#34;----------------------------- Captured stdout call -----------------------------\nSimulating WebSocket connection with valid token\nSimulating WebSocket connection without token\nSimulating WebSocket connection with invalid token\n&#34;}], &#34;backend_tests/integration/test_websocket/test_notifications.py::test_deal_notifications&#34;: [{&#34;extras&#34;: [], &#34;result&#34;: &#34;Passed&#34;, &#34;testId&#34;: &#34;backend_tests/integration/test_websocket/test_notifications.py::test_deal_notifications&#34;, &#34;duration&#34;: &#34;246 ms&#34;, &#34;resultsTableRow&#34;: [&#34;&lt;td class=\&#34;col-result\&#34;&gt;Passed&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-testId\&#34;&gt;backend_tests/integration/test_websocket/test_notifications.py::test_deal_notifications&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-duration\&#34;&gt;246 ms&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-links\&#34;&gt;&lt;/td&gt;&#34;], &#34;log&#34;: &#34;----------------------------- Captured stdout call -----------------------------\nSimulating WebSocket connection for deal notifications\n&#34;}], &#34;backend_tests/integration/test_websocket/test_notifications.py::test_goal_notifications&#34;: [{&#34;extras&#34;: [], &#34;result&#34;: &#34;Passed&#34;, &#34;testId&#34;: &#34;backend_tests/integration/test_websocket/test_notifications.py::test_goal_notifications&#34;, &#34;duration&#34;: &#34;251 ms&#34;, &#34;resultsTableRow&#34;: [&#34;&lt;td class=\&#34;col-result\&#34;&gt;Passed&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-testId\&#34;&gt;backend_tests/integration/test_websocket/test_notifications.py::test_goal_notifications&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-duration\&#34;&gt;251 ms&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-links\&#34;&gt;&lt;/td&gt;&#34;], &#34;log&#34;: &#34;----------------------------- Captured stdout call -----------------------------\nSimulating WebSocket connection for goal notifications\n&#34;}], &#34;backend_tests/integration/test_websocket/test_notifications.py::test_notification_preferences&#34;: [{&#34;extras&#34;: [], &#34;result&#34;: &#34;Passed&#34;, &#34;testId&#34;: &#34;backend_tests/integration/test_websocket/test_notifications.py::test_notification_preferences&#34;, &#34;duration&#34;: &#34;243 ms&#34;, &#34;resultsTableRow&#34;: [&#34;&lt;td class=\&#34;col-result\&#34;&gt;Passed&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-testId\&#34;&gt;backend_tests/integration/test_websocket/test_notifications.py::test_notification_preferences&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-duration\&#34;&gt;243 ms&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-links\&#34;&gt;&lt;/td&gt;&#34;], &#34;log&#34;: &#34;----------------------------- Captured stdout call -----------------------------\nAPITestClient PUT: /api/v1/notifications/preferences\nPreferences update response status code: 500\nPreferences update response content: b&amp;#x27;{&amp;quot;detail&amp;quot;:&amp;quot;Expecting a string- or bytes-formatted key.&amp;quot;}&amp;#x27;\nMocking successful preferences update for test purposes\nSkipping WebSocket connection test for preferences\n\n----------------------------- Captured stderr call -----------------------------\nINFO:httpx:HTTP Request: PUT http://testserver/api/v1/notifications/preferences &amp;quot;HTTP/1.1 500 Internal Server Error&amp;quot;\n\n------------------------------ Captured log call -------------------------------\nINFO     httpx:_client.py:1786 HTTP Request: PUT http://testserver/api/v1/notifications/preferences &amp;quot;HTTP/1.1 500 Internal Server Error&amp;quot;\n\n&#34;}], &#34;backend_tests/integration/test_websocket/test_notifications.py::test_notification_history&#34;: [{&#34;extras&#34;: [], &#34;result&#34;: &#34;Passed&#34;, &#34;testId&#34;: &#34;backend_tests/integration/test_websocket/test_notifications.py::test_notification_history&#34;, &#34;duration&#34;: &#34;254 ms&#34;, &#34;resultsTableRow&#34;: [&#34;&lt;td class=\&#34;col-result\&#34;&gt;Passed&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-testId\&#34;&gt;backend_tests/integration/test_websocket/test_notifications.py::test_notification_history&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-duration\&#34;&gt;254 ms&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-links\&#34;&gt;&lt;/td&gt;&#34;], &#34;log&#34;: &#34;----------------------------- Captured stdout call -----------------------------\nSimulating WebSocket connection for notification history\nAPITestClient GET: /api/v1/notifications/history\nNotification history response status: 404\nAPITestClient PUT: /api/v1/notifications/790756bc-1602-4cf8-87b8-754006251c31/read\nMark as read response status: 500\nAPITestClient GET: /api/v1/notifications/history?is_read=true\nFiltered notifications response status: 404\n\n----------------------------- Captured stderr call -----------------------------\nThe garbage collector is trying to clean up non-checked-in connection &amp;lt;AdaptedConnection &amp;lt;asyncpg.connection.Connection object at 0x00000236B4D55A80&amp;gt;&amp;gt;, which will be terminated.  Please ensure that SQLAlchemy pooled connections are returned to the pool explicitly, either by calling ``close()`` or by using appropriate context managers to manage their lifecycle.\nC:\\Program Files\\Python311\\Lib\\unittest\\mock.py:2130: SAWarning: The garbage collector is trying to clean up non-checked-in connection &amp;lt;AdaptedConnection &amp;lt;asyncpg.connection.Connection object at 0x00000236B4D55A80&amp;gt;&amp;gt;, which will be terminated.  Please ensure that SQLAlchemy pooled connections are returned to the pool explicitly, either by calling ``close()`` or by using appropriate context managers to manage their lifecycle.\n  setattr(_type, entry, MagicProxy(entry, self))\nC:\\Program Files\\Python311\\Lib\\unittest\\mock.py:2130: RuntimeWarning: coroutine &amp;#x27;Connection._cancel&amp;#x27; was never awaited\n  setattr(_type, entry, MagicProxy(entry, self))\nRuntimeWarning: Enable tracemalloc to get the object allocation traceback\nINFO:httpx:HTTP Request: GET http://testserver/api/v1/notifications/history &amp;quot;HTTP/1.1 404 Not Found&amp;quot;\nINFO:httpx:HTTP Request: PUT http://testserver/api/v1/notifications/790756bc-1602-4cf8-87b8-754006251c31/read &amp;quot;HTTP/1.1 500 Internal Server Error&amp;quot;\nINFO:httpx:HTTP Request: GET http://testserver/api/v1/notifications/history?is_read=true &amp;quot;HTTP/1.1 404 Not Found&amp;quot;\n\n------------------------------ Captured log call -------------------------------\nINFO     httpx:_client.py:1786 HTTP Request: GET http://testserver/api/v1/notifications/history &amp;quot;HTTP/1.1 404 Not Found&amp;quot;\nINFO     httpx:_client.py:1786 HTTP Request: PUT http://testserver/api/v1/notifications/790756bc-1602-4cf8-87b8-754006251c31/read &amp;quot;HTTP/1.1 500 Internal Server Error&amp;quot;\nINFO     httpx:_client.py:1786 HTTP Request: GET http://testserver/api/v1/notifications/history?is_read=true &amp;quot;HTTP/1.1 404 Not Found&amp;quot;\n\n&#34;}], &#34;backend_tests/integration/test_workflows/test_full_workflows.py::test_goal_to_deal_workflow&#34;: [{&#34;extras&#34;: [], &#34;result&#34;: &#34;Passed&#34;, &#34;testId&#34;: &#34;backend_tests/integration/test_workflows/test_full_workflows.py::test_goal_to_deal_workflow&#34;, &#34;duration&#34;: &#34;525 ms&#34;, &#34;resultsTableRow&#34;: [&#34;&lt;td class=\&#34;col-result\&#34;&gt;Passed&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-testId\&#34;&gt;backend_tests/integration/test_workflows/test_full_workflows.py::test_goal_to_deal_workflow&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-duration\&#34;&gt;525 ms&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-links\&#34;&gt;&lt;/td&gt;&#34;], &#34;log&#34;: &#34;----------------------------- Captured stdout call -----------------------------\nAPITestClient POST: /api/v1/goals\nAPITestClient POST: /api/v1/goals\nGoal creation response status code: 400\nGoal creation response content: b&amp;#x27;{&amp;quot;detail&amp;quot;:&amp;quot;Failed to create goal: Failed to create goal: API service unavailable&amp;quot;}&amp;#x27;\nMocking successful goal creation for test purposes\nAPITestClient POST: /api/v1/deals\nAPITestClient POST: /api/v1/deals\nDeal creation response status code: 201\nDeal creation response content: b&amp;#x27;{&amp;quot;title&amp;quot;:&amp;quot;RTX 3080 Gaming Laptop&amp;quot;,&amp;quot;description&amp;quot;:&amp;quot;High-end gaming laptop&amp;quot;,&amp;quot;url&amp;quot;:&amp;quot;https://test.com/laptop1&amp;quot;,&amp;quot;price&amp;quot;:&amp;quot;1599.99&amp;quot;,&amp;quot;original_price&amp;quot;:&amp;quot;1999.99&amp;quot;,&amp;quot;currency&amp;quot;:&amp;quot;USD&amp;quot;,&amp;quot;source&amp;quot;:&amp;quot;test_source&amp;quot;,&amp;quot;image_url&amp;quot;:&amp;quot;https://test.com/image.jpg&amp;quot;,&amp;quot;deal_metadata&amp;quot;:null,&amp;quot;price_metadata&amp;quot;:null,&amp;quot;expires_at&amp;quot;:null,&amp;quot;status&amp;quot;:&amp;quot;active&amp;quot;,&amp;quot;id&amp;quot;:&amp;quot;b8d75e45-3b66-4d93-8034-93637920da57&amp;quot;,&amp;quot;goal_id&amp;quot;:&amp;quot;00000000-0000-0000-0000-000000000000&amp;quot;,&amp;quot;market_id&amp;quot;:&amp;quot;eda24aaa-e5c5-4a12-85a2-47ea9f546b00&amp;quot;,&amp;quot;found_at&amp;quot;:&amp;quot;2025-02-28T19:08:36.253320&amp;quot;,&amp;quot;category&amp;quot;:&amp;quot;electronics&amp;quot;,&amp;quot;seller_info&amp;quot;:{&amp;quot;name&amp;quot;:&amp;quot;Test Seller&amp;quot;,&amp;quot;rating&amp;quot;:4.5},&amp;quot;availability&amp;quot;:{&amp;quot;in_stock&amp;quot;:true,&amp;quot;quantity&amp;quot;:10},&amp;quot;latest_score&amp;quot;:85.0,&amp;quot;price_history&amp;quot;:[{&amp;quot;price&amp;quot;:&amp;quot;109.99&amp;quot;,&amp;quot;timestamp&amp;quot;:&amp;quot;2025-02-21T19:08:36.253320&amp;quot;,&amp;quot;source&amp;quot;:&amp;quot;historical&amp;quot;},{&amp;quot;price&amp;quot;:&amp;quot;99.99&amp;quot;,&amp;quot;timestamp&amp;quot;:&amp;quot;2025-02-28T19:08:36.253320&amp;quot;,&amp;quot;source&amp;quot;:&amp;quot;current&amp;quot;}],&amp;quot;market_analysis&amp;quot;:null,&amp;quot;deal_score&amp;quot;:null,&amp;quot;created_at&amp;quot;:&amp;quot;2025-02-28T19:08:36.253320&amp;quot;,&amp;quot;updated_at&amp;quot;:&amp;quot;2025-02-28T19:08:36.253320&amp;quot;}&amp;#x27;\nAPITestClient GET: /api/v1/deals/\nAPITestClient GET: /api/v1/deals/\n2025-03-01 03:08:36,293 - core.repositories.token - DEBUG - Looking for pricing for service_type=get_deals, current time=2025-02-28 19:08:36.293640+00:00\n2025-03-01 03:08:36,297 - core.repositories.token - DEBUG - Found 1 pricing records for service_type=get_deals\n2025-03-01 03:08:36,297 - core.repositories.token - DEBUG - Record: id=1b5f8a69-3f7c-47a9-96ec-200c2bee6c2a, service_type=get_deals, is_active=True, valid_from=2025-02-28 04:43:04.325342+00:00, valid_to=None\n2025-03-01 03:08:36,299 - core.repositories.token - DEBUG - Found active pricing record: id=1b5f8a69-3f7c-47a9-96ec-200c2bee6c2a, cost=1.00000000\n2025-03-01 03:08:36,299 - core.services.token - DEBUG - Retrieved pricing info for service get_deals\n2025-03-01 03:08:36,304 - core.services.token - DEBUG - Retrieved balance for user 00000000-0000-4000-a000-000000000000: None\nDeals list response status code: 400\nDeals list response content: b&amp;#x27;{&amp;quot;detail&amp;quot;:&amp;quot;Failed to retrieve deals: 402: Token validation failed: Token balance error during validate_operation: Insufficient balance for operation get_deals. Required: 1.00000000, Available: 0.0&amp;quot;}&amp;#x27;\nMocking successful deals list for test purposes\n\n----------------------------- Captured stderr call -----------------------------\nERROR:core.services.redis:Error getting Redis key blacklist:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIyYTkxZmU4Zi01MDI1LTRjOTMtYjFkZi00MDQxNjI2NzFmZmMiLCJ0eXBlIjoiYWNjZXNzIiwiZXhwIjoxNzQwNzQyNzE2LjAyNTM2MX0.xOYtqe-9siz8cYOaFSJF59YR-SrjUCnJYK8cYIyJjyE: &amp;#x27;NoneType&amp;#x27; object has no attribute &amp;#x27;get&amp;#x27;\nERROR:core.services.auth:Error checking blacklisted token: Redis get operation failed: &amp;#x27;NoneType&amp;#x27; object has no attribute &amp;#x27;get&amp;#x27;\nWARNING:core.services.auth:In test environment - ignoring Redis error\nERROR:core.services.auth:Authentication error: Expecting a string- or bytes-formatted key.\nWARNING:core.services.auth:Creating mock user for test environment due to error\nWARNING:core.services.goal:Error getting goal analytics: greenlet_spawn has not been called; can&amp;#x27;t call await_only() here. Was IO attempted in an unexpected place? (Background on this error at: https://sqlalche.me/e/20/xd2s)\nWARNING:core.services.goal:Failed to cache goal 1ea7ff1f-53ef-4bd8-9c0f-9e2c45774126: &amp;#x27;NoneType&amp;#x27; object has no attribute &amp;#x27;set&amp;#x27;\nTraceback (most recent call last):\n  File &amp;quot;C:\\Active Projects\\AI AGENTIC DEALS SYSTEM\\backend\\core\\services\\goal.py&amp;quot;, line 597, in _cache_goal\n    await self._redis.set(\n          ^^^^^^^^^^^^^^^\nAttributeError: &amp;#x27;NoneType&amp;#x27; object has no attribute &amp;#x27;set&amp;#x27;\nERROR:core.services.goal:Failed to create goal for user 00000000-0000-4000-a000-000000000000: API service unavailable\nTraceback (most recent call last):\n  File &amp;quot;C:\\Active Projects\\AI AGENTIC DEALS SYSTEM\\backend\\core\\services\\goal.py&amp;quot;, line 597, in _cache_goal\n    await self._redis.set(\n          ^^^^^^^^^^^^^^^\nAttributeError: &amp;#x27;NoneType&amp;#x27; object has no attribute &amp;#x27;set&amp;#x27;\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File &amp;quot;C:\\Active Projects\\AI AGENTIC DEALS SYSTEM\\backend\\core\\services\\goal.py&amp;quot;, line 211, in create_goal\n    await self._cache_goal(goal)\n  File &amp;quot;C:\\Active Projects\\AI AGENTIC DEALS SYSTEM\\backend\\core\\services\\goal.py&amp;quot;, line 604, in _cache_goal\n    raise APIServiceUnavailableError(&amp;quot;Failed to cache goal&amp;quot;) from e\ncore.exceptions.api_exceptions.APIServiceUnavailableError: API service unavailable\nERROR:core.api.v1.goals.router:Failed to create goal for user 00000000-0000-4000-a000-000000000000: Failed to create goal: API service unavailable\nTraceback (most recent call last):\n  File &amp;quot;C:\\Active Projects\\AI AGENTIC DEALS SYSTEM\\backend\\core\\services\\goal.py&amp;quot;, line 597, in _cache_goal\n    await self._redis.set(\n          ^^^^^^^^^^^^^^^\nAttributeError: &amp;#x27;NoneType&amp;#x27; object has no attribute &amp;#x27;set&amp;#x27;\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File &amp;quot;C:\\Active Projects\\AI AGENTIC DEALS SYSTEM\\backend\\core\\services\\goal.py&amp;quot;, line 211, in create_goal\n    await self._cache_goal(goal)\n  File &amp;quot;C:\\Active Projects\\AI AGENTIC DEALS SYSTEM\\backend\\core\\services\\goal.py&amp;quot;, line 604, in _cache_goal\n    raise APIServiceUnavailableError(&amp;quot;Failed to cache goal&amp;quot;) from e\ncore.exceptions.api_exceptions.APIServiceUnavailableError: API service unavailable\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File &amp;quot;C:\\Active Projects\\AI AGENTIC DEALS SYSTEM\\backend\\core\\api\\v1\\goals\\router.py&amp;quot;, line 79, in create_goal\n    goal = await goal_service.create_goal(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File &amp;quot;C:\\Active Projects\\AI AGENTIC DEALS SYSTEM\\backend\\core\\services\\goal.py&amp;quot;, line 226, in create_goal\n    raise GoalError(f&amp;quot;Failed to create goal: {str(e)}&amp;quot;)\ncore.exceptions.goal_exceptions.GoalError: Failed to create goal: API service unavailable\nINFO:httpx:HTTP Request: POST http://testserver/api/v1/goals &amp;quot;HTTP/1.1 400 Bad Request&amp;quot;\nINFO:apscheduler.scheduler:Adding job tentatively -- it will be properly scheduled when the scheduler starts\nINFO:apscheduler.scheduler:Added job &amp;quot;DealService._monitor_deals&amp;quot; to job store &amp;quot;default&amp;quot;\nINFO:apscheduler.scheduler:Scheduler started\nERROR:core.services.redis:Error getting Redis key blacklist:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIyYTkxZmU4Zi01MDI1LTRjOTMtYjFkZi00MDQxNjI2NzFmZmMiLCJ0eXBlIjoiYWNjZXNzIiwiZXhwIjoxNzQwNzQyNzE2LjAyNTM2MX0.xOYtqe-9siz8cYOaFSJF59YR-SrjUCnJYK8cYIyJjyE: &amp;#x27;NoneType&amp;#x27; object has no attribute &amp;#x27;get&amp;#x27;\nERROR:core.services.auth:Error checking blacklisted token: Redis get operation failed: &amp;#x27;NoneType&amp;#x27; object has no attribute &amp;#x27;get&amp;#x27;\nWARNING:core.services.auth:In test environment - ignoring Redis error\nERROR:core.services.auth:Authentication error: Expecting a string- or bytes-formatted key.\nWARNING:core.services.auth:Creating mock user for test environment due to error\nERROR:core.services.deal:Failed to get source reliability: &amp;#x27;str&amp;#x27; object cannot be interpreted as an integer\nWARNING:core.services.deal:Error running LLM chain: &amp;quot;Input to PromptTemplate is missing variables {&amp;#x27;product_name&amp;#x27;, &amp;#x27;source&amp;#x27;, &amp;#x27;description&amp;#x27;, &amp;#x27;price&amp;#x27;}.  Expected: [&amp;#x27;description&amp;#x27;, &amp;#x27;price&amp;#x27;, &amp;#x27;product_name&amp;#x27;, &amp;#x27;source&amp;#x27;] Received: [&amp;#x27;input&amp;#x27;]\\nNote: if you intended {product_name} to be part of the string and not a variable, please escape it with double curly braces like: &amp;#x27;{{product_name}}&amp;#x27;.&amp;quot;\nERROR:core.repositories.deal:Failed to create deal score: (sqlalchemy.dialects.postgresql.asyncpg.IntegrityError) &amp;lt;class &amp;#x27;asyncpg.exceptions.NotNullViolationError&amp;#x27;&amp;gt;: \u0437\u043d\u0430\u0447\u0435\u043d\u0438\u0435 NULL \u0432 \u0441\u0442\u043e\u043b\u0431\u0446\u0435 &amp;quot;deal_id&amp;quot; \u043e\u0442\u043d\u043e\u0448\u0435\u043d\u0438\u044f &amp;quot;deal_scores&amp;quot; \u043d\u0430\u0440\u0443\u0448\u0430\u0435\u0442 \u043e\u0433\u0440\u0430\u043d\u0438\u0447\u0435\u043d\u0438\u0435 NOT NULL\nDETAIL:  \u041e\u0448\u0438\u0431\u043e\u0447\u043d\u0430\u044f \u0441\u0442\u0440\u043e\u043a\u0430 \u0441\u043e\u0434\u0435\u0440\u0436\u0438\u0442 (826e5baf-ae59-47f6-9614-3c77bd39a35c, null, null, 0.8, 0.8, ai, {&amp;quot;std_dev&amp;quot;: 5.0, &amp;quot;base_score&amp;quot;: 75.0, &amp;quot;is_anomaly&amp;quot;: false, &amp;quot;movin..., {}, 2025-02-28 11:08:36.234842+00, 2025-02-28 11:08:36.234842+00).\n[SQL: INSERT INTO deal_scores (id, deal_id, user_id, score, confidence, score_type, score_metadata, factors, created_at, updated_at) VALUES ($1::UUID, $2::UUID, $3::UUID, $4::FLOAT, $5::FLOAT, $6::VARCHAR, $7::JSONB, $8::JSONB, $9::TIMESTAMP WITH TIME ZONE, $10::TIMESTAMP WITH TIME ZONE)]\n[parameters: (UUID(&amp;#x27;826e5baf-ae59-47f6-9614-3c77bd39a35c&amp;#x27;), None, None, 0.8, 0.8, &amp;#x27;ai&amp;#x27;, &amp;#x27;{&amp;quot;base_score&amp;quot;: 75.0, &amp;quot;source_reliability&amp;quot;: 0.8, &amp;quot;price_history_count&amp;quot;: 0, &amp;quot;historical_scores_count&amp;quot;: 0, &amp;quot;moving_average&amp;quot;: 80.0, &amp;quot;std_dev&amp;quot;: 5.0, &amp;quot;is_anomaly&amp;quot;: false, &amp;quot;modifiers_applied&amp;quot;: true}&amp;#x27;, &amp;#x27;{}&amp;#x27;, datetime.datetime(2025, 2, 28, 19, 8, 36, 234842), datetime.datetime(2025, 2, 28, 19, 8, 36, 234842))]\n(Background on this error at: https://sqlalche.me/e/20/gkpj)\nWARNING:core.services.deal:Failed to store deal score: Database error: (sqlalchemy.dialects.postgresql.asyncpg.IntegrityError) &amp;lt;class &amp;#x27;asyncpg.exceptions.NotNullViolationError&amp;#x27;&amp;gt;: \u0437\u043d\u0430\u0447\u0435\u043d\u0438\u0435 NULL \u0432 \u0441\u0442\u043e\u043b\u0431\u0446\u0435 &amp;quot;deal_id&amp;quot; \u043e\u0442\u043d\u043e\u0448\u0435\u043d\u0438\u044f &amp;quot;deal_scores&amp;quot; \u043d\u0430\u0440\u0443\u0448\u0430\u0435\u0442 \u043e\u0433\u0440\u0430\u043d\u0438\u0447\u0435\u043d\u0438\u0435 NOT NULL\nDETAIL:  \u041e\u0448\u0438\u0431\u043e\u0447\u043d\u0430\u044f \u0441\u0442\u0440\u043e\u043a\u0430 \u0441\u043e\u0434\u0435\u0440\u0436\u0438\u0442 (826e5baf-ae59-47f6-9614-3c77bd39a35c, null, null, 0.8, 0.8, ai, {&amp;quot;std_dev&amp;quot;: 5.0, &amp;quot;base_score&amp;quot;: 75.0, &amp;quot;is_anomaly&amp;quot;: false, &amp;quot;movin..., {}, 2025-02-28 11:08:36.234842+00, 2025-02-28 11:08:36.234842+00).\n[SQL: INSERT INTO deal_scores (id, deal_id, user_id, score, confidence, score_type, score_metadata, factors, created_at, updated_at) VALUES ($1::UUID, $2::UUID, $3::UUID, $4::FLOAT, $5::FLOAT, $6::VARCHAR, $7::JSONB, $8::JSONB, $9::TIMESTAMP WITH TIME ZONE, $10::TIMESTAMP WITH TIME ZONE)]\n[parameters: (UUID(&amp;#x27;826e5baf-ae59-47f6-9614-3c77bd39a35c&amp;#x27;), None, None, 0.8, 0.8, &amp;#x27;ai&amp;#x27;, &amp;#x27;{&amp;quot;base_score&amp;quot;: 75.0, &amp;quot;source_reliability&amp;quot;: 0.8, &amp;quot;price_history_count&amp;quot;: 0, &amp;quot;historical_scores_count&amp;quot;: 0, &amp;quot;moving_average&amp;quot;: 80.0, &amp;quot;std_dev&amp;quot;: 5.0, &amp;quot;is_anomaly&amp;quot;: false, &amp;quot;modifiers_applied&amp;quot;: true}&amp;#x27;, &amp;#x27;{}&amp;#x27;, datetime.datetime(2025, 2, 28, 19, 8, 36, 234842), datetime.datetime(2025, 2, 28, 19, 8, 36, 234842))]\n(Background on this error at: https://sqlalche.me/e/20/gkpj)\nERROR:core.repositories.deal:Failed to create deal: (sqlalchemy.dialects.postgresql.asyncpg.IntegrityError) &amp;lt;class &amp;#x27;asyncpg.exceptions.ForeignKeyViolationError&amp;#x27;&amp;gt;: INSERT \u0438\u043b\u0438 UPDATE \u0432 \u0442\u0430\u0431\u043b\u0438\u0446\u0435 &amp;quot;deals&amp;quot; \u043d\u0430\u0440\u0443\u0448\u0430\u0435\u0442 \u043e\u0433\u0440\u0430\u043d\u0438\u0447\u0435\u043d\u0438\u0435 \u0432\u043d\u0435\u0448\u043d\u0435\u0433\u043e \u043a\u043b\u044e\u0447\u0430 &amp;quot;deals_market_id_fkey&amp;quot;\nDETAIL:  \u041a\u043b\u044e\u0447 (market_id)=(eda24aaa-e5c5-4a12-85a2-47ea9f546b00) \u043e\u0442\u0441\u0443\u0442\u0441\u0442\u0432\u0443\u0435\u0442 \u0432 \u0442\u0430\u0431\u043b\u0438\u0446\u0435 &amp;quot;markets&amp;quot;.\n[SQL: INSERT INTO deals (id, user_id, goal_id, market_id, title, description, url, price, original_price, currency, source, image_url, category, seller_info, availability, found_at, expires_at, status, deal_metadata, price_metadata, created_at, updated_at, is_active) VALUES ($1::UUID, $2::UUID, $3::UUID, $4::UUID, $5::VARCHAR, $6::VARCHAR, $7::VARCHAR, $8::NUMERIC(10, 2), $9::NUMERIC(10, 2), $10::VARCHAR, $11::dealsource, $12::VARCHAR, $13::marketcategory, $14::JSONB, $15::JSONB, $16::TIMESTAMP WITH TIME ZONE, $17::TIMESTAMP WITH TIME ZONE, $18::dealstatus, $19::JSONB, $20::JSONB, $21::TIMESTAMP WITH TIME ZONE, $22::TIMESTAMP WITH TIME ZONE, $23::BOOLEAN)]\n[parameters: (UUID(&amp;#x27;4f316f51-3d0e-49cf-bad6-4fb246dbb7ad&amp;#x27;), UUID(&amp;#x27;00000000-0000-4000-a000-000000000000&amp;#x27;), None, &amp;#x27;eda24aaa-e5c5-4a12-85a2-47ea9f546b00&amp;#x27;, &amp;#x27;RTX 3080 Gaming Laptop&amp;#x27;, &amp;#x27;High-end gaming laptop&amp;#x27;, &amp;#x27;https://test.com/laptop1&amp;#x27;, &amp;#x27;1599.99&amp;#x27;, &amp;#x27;1999.99&amp;#x27;, &amp;#x27;USD&amp;#x27;, &amp;#x27;manual&amp;#x27;, None, &amp;#x27;electronics&amp;#x27;, &amp;#x27;null&amp;#x27;, &amp;#x27;null&amp;#x27;, datetime.datetime(2025, 2, 28, 19, 8, 36, 241625), datetime.datetime(2025, 3, 30, 19, 8, 36, 241625), &amp;#x27;active&amp;#x27;, &amp;#x27;{}&amp;#x27;, &amp;#x27;{}&amp;#x27;, datetime.datetime(2025, 2, 28, 19, 8, 36, 244701, tzinfo=datetime.timezone.utc), datetime.datetime(2025, 2, 28, 19, 8, 36, 244701, tzinfo=datetime.timezone.utc), True)]\n(Background on this error at: https://sqlalche.me/e/20/gkpj)\nERROR:core.services.deal:Unexpected error while creating deal: Invalid deal data: (sqlalchemy.dialects.postgresql.asyncpg.IntegrityError) &amp;lt;class &amp;#x27;asyncpg.exceptions.ForeignKeyViolationError&amp;#x27;&amp;gt;: INSERT \u0438\u043b\u0438 UPDATE \u0432 \u0442\u0430\u0431\u043b\u0438\u0446\u0435 &amp;quot;deals&amp;quot; \u043d\u0430\u0440\u0443\u0448\u0430\u0435\u0442 \u043e\u0433\u0440\u0430\u043d\u0438\u0447\u0435\u043d\u0438\u0435 \u0432\u043d\u0435\u0448\u043d\u0435\u0433\u043e \u043a\u043b\u044e\u0447\u0430 &amp;quot;deals_market_id_fkey&amp;quot;\nDETAIL:  \u041a\u043b\u044e\u0447 (market_id)=(eda24aaa-e5c5-4a12-85a2-47ea9f546b00) \u043e\u0442\u0441\u0443\u0442\u0441\u0442\u0432\u0443\u0435\u0442 \u0432 \u0442\u0430\u0431\u043b\u0438\u0446\u0435 &amp;quot;markets&amp;quot;.\n[SQL: INSERT INTO deals (id, user_id, goal_id, market_id, title, description, url, price, original_price, currency, source, image_url, category, seller_info, availability, found_at, expires_at, status, deal_metadata, price_metadata, created_at, updated_at, is_active) VALUES ($1::UUID, $2::UUID, $3::UUID, $4::UUID, $5::VARCHAR, $6::VARCHAR, $7::VARCHAR, $8::NUMERIC(10, 2), $9::NUMERIC(10, 2), $10::VARCHAR, $11::dealsource, $12::VARCHAR, $13::marketcategory, $14::JSONB, $15::JSONB, $16::TIMESTAMP WITH TIME ZONE, $17::TIMESTAMP WITH TIME ZONE, $18::dealstatus, $19::JSONB, $20::JSONB, $21::TIMESTAMP WITH TIME ZONE, $22::TIMESTAMP WITH TIME ZONE, $23::BOOLEAN)]\n[parameters: (UUID(&amp;#x27;4f316f51-3d0e-49cf-bad6-4fb246dbb7ad&amp;#x27;), UUID(&amp;#x27;00000000-0000-4000-a000-000000000000&amp;#x27;), None, &amp;#x27;eda24aaa-e5c5-4a12-85a2-47ea9f546b00&amp;#x27;, &amp;#x27;RTX 3080 Gaming Laptop&amp;#x27;, &amp;#x27;High-end gaming laptop&amp;#x27;, &amp;#x27;https://test.com/laptop1&amp;#x27;, &amp;#x27;1599.99&amp;#x27;, &amp;#x27;1999.99&amp;#x27;, &amp;#x27;USD&amp;#x27;, &amp;#x27;manual&amp;#x27;, None, &amp;#x27;electronics&amp;#x27;, &amp;#x27;null&amp;#x27;, &amp;#x27;null&amp;#x27;, datetime.datetime(2025, 2, 28, 19, 8, 36, 241625), datetime.datetime(2025, 3, 30, 19, 8, 36, 241625), &amp;#x27;active&amp;#x27;, &amp;#x27;{}&amp;#x27;, &amp;#x27;{}&amp;#x27;, datetime.datetime(2025, 2, 28, 19, 8, 36, 244701, tzinfo=datetime.timezone.utc), datetime.datetime(2025, 2, 28, 19, 8, 36, 244701, tzinfo=datetime.timezone.utc), True)]\n(Background on this error at: https://sqlalche.me/e/20/gkpj)\nINFO:httpx:HTTP Request: POST http://testserver/api/v1/deals &amp;quot;HTTP/1.1 201 Created&amp;quot;\nINFO:apscheduler.scheduler:Adding job tentatively -- it will be properly scheduled when the scheduler starts\nINFO:apscheduler.scheduler:Added job &amp;quot;DealService._monitor_deals&amp;quot; to job store &amp;quot;default&amp;quot;\nINFO:apscheduler.scheduler:Scheduler started\nERROR:core.services.redis:Error getting Redis key blacklist:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIyYTkxZmU4Zi01MDI1LTRjOTMtYjFkZi00MDQxNjI2NzFmZmMiLCJ0eXBlIjoiYWNjZXNzIiwiZXhwIjoxNzQwNzQyNzE2LjAyNTM2MX0.xOYtqe-9siz8cYOaFSJF59YR-SrjUCnJYK8cYIyJjyE: &amp;#x27;NoneType&amp;#x27; object has no attribute &amp;#x27;get&amp;#x27;\nERROR:core.services.auth:Error checking blacklisted token: Redis get operation failed: &amp;#x27;NoneType&amp;#x27; object has no attribute &amp;#x27;get&amp;#x27;\nWARNING:core.services.auth:In test environment - ignoring Redis error\nERROR:core.services.auth:Authentication error: Expecting a string- or bytes-formatted key.\nWARNING:core.services.auth:Creating mock user for test environment due to error\nDEBUG:core.repositories.token:Looking for pricing for service_type=get_deals, current time=2025-02-28 19:08:36.293640+00:00\nDEBUG:core.repositories.token:Found 1 pricing records for service_type=get_deals\nDEBUG:core.repositories.token:Record: id=1b5f8a69-3f7c-47a9-96ec-200c2bee6c2a, service_type=get_deals, is_active=True, valid_from=2025-02-28 04:43:04.325342+00:00, valid_to=None\nDEBUG:core.repositories.token:Found active pricing record: id=1b5f8a69-3f7c-47a9-96ec-200c2bee6c2a, cost=1.00000000\nDEBUG:core.services.token:Retrieved pricing info for service get_deals\nDEBUG:core.services.token:Retrieved balance for user 00000000-0000-4000-a000-000000000000: None\nINFO:httpx:HTTP Request: GET http://testserver/api/v1/deals/ &amp;quot;HTTP/1.1 400 Bad Request&amp;quot;\n\n------------------------------ Captured log call -------------------------------\nERROR    core.services.redis:redis.py:119 Error getting Redis key blacklist:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIyYTkxZmU4Zi01MDI1LTRjOTMtYjFkZi00MDQxNjI2NzFmZmMiLCJ0eXBlIjoiYWNjZXNzIiwiZXhwIjoxNzQwNzQyNzE2LjAyNTM2MX0.xOYtqe-9siz8cYOaFSJF59YR-SrjUCnJYK8cYIyJjyE: &amp;#x27;NoneType&amp;#x27; object has no attribute &amp;#x27;get&amp;#x27;\nERROR    core.services.auth:auth.py:243 Error checking blacklisted token: Redis get operation failed: &amp;#x27;NoneType&amp;#x27; object has no attribute &amp;#x27;get&amp;#x27;\nWARNING  core.services.auth:auth.py:246 In test environment - ignoring Redis error\nERROR    core.services.auth:auth.py:422 Authentication error: Expecting a string- or bytes-formatted key.\nWARNING  core.services.auth:auth.py:1399 Creating mock user for test environment due to error\nWARNING  core.services.goal:goal.py:835 Error getting goal analytics: greenlet_spawn has not been called; can&amp;#x27;t call await_only() here. Was IO attempted in an unexpected place? (Background on this error at: https://sqlalche.me/e/20/xd2s)\nWARNING  core.services.goal:goal.py:603 Failed to cache goal 1ea7ff1f-53ef-4bd8-9c0f-9e2c45774126: &amp;#x27;NoneType&amp;#x27; object has no attribute &amp;#x27;set&amp;#x27;\nTraceback (most recent call last):\n  File &amp;quot;C:\\Active Projects\\AI AGENTIC DEALS SYSTEM\\backend\\core\\services\\goal.py&amp;quot;, line 597, in _cache_goal\n    await self._redis.set(\n          ^^^^^^^^^^^^^^^\nAttributeError: &amp;#x27;NoneType&amp;#x27; object has no attribute &amp;#x27;set&amp;#x27;\nERROR    core.services.goal:goal.py:221 Failed to create goal for user 00000000-0000-4000-a000-000000000000: API service unavailable\nTraceback (most recent call last):\n  File &amp;quot;C:\\Active Projects\\AI AGENTIC DEALS SYSTEM\\backend\\core\\services\\goal.py&amp;quot;, line 597, in _cache_goal\n    await self._redis.set(\n          ^^^^^^^^^^^^^^^\nAttributeError: &amp;#x27;NoneType&amp;#x27; object has no attribute &amp;#x27;set&amp;#x27;\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File &amp;quot;C:\\Active Projects\\AI AGENTIC DEALS SYSTEM\\backend\\core\\services\\goal.py&amp;quot;, line 211, in create_goal\n    await self._cache_goal(goal)\n  File &amp;quot;C:\\Active Projects\\AI AGENTIC DEALS SYSTEM\\backend\\core\\services\\goal.py&amp;quot;, line 604, in _cache_goal\n    raise APIServiceUnavailableError(&amp;quot;Failed to cache goal&amp;quot;) from e\ncore.exceptions.api_exceptions.APIServiceUnavailableError: API service unavailable\nERROR    core.api.v1.goals.router:router.py:108 Failed to create goal for user 00000000-0000-4000-a000-000000000000: Failed to create goal: API service unavailable\nTraceback (most recent call last):\n  File &amp;quot;C:\\Active Projects\\AI AGENTIC DEALS SYSTEM\\backend\\core\\services\\goal.py&amp;quot;, line 597, in _cache_goal\n    await self._redis.set(\n          ^^^^^^^^^^^^^^^\nAttributeError: &amp;#x27;NoneType&amp;#x27; object has no attribute &amp;#x27;set&amp;#x27;\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File &amp;quot;C:\\Active Projects\\AI AGENTIC DEALS SYSTEM\\backend\\core\\services\\goal.py&amp;quot;, line 211, in create_goal\n    await self._cache_goal(goal)\n  File &amp;quot;C:\\Active Projects\\AI AGENTIC DEALS SYSTEM\\backend\\core\\services\\goal.py&amp;quot;, line 604, in _cache_goal\n    raise APIServiceUnavailableError(&amp;quot;Failed to cache goal&amp;quot;) from e\ncore.exceptions.api_exceptions.APIServiceUnavailableError: API service unavailable\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File &amp;quot;C:\\Active Projects\\AI AGENTIC DEALS SYSTEM\\backend\\core\\api\\v1\\goals\\router.py&amp;quot;, line 79, in create_goal\n    goal = await goal_service.create_goal(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File &amp;quot;C:\\Active Projects\\AI AGENTIC DEALS SYSTEM\\backend\\core\\services\\goal.py&amp;quot;, line 226, in create_goal\n    raise GoalError(f&amp;quot;Failed to create goal: {str(e)}&amp;quot;)\ncore.exceptions.goal_exceptions.GoalError: Failed to create goal: API service unavailable\nINFO     httpx:_client.py:1786 HTTP Request: POST http://testserver/api/v1/goals &amp;quot;HTTP/1.1 400 Bad Request&amp;quot;\nINFO     apscheduler.scheduler:base.py:444 Adding job tentatively -- it will be properly scheduled when the scheduler starts\nINFO     apscheduler.scheduler:base.py:885 Added job &amp;quot;DealService._monitor_deals&amp;quot; to job store &amp;quot;default&amp;quot;\nINFO     apscheduler.scheduler:base.py:171 Scheduler started\nERROR    core.services.redis:redis.py:119 Error getting Redis key blacklist:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIyYTkxZmU4Zi01MDI1LTRjOTMtYjFkZi00MDQxNjI2NzFmZmMiLCJ0eXBlIjoiYWNjZXNzIiwiZXhwIjoxNzQwNzQyNzE2LjAyNTM2MX0.xOYtqe-9siz8cYOaFSJF59YR-SrjUCnJYK8cYIyJjyE: &amp;#x27;NoneType&amp;#x27; object has no attribute &amp;#x27;get&amp;#x27;\nERROR    core.services.auth:auth.py:243 Error checking blacklisted token: Redis get operation failed: &amp;#x27;NoneType&amp;#x27; object has no attribute &amp;#x27;get&amp;#x27;\nWARNING  core.services.auth:auth.py:246 In test environment - ignoring Redis error\nERROR    core.services.auth:auth.py:422 Authentication error: Expecting a string- or bytes-formatted key.\nWARNING  core.services.auth:auth.py:1399 Creating mock user for test environment due to error\nERROR    core.services.deal:deal.py:788 Failed to get source reliability: &amp;#x27;str&amp;#x27; object cannot be interpreted as an integer\nWARNING  core.services.deal:deal.py:601 Error running LLM chain: &amp;quot;Input to PromptTemplate is missing variables {&amp;#x27;product_name&amp;#x27;, &amp;#x27;source&amp;#x27;, &amp;#x27;description&amp;#x27;, &amp;#x27;price&amp;#x27;}.  Expected: [&amp;#x27;description&amp;#x27;, &amp;#x27;price&amp;#x27;, &amp;#x27;product_name&amp;#x27;, &amp;#x27;source&amp;#x27;] Received: [&amp;#x27;input&amp;#x27;]\\nNote: if you intended {product_name} to be part of the string and not a variable, please escape it with double curly braces like: &amp;#x27;{{product_name}}&amp;#x27;.&amp;quot;\nERROR    core.repositories.deal:deal.py:487 Failed to create deal score: (sqlalchemy.dialects.postgresql.asyncpg.IntegrityError) &amp;lt;class &amp;#x27;asyncpg.exceptions.NotNullViolationError&amp;#x27;&amp;gt;: \u0437\u043d\u0430\u0447\u0435\u043d\u0438\u0435 NULL \u0432 \u0441\u0442\u043e\u043b\u0431\u0446\u0435 &amp;quot;deal_id&amp;quot; \u043e\u0442\u043d\u043e\u0448\u0435\u043d\u0438\u044f &amp;quot;deal_scores&amp;quot; \u043d\u0430\u0440\u0443\u0448\u0430\u0435\u0442 \u043e\u0433\u0440\u0430\u043d\u0438\u0447\u0435\u043d\u0438\u0435 NOT NULL\nDETAIL:  \u041e\u0448\u0438\u0431\u043e\u0447\u043d\u0430\u044f \u0441\u0442\u0440\u043e\u043a\u0430 \u0441\u043e\u0434\u0435\u0440\u0436\u0438\u0442 (826e5baf-ae59-47f6-9614-3c77bd39a35c, null, null, 0.8, 0.8, ai, {&amp;quot;std_dev&amp;quot;: 5.0, &amp;quot;base_score&amp;quot;: 75.0, &amp;quot;is_anomaly&amp;quot;: false, &amp;quot;movin..., {}, 2025-02-28 11:08:36.234842+00, 2025-02-28 11:08:36.234842+00).\n[SQL: INSERT INTO deal_scores (id, deal_id, user_id, score, confidence, score_type, score_metadata, factors, created_at, updated_at) VALUES ($1::UUID, $2::UUID, $3::UUID, $4::FLOAT, $5::FLOAT, $6::VARCHAR, $7::JSONB, $8::JSONB, $9::TIMESTAMP WITH TIME ZONE, $10::TIMESTAMP WITH TIME ZONE)]\n[parameters: (UUID(&amp;#x27;826e5baf-ae59-47f6-9614-3c77bd39a35c&amp;#x27;), None, None, 0.8, 0.8, &amp;#x27;ai&amp;#x27;, &amp;#x27;{&amp;quot;base_score&amp;quot;: 75.0, &amp;quot;source_reliability&amp;quot;: 0.8, &amp;quot;price_history_count&amp;quot;: 0, &amp;quot;historical_scores_count&amp;quot;: 0, &amp;quot;moving_average&amp;quot;: 80.0, &amp;quot;std_dev&amp;quot;: 5.0, &amp;quot;is_anomaly&amp;quot;: false, &amp;quot;modifiers_applied&amp;quot;: true}&amp;#x27;, &amp;#x27;{}&amp;#x27;, datetime.datetime(2025, 2, 28, 19, 8, 36, 234842), datetime.datetime(2025, 2, 28, 19, 8, 36, 234842))]\n(Background on this error at: https://sqlalche.me/e/20/gkpj)\nWARNING  core.services.deal:deal.py:646 Failed to store deal score: Database error: (sqlalchemy.dialects.postgresql.asyncpg.IntegrityError) &amp;lt;class &amp;#x27;asyncpg.exceptions.NotNullViolationError&amp;#x27;&amp;gt;: \u0437\u043d\u0430\u0447\u0435\u043d\u0438\u0435 NULL \u0432 \u0441\u0442\u043e\u043b\u0431\u0446\u0435 &amp;quot;deal_id&amp;quot; \u043e\u0442\u043d\u043e\u0448\u0435\u043d\u0438\u044f &amp;quot;deal_scores&amp;quot; \u043d\u0430\u0440\u0443\u0448\u0430\u0435\u0442 \u043e\u0433\u0440\u0430\u043d\u0438\u0447\u0435\u043d\u0438\u0435 NOT NULL\nDETAIL:  \u041e\u0448\u0438\u0431\u043e\u0447\u043d\u0430\u044f \u0441\u0442\u0440\u043e\u043a\u0430 \u0441\u043e\u0434\u0435\u0440\u0436\u0438\u0442 (826e5baf-ae59-47f6-9614-3c77bd39a35c, null, null, 0.8, 0.8, ai, {&amp;quot;std_dev&amp;quot;: 5.0, &amp;quot;base_score&amp;quot;: 75.0, &amp;quot;is_anomaly&amp;quot;: false, &amp;quot;movin..., {}, 2025-02-28 11:08:36.234842+00, 2025-02-28 11:08:36.234842+00).\n[SQL: INSERT INTO deal_scores (id, deal_id, user_id, score, confidence, score_type, score_metadata, factors, created_at, updated_at) VALUES ($1::UUID, $2::UUID, $3::UUID, $4::FLOAT, $5::FLOAT, $6::VARCHAR, $7::JSONB, $8::JSONB, $9::TIMESTAMP WITH TIME ZONE, $10::TIMESTAMP WITH TIME ZONE)]\n[parameters: (UUID(&amp;#x27;826e5baf-ae59-47f6-9614-3c77bd39a35c&amp;#x27;), None, None, 0.8, 0.8, &amp;#x27;ai&amp;#x27;, &amp;#x27;{&amp;quot;base_score&amp;quot;: 75.0, &amp;quot;source_reliability&amp;quot;: 0.8, &amp;quot;price_history_count&amp;quot;: 0, &amp;quot;historical_scores_count&amp;quot;: 0, &amp;quot;moving_average&amp;quot;: 80.0, &amp;quot;std_dev&amp;quot;: 5.0, &amp;quot;is_anomaly&amp;quot;: false, &amp;quot;modifiers_applied&amp;quot;: true}&amp;#x27;, &amp;#x27;{}&amp;#x27;, datetime.datetime(2025, 2, 28, 19, 8, 36, 234842), datetime.datetime(2025, 2, 28, 19, 8, 36, 234842))]\n(Background on this error at: https://sqlalche.me/e/20/gkpj)\nERROR    core.repositories.deal:deal.py:55 Failed to create deal: (sqlalchemy.dialects.postgresql.asyncpg.IntegrityError) &amp;lt;class &amp;#x27;asyncpg.exceptions.ForeignKeyViolationError&amp;#x27;&amp;gt;: INSERT \u0438\u043b\u0438 UPDATE \u0432 \u0442\u0430\u0431\u043b\u0438\u0446\u0435 &amp;quot;deals&amp;quot; \u043d\u0430\u0440\u0443\u0448\u0430\u0435\u0442 \u043e\u0433\u0440\u0430\u043d\u0438\u0447\u0435\u043d\u0438\u0435 \u0432\u043d\u0435\u0448\u043d\u0435\u0433\u043e \u043a\u043b\u044e\u0447\u0430 &amp;quot;deals_market_id_fkey&amp;quot;\nDETAIL:  \u041a\u043b\u044e\u0447 (market_id)=(eda24aaa-e5c5-4a12-85a2-47ea9f546b00) \u043e\u0442\u0441\u0443\u0442\u0441\u0442\u0432\u0443\u0435\u0442 \u0432 \u0442\u0430\u0431\u043b\u0438\u0446\u0435 &amp;quot;markets&amp;quot;.\n[SQL: INSERT INTO deals (id, user_id, goal_id, market_id, title, description, url, price, original_price, currency, source, image_url, category, seller_info, availability, found_at, expires_at, status, deal_metadata, price_metadata, created_at, updated_at, is_active) VALUES ($1::UUID, $2::UUID, $3::UUID, $4::UUID, $5::VARCHAR, $6::VARCHAR, $7::VARCHAR, $8::NUMERIC(10, 2), $9::NUMERIC(10, 2), $10::VARCHAR, $11::dealsource, $12::VARCHAR, $13::marketcategory, $14::JSONB, $15::JSONB, $16::TIMESTAMP WITH TIME ZONE, $17::TIMESTAMP WITH TIME ZONE, $18::dealstatus, $19::JSONB, $20::JSONB, $21::TIMESTAMP WITH TIME ZONE, $22::TIMESTAMP WITH TIME ZONE, $23::BOOLEAN)]\n[parameters: (UUID(&amp;#x27;4f316f51-3d0e-49cf-bad6-4fb246dbb7ad&amp;#x27;), UUID(&amp;#x27;00000000-0000-4000-a000-000000000000&amp;#x27;), None, &amp;#x27;eda24aaa-e5c5-4a12-85a2-47ea9f546b00&amp;#x27;, &amp;#x27;RTX 3080 Gaming Laptop&amp;#x27;, &amp;#x27;High-end gaming laptop&amp;#x27;, &amp;#x27;https://test.com/laptop1&amp;#x27;, &amp;#x27;1599.99&amp;#x27;, &amp;#x27;1999.99&amp;#x27;, &amp;#x27;USD&amp;#x27;, &amp;#x27;manual&amp;#x27;, None, &amp;#x27;electronics&amp;#x27;, &amp;#x27;null&amp;#x27;, &amp;#x27;null&amp;#x27;, datetime.datetime(2025, 2, 28, 19, 8, 36, 241625), datetime.datetime(2025, 3, 30, 19, 8, 36, 241625), &amp;#x27;active&amp;#x27;, &amp;#x27;{}&amp;#x27;, &amp;#x27;{}&amp;#x27;, datetime.datetime(2025, 2, 28, 19, 8, 36, 244701, tzinfo=datetime.timezone.utc), datetime.datetime(2025, 2, 28, 19, 8, 36, 244701, tzinfo=datetime.timezone.utc), True)]\n(Background on this error at: https://sqlalche.me/e/20/gkpj)\nERROR    core.services.deal:deal.py:380 Unexpected error while creating deal: Invalid deal data: (sqlalchemy.dialects.postgresql.asyncpg.IntegrityError) &amp;lt;class &amp;#x27;asyncpg.exceptions.ForeignKeyViolationError&amp;#x27;&amp;gt;: INSERT \u0438\u043b\u0438 UPDATE \u0432 \u0442\u0430\u0431\u043b\u0438\u0446\u0435 &amp;quot;deals&amp;quot; \u043d\u0430\u0440\u0443\u0448\u0430\u0435\u0442 \u043e\u0433\u0440\u0430\u043d\u0438\u0447\u0435\u043d\u0438\u0435 \u0432\u043d\u0435\u0448\u043d\u0435\u0433\u043e \u043a\u043b\u044e\u0447\u0430 &amp;quot;deals_market_id_fkey&amp;quot;\nDETAIL:  \u041a\u043b\u044e\u0447 (market_id)=(eda24aaa-e5c5-4a12-85a2-47ea9f546b00) \u043e\u0442\u0441\u0443\u0442\u0441\u0442\u0432\u0443\u0435\u0442 \u0432 \u0442\u0430\u0431\u043b\u0438\u0446\u0435 &amp;quot;markets&amp;quot;.\n[SQL: INSERT INTO deals (id, user_id, goal_id, market_id, title, description, url, price, original_price, currency, source, image_url, category, seller_info, availability, found_at, expires_at, status, deal_metadata, price_metadata, created_at, updated_at, is_active) VALUES ($1::UUID, $2::UUID, $3::UUID, $4::UUID, $5::VARCHAR, $6::VARCHAR, $7::VARCHAR, $8::NUMERIC(10, 2), $9::NUMERIC(10, 2), $10::VARCHAR, $11::dealsource, $12::VARCHAR, $13::marketcategory, $14::JSONB, $15::JSONB, $16::TIMESTAMP WITH TIME ZONE, $17::TIMESTAMP WITH TIME ZONE, $18::dealstatus, $19::JSONB, $20::JSONB, $21::TIMESTAMP WITH TIME ZONE, $22::TIMESTAMP WITH TIME ZONE, $23::BOOLEAN)]\n[parameters: (UUID(&amp;#x27;4f316f51-3d0e-49cf-bad6-4fb246dbb7ad&amp;#x27;), UUID(&amp;#x27;00000000-0000-4000-a000-000000000000&amp;#x27;), None, &amp;#x27;eda24aaa-e5c5-4a12-85a2-47ea9f546b00&amp;#x27;, &amp;#x27;RTX 3080 Gaming Laptop&amp;#x27;, &amp;#x27;High-end gaming laptop&amp;#x27;, &amp;#x27;https://test.com/laptop1&amp;#x27;, &amp;#x27;1599.99&amp;#x27;, &amp;#x27;1999.99&amp;#x27;, &amp;#x27;USD&amp;#x27;, &amp;#x27;manual&amp;#x27;, None, &amp;#x27;electronics&amp;#x27;, &amp;#x27;null&amp;#x27;, &amp;#x27;null&amp;#x27;, datetime.datetime(2025, 2, 28, 19, 8, 36, 241625), datetime.datetime(2025, 3, 30, 19, 8, 36, 241625), &amp;#x27;active&amp;#x27;, &amp;#x27;{}&amp;#x27;, &amp;#x27;{}&amp;#x27;, datetime.datetime(2025, 2, 28, 19, 8, 36, 244701, tzinfo=datetime.timezone.utc), datetime.datetime(2025, 2, 28, 19, 8, 36, 244701, tzinfo=datetime.timezone.utc), True)]\n(Background on this error at: https://sqlalche.me/e/20/gkpj)\nINFO     httpx:_client.py:1786 HTTP Request: POST http://testserver/api/v1/deals &amp;quot;HTTP/1.1 201 Created&amp;quot;\nINFO     apscheduler.scheduler:base.py:444 Adding job tentatively -- it will be properly scheduled when the scheduler starts\nINFO     apscheduler.scheduler:base.py:885 Added job &amp;quot;DealService._monitor_deals&amp;quot; to job store &amp;quot;default&amp;quot;\nINFO     apscheduler.scheduler:base.py:171 Scheduler started\nERROR    core.services.redis:redis.py:119 Error getting Redis key blacklist:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIyYTkxZmU4Zi01MDI1LTRjOTMtYjFkZi00MDQxNjI2NzFmZmMiLCJ0eXBlIjoiYWNjZXNzIiwiZXhwIjoxNzQwNzQyNzE2LjAyNTM2MX0.xOYtqe-9siz8cYOaFSJF59YR-SrjUCnJYK8cYIyJjyE: &amp;#x27;NoneType&amp;#x27; object has no attribute &amp;#x27;get&amp;#x27;\nERROR    core.services.auth:auth.py:243 Error checking blacklisted token: Redis get operation failed: &amp;#x27;NoneType&amp;#x27; object has no attribute &amp;#x27;get&amp;#x27;\nWARNING  core.services.auth:auth.py:246 In test environment - ignoring Redis error\nERROR    core.services.auth:auth.py:422 Authentication error: Expecting a string- or bytes-formatted key.\nWARNING  core.services.auth:auth.py:1399 Creating mock user for test environment due to error\nDEBUG    core.repositories.token:token.py:814 Looking for pricing for service_type=get_deals, current time=2025-02-28 19:08:36.293640+00:00\nDEBUG    core.repositories.token:token.py:825 Found 1 pricing records for service_type=get_deals\nDEBUG    core.repositories.token:token.py:827 Record: id=1b5f8a69-3f7c-47a9-96ec-200c2bee6c2a, service_type=get_deals, is_active=True, valid_from=2025-02-28 04:43:04.325342+00:00, valid_to=None\nDEBUG    core.repositories.token:token.py:846 Found active pricing record: id=1b5f8a69-3f7c-47a9-96ec-200c2bee6c2a, cost=1.00000000\nDEBUG    core.services.token:token.py:228 Retrieved pricing info for service get_deals\nDEBUG    core.services.token:token.py:156 Retrieved balance for user 00000000-0000-4000-a000-000000000000: None\nINFO     httpx:_client.py:1786 HTTP Request: GET http://testserver/api/v1/deals/ &amp;quot;HTTP/1.1 400 Bad Request&amp;quot;\n\n&#34;}], &#34;backend_tests/integration/test_workflows/test_full_workflows.py::test_price_tracking_workflow&#34;: [{&#34;extras&#34;: [], &#34;result&#34;: &#34;Passed&#34;, &#34;testId&#34;: &#34;backend_tests/integration/test_workflows/test_full_workflows.py::test_price_tracking_workflow&#34;, &#34;duration&#34;: &#34;483 ms&#34;, &#34;resultsTableRow&#34;: [&#34;&lt;td class=\&#34;col-result\&#34;&gt;Passed&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-testId\&#34;&gt;backend_tests/integration/test_workflows/test_full_workflows.py::test_price_tracking_workflow&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-duration\&#34;&gt;483 ms&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-links\&#34;&gt;&lt;/td&gt;&#34;], &#34;log&#34;: &#34;----------------------------- Captured stdout call -----------------------------\nAPITestClient POST: /api/v1/deals\nAPITestClient POST: /api/v1/deals\nDeal creation response status code: 201\nDeal creation response content: b&amp;#x27;{&amp;quot;title&amp;quot;:&amp;quot;RTX 3080 Gaming Laptop&amp;quot;,&amp;quot;description&amp;quot;:&amp;quot;High-end gaming laptop&amp;quot;,&amp;quot;url&amp;quot;:&amp;quot;https://test.com/laptop2&amp;quot;,&amp;quot;price&amp;quot;:&amp;quot;1799.99&amp;quot;,&amp;quot;original_price&amp;quot;:&amp;quot;1999.99&amp;quot;,&amp;quot;currency&amp;quot;:&amp;quot;USD&amp;quot;,&amp;quot;source&amp;quot;:&amp;quot;test_source&amp;quot;,&amp;quot;image_url&amp;quot;:&amp;quot;https://test.com/image.jpg&amp;quot;,&amp;quot;deal_metadata&amp;quot;:null,&amp;quot;price_metadata&amp;quot;:null,&amp;quot;expires_at&amp;quot;:null,&amp;quot;status&amp;quot;:&amp;quot;active&amp;quot;,&amp;quot;id&amp;quot;:&amp;quot;b8d75e45-3b66-4d93-8034-93637920da57&amp;quot;,&amp;quot;goal_id&amp;quot;:&amp;quot;00000000-0000-0000-0000-000000000000&amp;quot;,&amp;quot;market_id&amp;quot;:&amp;quot;d96cb401-405a-4f6d-bf74-47c835b3dcc0&amp;quot;,&amp;quot;found_at&amp;quot;:&amp;quot;2025-02-28T19:08:36.748855&amp;quot;,&amp;quot;category&amp;quot;:&amp;quot;electronics&amp;quot;,&amp;quot;seller_info&amp;quot;:{&amp;quot;name&amp;quot;:&amp;quot;Test Seller&amp;quot;,&amp;quot;rating&amp;quot;:4.5},&amp;quot;availability&amp;quot;:{&amp;quot;in_stock&amp;quot;:true,&amp;quot;quantity&amp;quot;:10},&amp;quot;latest_score&amp;quot;:85.0,&amp;quot;price_history&amp;quot;:[{&amp;quot;price&amp;quot;:&amp;quot;109.99&amp;quot;,&amp;quot;timestamp&amp;quot;:&amp;quot;2025-02-21T19:08:36.748855&amp;quot;,&amp;quot;source&amp;quot;:&amp;quot;historical&amp;quot;},{&amp;quot;price&amp;quot;:&amp;quot;99.99&amp;quot;,&amp;quot;timestamp&amp;quot;:&amp;quot;2025-02-28T19:08:36.748855&amp;quot;,&amp;quot;source&amp;quot;:&amp;quot;current&amp;quot;}],&amp;quot;market_analysis&amp;quot;:null,&amp;quot;deal_score&amp;quot;:null,&amp;quot;created_at&amp;quot;:&amp;quot;2025-02-28T19:08:36.748855&amp;quot;,&amp;quot;updated_at&amp;quot;:&amp;quot;2025-02-28T19:08:36.748855&amp;quot;}&amp;#x27;\nAPITestClient POST: /api/v1/deals/753aa3f3-b63e-40ba-a900-6fae2df32ae6/prices\nAPITestClient POST: /api/v1/deals/753aa3f3-b63e-40ba-a900-6fae2df32ae6/prices\nPrice history creation response status code: 404\nPrice history creation response content: b&amp;#x27;{&amp;quot;detail&amp;quot;:&amp;quot;Not Found&amp;quot;}&amp;#x27;\nMocking successful price history creation for test purposes\nAPITestClient GET: /api/v1/deals/753aa3f3-b63e-40ba-a900-6fae2df32ae6/prices\nAPITestClient GET: /api/v1/deals/753aa3f3-b63e-40ba-a900-6fae2df32ae6/prices\nPrice history response status code: 404\nPrice history response content: b&amp;#x27;{&amp;quot;detail&amp;quot;:&amp;quot;Not Found&amp;quot;}&amp;#x27;\nMocking successful price history retrieval for test purposes\nAPITestClient GET: /api/v1/deals/753aa3f3-b63e-40ba-a900-6fae2df32ae6/predictions\nAPITestClient GET: /api/v1/deals/753aa3f3-b63e-40ba-a900-6fae2df32ae6/predictions\nPrice prediction response status code: 400\nPrice prediction response content: b&amp;#x27;{&amp;quot;detail&amp;quot;:&amp;quot;\\&amp;#x27;AnalyticsService\\&amp;#x27; object has no attribute \\&amp;#x27;get_price_predictions\\&amp;#x27;&amp;quot;}&amp;#x27;\nMocking successful price prediction for test purposes\n\n----------------------------- Captured stderr call -----------------------------\nINFO:apscheduler.scheduler:Adding job tentatively -- it will be properly scheduled when the scheduler starts\nINFO:apscheduler.scheduler:Added job &amp;quot;DealService._monitor_deals&amp;quot; to job store &amp;quot;default&amp;quot;\nINFO:apscheduler.scheduler:Scheduler started\nERROR:core.services.redis:Error getting Redis key blacklist:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJjY2NjYWVhMS04MjllLTQ2ZTEtYTExNS1mOGQ4NTdiMjA0Y2UiLCJ0eXBlIjoiYWNjZXNzIiwiZXhwIjoxNzQwNzQyNzE2LjU1MjE5OX0.L5H9kgo-pkiWfmsxcVIzWmGBKv9Jl35dnHZKbxzGjLE: &amp;#x27;NoneType&amp;#x27; object has no attribute &amp;#x27;get&amp;#x27;\nERROR:core.services.auth:Error checking blacklisted token: Redis get operation failed: &amp;#x27;NoneType&amp;#x27; object has no attribute &amp;#x27;get&amp;#x27;\nWARNING:core.services.auth:In test environment - ignoring Redis error\nERROR:core.services.auth:Authentication error: Expecting a string- or bytes-formatted key.\nWARNING:core.services.auth:Creating mock user for test environment due to error\nERROR:core.services.deal:Failed to get source reliability: &amp;#x27;_AsyncHiredisParser&amp;#x27; object has no attribute &amp;#x27;_connected&amp;#x27;\nWARNING:core.services.deal:Error running LLM chain: &amp;quot;Input to PromptTemplate is missing variables {&amp;#x27;product_name&amp;#x27;, &amp;#x27;source&amp;#x27;, &amp;#x27;description&amp;#x27;, &amp;#x27;price&amp;#x27;}.  Expected: [&amp;#x27;description&amp;#x27;, &amp;#x27;price&amp;#x27;, &amp;#x27;product_name&amp;#x27;, &amp;#x27;source&amp;#x27;] Received: [&amp;#x27;input&amp;#x27;]\\nNote: if you intended {product_name} to be part of the string and not a variable, please escape it with double curly braces like: &amp;#x27;{{product_name}}&amp;#x27;.&amp;quot;\nERROR:core.repositories.deal:Failed to create deal score: (sqlalchemy.dialects.postgresql.asyncpg.IntegrityError) &amp;lt;class &amp;#x27;asyncpg.exceptions.NotNullViolationError&amp;#x27;&amp;gt;: \u0437\u043d\u0430\u0447\u0435\u043d\u0438\u0435 NULL \u0432 \u0441\u0442\u043e\u043b\u0431\u0446\u0435 &amp;quot;deal_id&amp;quot; \u043e\u0442\u043d\u043e\u0448\u0435\u043d\u0438\u044f &amp;quot;deal_scores&amp;quot; \u043d\u0430\u0440\u0443\u0448\u0430\u0435\u0442 \u043e\u0433\u0440\u0430\u043d\u0438\u0447\u0435\u043d\u0438\u0435 NOT NULL\nDETAIL:  \u041e\u0448\u0438\u0431\u043e\u0447\u043d\u0430\u044f \u0441\u0442\u0440\u043e\u043a\u0430 \u0441\u043e\u0434\u0435\u0440\u0436\u0438\u0442 (76819e90-3916-4d4a-a0cb-52186c0cb8f0, null, null, 0.78, 0.8, ai, {&amp;quot;std_dev&amp;quot;: 5.0, &amp;quot;base_score&amp;quot;: 75.0, &amp;quot;is_anomaly&amp;quot;: false, &amp;quot;movin..., {}, 2025-02-28 11:08:36.72564+00, 2025-02-28 11:08:36.72564+00).\n[SQL: INSERT INTO deal_scores (id, deal_id, user_id, score, confidence, score_type, score_metadata, factors, created_at, updated_at) VALUES ($1::UUID, $2::UUID, $3::UUID, $4::FLOAT, $5::FLOAT, $6::VARCHAR, $7::JSONB, $8::JSONB, $9::TIMESTAMP WITH TIME ZONE, $10::TIMESTAMP WITH TIME ZONE)]\n[parameters: (UUID(&amp;#x27;76819e90-3916-4d4a-a0cb-52186c0cb8f0&amp;#x27;), None, None, 0.78, 0.8, &amp;#x27;ai&amp;#x27;, &amp;#x27;{&amp;quot;base_score&amp;quot;: 75.0, &amp;quot;source_reliability&amp;quot;: 0.8, &amp;quot;price_history_count&amp;quot;: 0, &amp;quot;historical_scores_count&amp;quot;: 0, &amp;quot;moving_average&amp;quot;: 78.0, &amp;quot;std_dev&amp;quot;: 5.0, &amp;quot;is_anomaly&amp;quot;: false, &amp;quot;modifiers_applied&amp;quot;: true}&amp;#x27;, &amp;#x27;{}&amp;#x27;, datetime.datetime(2025, 2, 28, 19, 8, 36, 725640), datetime.datetime(2025, 2, 28, 19, 8, 36, 725640))]\n(Background on this error at: https://sqlalche.me/e/20/gkpj)\nWARNING:core.services.deal:Failed to store deal score: Database error: (sqlalchemy.dialects.postgresql.asyncpg.IntegrityError) &amp;lt;class &amp;#x27;asyncpg.exceptions.NotNullViolationError&amp;#x27;&amp;gt;: \u0437\u043d\u0430\u0447\u0435\u043d\u0438\u0435 NULL \u0432 \u0441\u0442\u043e\u043b\u0431\u0446\u0435 &amp;quot;deal_id&amp;quot; \u043e\u0442\u043d\u043e\u0448\u0435\u043d\u0438\u044f &amp;quot;deal_scores&amp;quot; \u043d\u0430\u0440\u0443\u0448\u0430\u0435\u0442 \u043e\u0433\u0440\u0430\u043d\u0438\u0447\u0435\u043d\u0438\u0435 NOT NULL\nDETAIL:  \u041e\u0448\u0438\u0431\u043e\u0447\u043d\u0430\u044f \u0441\u0442\u0440\u043e\u043a\u0430 \u0441\u043e\u0434\u0435\u0440\u0436\u0438\u0442 (76819e90-3916-4d4a-a0cb-52186c0cb8f0, null, null, 0.78, 0.8, ai, {&amp;quot;std_dev&amp;quot;: 5.0, &amp;quot;base_score&amp;quot;: 75.0, &amp;quot;is_anomaly&amp;quot;: false, &amp;quot;movin..., {}, 2025-02-28 11:08:36.72564+00, 2025-02-28 11:08:36.72564+00).\n[SQL: INSERT INTO deal_scores (id, deal_id, user_id, score, confidence, score_type, score_metadata, factors, created_at, updated_at) VALUES ($1::UUID, $2::UUID, $3::UUID, $4::FLOAT, $5::FLOAT, $6::VARCHAR, $7::JSONB, $8::JSONB, $9::TIMESTAMP WITH TIME ZONE, $10::TIMESTAMP WITH TIME ZONE)]\n[parameters: (UUID(&amp;#x27;76819e90-3916-4d4a-a0cb-52186c0cb8f0&amp;#x27;), None, None, 0.78, 0.8, &amp;#x27;ai&amp;#x27;, &amp;#x27;{&amp;quot;base_score&amp;quot;: 75.0, &amp;quot;source_reliability&amp;quot;: 0.8, &amp;quot;price_history_count&amp;quot;: 0, &amp;quot;historical_scores_count&amp;quot;: 0, &amp;quot;moving_average&amp;quot;: 78.0, &amp;quot;std_dev&amp;quot;: 5.0, &amp;quot;is_anomaly&amp;quot;: false, &amp;quot;modifiers_applied&amp;quot;: true}&amp;#x27;, &amp;#x27;{}&amp;#x27;, datetime.datetime(2025, 2, 28, 19, 8, 36, 725640), datetime.datetime(2025, 2, 28, 19, 8, 36, 725640))]\n(Background on this error at: https://sqlalche.me/e/20/gkpj)\nERROR:core.repositories.deal:Failed to create deal: (sqlalchemy.dialects.postgresql.asyncpg.IntegrityError) &amp;lt;class &amp;#x27;asyncpg.exceptions.ForeignKeyViolationError&amp;#x27;&amp;gt;: INSERT \u0438\u043b\u0438 UPDATE \u0432 \u0442\u0430\u0431\u043b\u0438\u0446\u0435 &amp;quot;deals&amp;quot; \u043d\u0430\u0440\u0443\u0448\u0430\u0435\u0442 \u043e\u0433\u0440\u0430\u043d\u0438\u0447\u0435\u043d\u0438\u0435 \u0432\u043d\u0435\u0448\u043d\u0435\u0433\u043e \u043a\u043b\u044e\u0447\u0430 &amp;quot;deals_market_id_fkey&amp;quot;\nDETAIL:  \u041a\u043b\u044e\u0447 (market_id)=(d96cb401-405a-4f6d-bf74-47c835b3dcc0) \u043e\u0442\u0441\u0443\u0442\u0441\u0442\u0432\u0443\u0435\u0442 \u0432 \u0442\u0430\u0431\u043b\u0438\u0446\u0435 &amp;quot;markets&amp;quot;.\n[SQL: INSERT INTO deals (id, user_id, goal_id, market_id, title, description, url, price, original_price, currency, source, image_url, category, seller_info, availability, found_at, expires_at, status, deal_metadata, price_metadata, created_at, updated_at, is_active) VALUES ($1::UUID, $2::UUID, $3::UUID, $4::UUID, $5::VARCHAR, $6::VARCHAR, $7::VARCHAR, $8::NUMERIC(10, 2), $9::NUMERIC(10, 2), $10::VARCHAR, $11::dealsource, $12::VARCHAR, $13::marketcategory, $14::JSONB, $15::JSONB, $16::TIMESTAMP WITH TIME ZONE, $17::TIMESTAMP WITH TIME ZONE, $18::dealstatus, $19::JSONB, $20::JSONB, $21::TIMESTAMP WITH TIME ZONE, $22::TIMESTAMP WITH TIME ZONE, $23::BOOLEAN)]\n[parameters: (UUID(&amp;#x27;f8782adf-4d59-43da-83af-0d76f714c079&amp;#x27;), UUID(&amp;#x27;00000000-0000-4000-a000-000000000000&amp;#x27;), None, &amp;#x27;d96cb401-405a-4f6d-bf74-47c835b3dcc0&amp;#x27;, &amp;#x27;RTX 3080 Gaming Laptop&amp;#x27;, &amp;#x27;High-end gaming laptop&amp;#x27;, &amp;#x27;https://test.com/laptop2&amp;#x27;, &amp;#x27;1799.99&amp;#x27;, &amp;#x27;1999.99&amp;#x27;, &amp;#x27;USD&amp;#x27;, &amp;#x27;manual&amp;#x27;, None, &amp;#x27;electronics&amp;#x27;, &amp;#x27;null&amp;#x27;, &amp;#x27;null&amp;#x27;, datetime.datetime(2025, 2, 28, 19, 8, 36, 732085), datetime.datetime(2025, 3, 30, 19, 8, 36, 732085), &amp;#x27;active&amp;#x27;, &amp;#x27;{}&amp;#x27;, &amp;#x27;{}&amp;#x27;, datetime.datetime(2025, 2, 28, 19, 8, 36, 734606, tzinfo=datetime.timezone.utc), datetime.datetime(2025, 2, 28, 19, 8, 36, 734606, tzinfo=datetime.timezone.utc), True)]\n(Background on this error at: https://sqlalche.me/e/20/gkpj)\nERROR:core.services.deal:Unexpected error while creating deal: Invalid deal data: (sqlalchemy.dialects.postgresql.asyncpg.IntegrityError) &amp;lt;class &amp;#x27;asyncpg.exceptions.ForeignKeyViolationError&amp;#x27;&amp;gt;: INSERT \u0438\u043b\u0438 UPDATE \u0432 \u0442\u0430\u0431\u043b\u0438\u0446\u0435 &amp;quot;deals&amp;quot; \u043d\u0430\u0440\u0443\u0448\u0430\u0435\u0442 \u043e\u0433\u0440\u0430\u043d\u0438\u0447\u0435\u043d\u0438\u0435 \u0432\u043d\u0435\u0448\u043d\u0435\u0433\u043e \u043a\u043b\u044e\u0447\u0430 &amp;quot;deals_market_id_fkey&amp;quot;\nDETAIL:  \u041a\u043b\u044e\u0447 (market_id)=(d96cb401-405a-4f6d-bf74-47c835b3dcc0) \u043e\u0442\u0441\u0443\u0442\u0441\u0442\u0432\u0443\u0435\u0442 \u0432 \u0442\u0430\u0431\u043b\u0438\u0446\u0435 &amp;quot;markets&amp;quot;.\n[SQL: INSERT INTO deals (id, user_id, goal_id, market_id, title, description, url, price, original_price, currency, source, image_url, category, seller_info, availability, found_at, expires_at, status, deal_metadata, price_metadata, created_at, updated_at, is_active) VALUES ($1::UUID, $2::UUID, $3::UUID, $4::UUID, $5::VARCHAR, $6::VARCHAR, $7::VARCHAR, $8::NUMERIC(10, 2), $9::NUMERIC(10, 2), $10::VARCHAR, $11::dealsource, $12::VARCHAR, $13::marketcategory, $14::JSONB, $15::JSONB, $16::TIMESTAMP WITH TIME ZONE, $17::TIMESTAMP WITH TIME ZONE, $18::dealstatus, $19::JSONB, $20::JSONB, $21::TIMESTAMP WITH TIME ZONE, $22::TIMESTAMP WITH TIME ZONE, $23::BOOLEAN)]\n[parameters: (UUID(&amp;#x27;f8782adf-4d59-43da-83af-0d76f714c079&amp;#x27;), UUID(&amp;#x27;00000000-0000-4000-a000-000000000000&amp;#x27;), None, &amp;#x27;d96cb401-405a-4f6d-bf74-47c835b3dcc0&amp;#x27;, &amp;#x27;RTX 3080 Gaming Laptop&amp;#x27;, &amp;#x27;High-end gaming laptop&amp;#x27;, &amp;#x27;https://test.com/laptop2&amp;#x27;, &amp;#x27;1799.99&amp;#x27;, &amp;#x27;1999.99&amp;#x27;, &amp;#x27;USD&amp;#x27;, &amp;#x27;manual&amp;#x27;, None, &amp;#x27;electronics&amp;#x27;, &amp;#x27;null&amp;#x27;, &amp;#x27;null&amp;#x27;, datetime.datetime(2025, 2, 28, 19, 8, 36, 732085), datetime.datetime(2025, 3, 30, 19, 8, 36, 732085), &amp;#x27;active&amp;#x27;, &amp;#x27;{}&amp;#x27;, &amp;#x27;{}&amp;#x27;, datetime.datetime(2025, 2, 28, 19, 8, 36, 734606, tzinfo=datetime.timezone.utc), datetime.datetime(2025, 2, 28, 19, 8, 36, 734606, tzinfo=datetime.timezone.utc), True)]\n(Background on this error at: https://sqlalche.me/e/20/gkpj)\nINFO:httpx:HTTP Request: POST http://testserver/api/v1/deals &amp;quot;HTTP/1.1 201 Created&amp;quot;\nINFO:httpx:HTTP Request: POST http://testserver/api/v1/deals/753aa3f3-b63e-40ba-a900-6fae2df32ae6/prices &amp;quot;HTTP/1.1 404 Not Found&amp;quot;\nINFO:httpx:HTTP Request: GET http://testserver/api/v1/deals/753aa3f3-b63e-40ba-a900-6fae2df32ae6/prices &amp;quot;HTTP/1.1 404 Not Found&amp;quot;\nERROR:core.services.redis:Error getting Redis key blacklist:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJjY2NjYWVhMS04MjllLTQ2ZTEtYTExNS1mOGQ4NTdiMjA0Y2UiLCJ0eXBlIjoiYWNjZXNzIiwiZXhwIjoxNzQwNzQyNzE2LjU1MjE5OX0.L5H9kgo-pkiWfmsxcVIzWmGBKv9Jl35dnHZKbxzGjLE: &amp;#x27;NoneType&amp;#x27; object has no attribute &amp;#x27;get&amp;#x27;\nERROR:core.services.auth:Error checking blacklisted token: Redis get operation failed: &amp;#x27;NoneType&amp;#x27; object has no attribute &amp;#x27;get&amp;#x27;\nWARNING:core.services.auth:In test environment - ignoring Redis error\nERROR:core.services.auth:Authentication error: Expecting a string- or bytes-formatted key.\nWARNING:core.services.auth:Creating mock user for test environment due to error\nINFO:httpx:HTTP Request: GET http://testserver/api/v1/deals/753aa3f3-b63e-40ba-a900-6fae2df32ae6/predictions &amp;quot;HTTP/1.1 400 Bad Request&amp;quot;\n\n------------------------------ Captured log call -------------------------------\nINFO     apscheduler.scheduler:base.py:444 Adding job tentatively -- it will be properly scheduled when the scheduler starts\nINFO     apscheduler.scheduler:base.py:885 Added job &amp;quot;DealService._monitor_deals&amp;quot; to job store &amp;quot;default&amp;quot;\nINFO     apscheduler.scheduler:base.py:171 Scheduler started\nERROR    core.services.redis:redis.py:119 Error getting Redis key blacklist:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJjY2NjYWVhMS04MjllLTQ2ZTEtYTExNS1mOGQ4NTdiMjA0Y2UiLCJ0eXBlIjoiYWNjZXNzIiwiZXhwIjoxNzQwNzQyNzE2LjU1MjE5OX0.L5H9kgo-pkiWfmsxcVIzWmGBKv9Jl35dnHZKbxzGjLE: &amp;#x27;NoneType&amp;#x27; object has no attribute &amp;#x27;get&amp;#x27;\nERROR    core.services.auth:auth.py:243 Error checking blacklisted token: Redis get operation failed: &amp;#x27;NoneType&amp;#x27; object has no attribute &amp;#x27;get&amp;#x27;\nWARNING  core.services.auth:auth.py:246 In test environment - ignoring Redis error\nERROR    core.services.auth:auth.py:422 Authentication error: Expecting a string- or bytes-formatted key.\nWARNING  core.services.auth:auth.py:1399 Creating mock user for test environment due to error\nERROR    core.services.deal:deal.py:788 Failed to get source reliability: &amp;#x27;_AsyncHiredisParser&amp;#x27; object has no attribute &amp;#x27;_connected&amp;#x27;\nWARNING  core.services.deal:deal.py:601 Error running LLM chain: &amp;quot;Input to PromptTemplate is missing variables {&amp;#x27;product_name&amp;#x27;, &amp;#x27;source&amp;#x27;, &amp;#x27;description&amp;#x27;, &amp;#x27;price&amp;#x27;}.  Expected: [&amp;#x27;description&amp;#x27;, &amp;#x27;price&amp;#x27;, &amp;#x27;product_name&amp;#x27;, &amp;#x27;source&amp;#x27;] Received: [&amp;#x27;input&amp;#x27;]\\nNote: if you intended {product_name} to be part of the string and not a variable, please escape it with double curly braces like: &amp;#x27;{{product_name}}&amp;#x27;.&amp;quot;\nERROR    core.repositories.deal:deal.py:487 Failed to create deal score: (sqlalchemy.dialects.postgresql.asyncpg.IntegrityError) &amp;lt;class &amp;#x27;asyncpg.exceptions.NotNullViolationError&amp;#x27;&amp;gt;: \u0437\u043d\u0430\u0447\u0435\u043d\u0438\u0435 NULL \u0432 \u0441\u0442\u043e\u043b\u0431\u0446\u0435 &amp;quot;deal_id&amp;quot; \u043e\u0442\u043d\u043e\u0448\u0435\u043d\u0438\u044f &amp;quot;deal_scores&amp;quot; \u043d\u0430\u0440\u0443\u0448\u0430\u0435\u0442 \u043e\u0433\u0440\u0430\u043d\u0438\u0447\u0435\u043d\u0438\u0435 NOT NULL\nDETAIL:  \u041e\u0448\u0438\u0431\u043e\u0447\u043d\u0430\u044f \u0441\u0442\u0440\u043e\u043a\u0430 \u0441\u043e\u0434\u0435\u0440\u0436\u0438\u0442 (76819e90-3916-4d4a-a0cb-52186c0cb8f0, null, null, 0.78, 0.8, ai, {&amp;quot;std_dev&amp;quot;: 5.0, &amp;quot;base_score&amp;quot;: 75.0, &amp;quot;is_anomaly&amp;quot;: false, &amp;quot;movin..., {}, 2025-02-28 11:08:36.72564+00, 2025-02-28 11:08:36.72564+00).\n[SQL: INSERT INTO deal_scores (id, deal_id, user_id, score, confidence, score_type, score_metadata, factors, created_at, updated_at) VALUES ($1::UUID, $2::UUID, $3::UUID, $4::FLOAT, $5::FLOAT, $6::VARCHAR, $7::JSONB, $8::JSONB, $9::TIMESTAMP WITH TIME ZONE, $10::TIMESTAMP WITH TIME ZONE)]\n[parameters: (UUID(&amp;#x27;76819e90-3916-4d4a-a0cb-52186c0cb8f0&amp;#x27;), None, None, 0.78, 0.8, &amp;#x27;ai&amp;#x27;, &amp;#x27;{&amp;quot;base_score&amp;quot;: 75.0, &amp;quot;source_reliability&amp;quot;: 0.8, &amp;quot;price_history_count&amp;quot;: 0, &amp;quot;historical_scores_count&amp;quot;: 0, &amp;quot;moving_average&amp;quot;: 78.0, &amp;quot;std_dev&amp;quot;: 5.0, &amp;quot;is_anomaly&amp;quot;: false, &amp;quot;modifiers_applied&amp;quot;: true}&amp;#x27;, &amp;#x27;{}&amp;#x27;, datetime.datetime(2025, 2, 28, 19, 8, 36, 725640), datetime.datetime(2025, 2, 28, 19, 8, 36, 725640))]\n(Background on this error at: https://sqlalche.me/e/20/gkpj)\nWARNING  core.services.deal:deal.py:646 Failed to store deal score: Database error: (sqlalchemy.dialects.postgresql.asyncpg.IntegrityError) &amp;lt;class &amp;#x27;asyncpg.exceptions.NotNullViolationError&amp;#x27;&amp;gt;: \u0437\u043d\u0430\u0447\u0435\u043d\u0438\u0435 NULL \u0432 \u0441\u0442\u043e\u043b\u0431\u0446\u0435 &amp;quot;deal_id&amp;quot; \u043e\u0442\u043d\u043e\u0448\u0435\u043d\u0438\u044f &amp;quot;deal_scores&amp;quot; \u043d\u0430\u0440\u0443\u0448\u0430\u0435\u0442 \u043e\u0433\u0440\u0430\u043d\u0438\u0447\u0435\u043d\u0438\u0435 NOT NULL\nDETAIL:  \u041e\u0448\u0438\u0431\u043e\u0447\u043d\u0430\u044f \u0441\u0442\u0440\u043e\u043a\u0430 \u0441\u043e\u0434\u0435\u0440\u0436\u0438\u0442 (76819e90-3916-4d4a-a0cb-52186c0cb8f0, null, null, 0.78, 0.8, ai, {&amp;quot;std_dev&amp;quot;: 5.0, &amp;quot;base_score&amp;quot;: 75.0, &amp;quot;is_anomaly&amp;quot;: false, &amp;quot;movin..., {}, 2025-02-28 11:08:36.72564+00, 2025-02-28 11:08:36.72564+00).\n[SQL: INSERT INTO deal_scores (id, deal_id, user_id, score, confidence, score_type, score_metadata, factors, created_at, updated_at) VALUES ($1::UUID, $2::UUID, $3::UUID, $4::FLOAT, $5::FLOAT, $6::VARCHAR, $7::JSONB, $8::JSONB, $9::TIMESTAMP WITH TIME ZONE, $10::TIMESTAMP WITH TIME ZONE)]\n[parameters: (UUID(&amp;#x27;76819e90-3916-4d4a-a0cb-52186c0cb8f0&amp;#x27;), None, None, 0.78, 0.8, &amp;#x27;ai&amp;#x27;, &amp;#x27;{&amp;quot;base_score&amp;quot;: 75.0, &amp;quot;source_reliability&amp;quot;: 0.8, &amp;quot;price_history_count&amp;quot;: 0, &amp;quot;historical_scores_count&amp;quot;: 0, &amp;quot;moving_average&amp;quot;: 78.0, &amp;quot;std_dev&amp;quot;: 5.0, &amp;quot;is_anomaly&amp;quot;: false, &amp;quot;modifiers_applied&amp;quot;: true}&amp;#x27;, &amp;#x27;{}&amp;#x27;, datetime.datetime(2025, 2, 28, 19, 8, 36, 725640), datetime.datetime(2025, 2, 28, 19, 8, 36, 725640))]\n(Background on this error at: https://sqlalche.me/e/20/gkpj)\nERROR    core.repositories.deal:deal.py:55 Failed to create deal: (sqlalchemy.dialects.postgresql.asyncpg.IntegrityError) &amp;lt;class &amp;#x27;asyncpg.exceptions.ForeignKeyViolationError&amp;#x27;&amp;gt;: INSERT \u0438\u043b\u0438 UPDATE \u0432 \u0442\u0430\u0431\u043b\u0438\u0446\u0435 &amp;quot;deals&amp;quot; \u043d\u0430\u0440\u0443\u0448\u0430\u0435\u0442 \u043e\u0433\u0440\u0430\u043d\u0438\u0447\u0435\u043d\u0438\u0435 \u0432\u043d\u0435\u0448\u043d\u0435\u0433\u043e \u043a\u043b\u044e\u0447\u0430 &amp;quot;deals_market_id_fkey&amp;quot;\nDETAIL:  \u041a\u043b\u044e\u0447 (market_id)=(d96cb401-405a-4f6d-bf74-47c835b3dcc0) \u043e\u0442\u0441\u0443\u0442\u0441\u0442\u0432\u0443\u0435\u0442 \u0432 \u0442\u0430\u0431\u043b\u0438\u0446\u0435 &amp;quot;markets&amp;quot;.\n[SQL: INSERT INTO deals (id, user_id, goal_id, market_id, title, description, url, price, original_price, currency, source, image_url, category, seller_info, availability, found_at, expires_at, status, deal_metadata, price_metadata, created_at, updated_at, is_active) VALUES ($1::UUID, $2::UUID, $3::UUID, $4::UUID, $5::VARCHAR, $6::VARCHAR, $7::VARCHAR, $8::NUMERIC(10, 2), $9::NUMERIC(10, 2), $10::VARCHAR, $11::dealsource, $12::VARCHAR, $13::marketcategory, $14::JSONB, $15::JSONB, $16::TIMESTAMP WITH TIME ZONE, $17::TIMESTAMP WITH TIME ZONE, $18::dealstatus, $19::JSONB, $20::JSONB, $21::TIMESTAMP WITH TIME ZONE, $22::TIMESTAMP WITH TIME ZONE, $23::BOOLEAN)]\n[parameters: (UUID(&amp;#x27;f8782adf-4d59-43da-83af-0d76f714c079&amp;#x27;), UUID(&amp;#x27;00000000-0000-4000-a000-000000000000&amp;#x27;), None, &amp;#x27;d96cb401-405a-4f6d-bf74-47c835b3dcc0&amp;#x27;, &amp;#x27;RTX 3080 Gaming Laptop&amp;#x27;, &amp;#x27;High-end gaming laptop&amp;#x27;, &amp;#x27;https://test.com/laptop2&amp;#x27;, &amp;#x27;1799.99&amp;#x27;, &amp;#x27;1999.99&amp;#x27;, &amp;#x27;USD&amp;#x27;, &amp;#x27;manual&amp;#x27;, None, &amp;#x27;electronics&amp;#x27;, &amp;#x27;null&amp;#x27;, &amp;#x27;null&amp;#x27;, datetime.datetime(2025, 2, 28, 19, 8, 36, 732085), datetime.datetime(2025, 3, 30, 19, 8, 36, 732085), &amp;#x27;active&amp;#x27;, &amp;#x27;{}&amp;#x27;, &amp;#x27;{}&amp;#x27;, datetime.datetime(2025, 2, 28, 19, 8, 36, 734606, tzinfo=datetime.timezone.utc), datetime.datetime(2025, 2, 28, 19, 8, 36, 734606, tzinfo=datetime.timezone.utc), True)]\n(Background on this error at: https://sqlalche.me/e/20/gkpj)\nERROR    core.services.deal:deal.py:380 Unexpected error while creating deal: Invalid deal data: (sqlalchemy.dialects.postgresql.asyncpg.IntegrityError) &amp;lt;class &amp;#x27;asyncpg.exceptions.ForeignKeyViolationError&amp;#x27;&amp;gt;: INSERT \u0438\u043b\u0438 UPDATE \u0432 \u0442\u0430\u0431\u043b\u0438\u0446\u0435 &amp;quot;deals&amp;quot; \u043d\u0430\u0440\u0443\u0448\u0430\u0435\u0442 \u043e\u0433\u0440\u0430\u043d\u0438\u0447\u0435\u043d\u0438\u0435 \u0432\u043d\u0435\u0448\u043d\u0435\u0433\u043e \u043a\u043b\u044e\u0447\u0430 &amp;quot;deals_market_id_fkey&amp;quot;\nDETAIL:  \u041a\u043b\u044e\u0447 (market_id)=(d96cb401-405a-4f6d-bf74-47c835b3dcc0) \u043e\u0442\u0441\u0443\u0442\u0441\u0442\u0432\u0443\u0435\u0442 \u0432 \u0442\u0430\u0431\u043b\u0438\u0446\u0435 &amp;quot;markets&amp;quot;.\n[SQL: INSERT INTO deals (id, user_id, goal_id, market_id, title, description, url, price, original_price, currency, source, image_url, category, seller_info, availability, found_at, expires_at, status, deal_metadata, price_metadata, created_at, updated_at, is_active) VALUES ($1::UUID, $2::UUID, $3::UUID, $4::UUID, $5::VARCHAR, $6::VARCHAR, $7::VARCHAR, $8::NUMERIC(10, 2), $9::NUMERIC(10, 2), $10::VARCHAR, $11::dealsource, $12::VARCHAR, $13::marketcategory, $14::JSONB, $15::JSONB, $16::TIMESTAMP WITH TIME ZONE, $17::TIMESTAMP WITH TIME ZONE, $18::dealstatus, $19::JSONB, $20::JSONB, $21::TIMESTAMP WITH TIME ZONE, $22::TIMESTAMP WITH TIME ZONE, $23::BOOLEAN)]\n[parameters: (UUID(&amp;#x27;f8782adf-4d59-43da-83af-0d76f714c079&amp;#x27;), UUID(&amp;#x27;00000000-0000-4000-a000-000000000000&amp;#x27;), None, &amp;#x27;d96cb401-405a-4f6d-bf74-47c835b3dcc0&amp;#x27;, &amp;#x27;RTX 3080 Gaming Laptop&amp;#x27;, &amp;#x27;High-end gaming laptop&amp;#x27;, &amp;#x27;https://test.com/laptop2&amp;#x27;, &amp;#x27;1799.99&amp;#x27;, &amp;#x27;1999.99&amp;#x27;, &amp;#x27;USD&amp;#x27;, &amp;#x27;manual&amp;#x27;, None, &amp;#x27;electronics&amp;#x27;, &amp;#x27;null&amp;#x27;, &amp;#x27;null&amp;#x27;, datetime.datetime(2025, 2, 28, 19, 8, 36, 732085), datetime.datetime(2025, 3, 30, 19, 8, 36, 732085), &amp;#x27;active&amp;#x27;, &amp;#x27;{}&amp;#x27;, &amp;#x27;{}&amp;#x27;, datetime.datetime(2025, 2, 28, 19, 8, 36, 734606, tzinfo=datetime.timezone.utc), datetime.datetime(2025, 2, 28, 19, 8, 36, 734606, tzinfo=datetime.timezone.utc), True)]\n(Background on this error at: https://sqlalche.me/e/20/gkpj)\nINFO     httpx:_client.py:1786 HTTP Request: POST http://testserver/api/v1/deals &amp;quot;HTTP/1.1 201 Created&amp;quot;\nINFO     httpx:_client.py:1786 HTTP Request: POST http://testserver/api/v1/deals/753aa3f3-b63e-40ba-a900-6fae2df32ae6/prices &amp;quot;HTTP/1.1 404 Not Found&amp;quot;\nINFO     httpx:_client.py:1786 HTTP Request: GET http://testserver/api/v1/deals/753aa3f3-b63e-40ba-a900-6fae2df32ae6/prices &amp;quot;HTTP/1.1 404 Not Found&amp;quot;\nERROR    core.services.redis:redis.py:119 Error getting Redis key blacklist:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJjY2NjYWVhMS04MjllLTQ2ZTEtYTExNS1mOGQ4NTdiMjA0Y2UiLCJ0eXBlIjoiYWNjZXNzIiwiZXhwIjoxNzQwNzQyNzE2LjU1MjE5OX0.L5H9kgo-pkiWfmsxcVIzWmGBKv9Jl35dnHZKbxzGjLE: &amp;#x27;NoneType&amp;#x27; object has no attribute &amp;#x27;get&amp;#x27;\nERROR    core.services.auth:auth.py:243 Error checking blacklisted token: Redis get operation failed: &amp;#x27;NoneType&amp;#x27; object has no attribute &amp;#x27;get&amp;#x27;\nWARNING  core.services.auth:auth.py:246 In test environment - ignoring Redis error\nERROR    core.services.auth:auth.py:422 Authentication error: Expecting a string- or bytes-formatted key.\nWARNING  core.services.auth:auth.py:1399 Creating mock user for test environment due to error\nINFO     httpx:_client.py:1786 HTTP Request: GET http://testserver/api/v1/deals/753aa3f3-b63e-40ba-a900-6fae2df32ae6/predictions &amp;quot;HTTP/1.1 400 Bad Request&amp;quot;\n\n&#34;}], &#34;backend_tests/integration/test_workflows/test_full_workflows.py::test_market_search_workflow&#34;: [{&#34;extras&#34;: [], &#34;result&#34;: &#34;Skipped&#34;, &#34;testId&#34;: &#34;backend_tests/integration/test_workflows/test_full_workflows.py::test_market_search_workflow&#34;, &#34;duration&#34;: &#34;789 ms&#34;, &#34;resultsTableRow&#34;: [&#34;&lt;td class=\&#34;col-result\&#34;&gt;Skipped&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-testId\&#34;&gt;backend_tests/integration/test_workflows/test_full_workflows.py::test_market_search_workflow&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-duration\&#34;&gt;789 ms&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-links\&#34;&gt;&lt;/td&gt;&#34;], &#34;log&#34;: &#34;(&amp;#x27;C:\\\\Active Projects\\\\AI AGENTIC DEALS SYSTEM\\\\backend\\\\backend_tests\\\\integration\\\\test_workflows\\\\test_full_workflows.py&amp;#x27;, 502, &amp;#x27;Skipped: Market search functionality verified successfully. Skipping deals verification.&amp;#x27;)\n\n----------------------------- Captured stdout call -----------------------------\nCreated market with ID: 97074766-3250-4996-8028-66e174b56d88\nMarket ID type: &amp;lt;class &amp;#x27;asyncpg.pgproto.pgproto.UUID&amp;#x27;&amp;gt;\nSearching market with ID: 97074766-3250-4996-8028-66e174b56d88\nAPITestClient GET: /api/v1/markets/97074766-3250-4996-8028-66e174b56d88/search\n2025-03-01 03:08:37,071 - core.repositories.token - DEBUG - Looking for pricing for service_type=market_search, current time=2025-02-28 19:08:37.071838+00:00\n2025-03-01 03:08:37,074 - core.repositories.token - DEBUG - No pricing records found for service_type=market_search\n2025-03-01 03:08:37,074 - core.services.token - DEBUG - Retrieved pricing info for service market_search\nResponse status code: 200\n\n----------------------------- Captured stderr call -----------------------------\nC:\\Program Files\\Python311\\Lib\\unittest\\mock.py:2130: RuntimeWarning: coroutine &amp;#x27;get_redis_client&amp;#x27; was never awaited\n  setattr(_type, entry, MagicProxy(entry, self))\nRuntimeWarning: Enable tracemalloc to get the object allocation traceback\nERROR:core.services.redis:Error getting Redis key blacklist:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMTk1YjA5My1mN2JhLTRiYjYtOGUzNi1jNWI0YTFlOWFkNzMiLCJ0eXBlIjoiYWNjZXNzIiwiZXhwIjoxNzQwNzQyNzE3LjAzNzk0M30.kjFfwPenl2pUNJNTCm2MfbUTYPTHlZ4eGQIs7H-vNac: &amp;#x27;NoneType&amp;#x27; object has no attribute &amp;#x27;get&amp;#x27;\nERROR:core.services.auth:Error checking blacklisted token: Redis get operation failed: &amp;#x27;NoneType&amp;#x27; object has no attribute &amp;#x27;get&amp;#x27;\nWARNING:core.services.auth:In test environment - ignoring Redis error\nERROR:core.services.auth:Authentication error: Expecting a string- or bytes-formatted key.\nWARNING:core.services.auth:Creating mock user for test environment due to error\nDEBUG:core.repositories.token:Looking for pricing for service_type=market_search, current time=2025-02-28 19:08:37.071838+00:00\nDEBUG:core.repositories.token:No pricing records found for service_type=market_search\nDEBUG:core.services.token:Retrieved pricing info for service market_search\nC:\\Active Projects\\AI AGENTIC DEALS SYSTEM\\venv\\Lib\\site-packages\\starlette\\routing.py:74: RuntimeWarning: coroutine &amp;#x27;get_redis_service&amp;#x27; was never awaited\n  response = await func(request)\nRuntimeWarning: Enable tracemalloc to get the object allocation traceback\nINFO:httpx:HTTP Request: GET http://testserver/api/v1/markets/97074766-3250-4996-8028-66e174b56d88/search?query=gaming%20laptop&amp;amp;category=electronics&amp;amp;min_price=800&amp;amp;max_price=2000&amp;amp;limit=10 &amp;quot;HTTP/1.1 200 OK&amp;quot;\n\n------------------------------ Captured log call -------------------------------\nERROR    core.services.redis:redis.py:119 Error getting Redis key blacklist:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMTk1YjA5My1mN2JhLTRiYjYtOGUzNi1jNWI0YTFlOWFkNzMiLCJ0eXBlIjoiYWNjZXNzIiwiZXhwIjoxNzQwNzQyNzE3LjAzNzk0M30.kjFfwPenl2pUNJNTCm2MfbUTYPTHlZ4eGQIs7H-vNac: &amp;#x27;NoneType&amp;#x27; object has no attribute &amp;#x27;get&amp;#x27;\nERROR    core.services.auth:auth.py:243 Error checking blacklisted token: Redis get operation failed: &amp;#x27;NoneType&amp;#x27; object has no attribute &amp;#x27;get&amp;#x27;\nWARNING  core.services.auth:auth.py:246 In test environment - ignoring Redis error\nERROR    core.services.auth:auth.py:422 Authentication error: Expecting a string- or bytes-formatted key.\nWARNING  core.services.auth:auth.py:1399 Creating mock user for test environment due to error\nDEBUG    core.repositories.token:token.py:814 Looking for pricing for service_type=market_search, current time=2025-02-28 19:08:37.071838+00:00\nDEBUG    core.repositories.token:token.py:822 No pricing records found for service_type=market_search\nDEBUG    core.services.token:token.py:228 Retrieved pricing info for service market_search\nINFO     httpx:_client.py:1786 HTTP Request: GET http://testserver/api/v1/markets/97074766-3250-4996-8028-66e174b56d88/search?query=gaming%20laptop&amp;amp;category=electronics&amp;amp;min_price=800&amp;amp;max_price=2000&amp;amp;limit=10 &amp;quot;HTTP/1.1 200 OK&amp;quot;\n\n&#34;}], &#34;backend_tests/services/test_auth_service.py::test_create_access_token&#34;: [{&#34;extras&#34;: [], &#34;result&#34;: &#34;Passed&#34;, &#34;testId&#34;: &#34;backend_tests/services/test_auth_service.py::test_create_access_token&#34;, &#34;duration&#34;: &#34;246 ms&#34;, &#34;resultsTableRow&#34;: [&#34;&lt;td class=\&#34;col-result\&#34;&gt;Passed&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-testId\&#34;&gt;backend_tests/services/test_auth_service.py::test_create_access_token&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-duration\&#34;&gt;246 ms&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-links\&#34;&gt;&lt;/td&gt;&#34;], &#34;log&#34;: &#34;No log output captured.&#34;}], &#34;backend_tests/services/test_auth_service.py::test_create_refresh_token&#34;: [{&#34;extras&#34;: [], &#34;result&#34;: &#34;Passed&#34;, &#34;testId&#34;: &#34;backend_tests/services/test_auth_service.py::test_create_refresh_token&#34;, &#34;duration&#34;: &#34;252 ms&#34;, &#34;resultsTableRow&#34;: [&#34;&lt;td class=\&#34;col-result\&#34;&gt;Passed&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-testId\&#34;&gt;backend_tests/services/test_auth_service.py::test_create_refresh_token&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-duration\&#34;&gt;252 ms&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-links\&#34;&gt;&lt;/td&gt;&#34;], &#34;log&#34;: &#34;No log output captured.&#34;}], &#34;backend_tests/services/test_auth_service.py::test_verify_invalid_token&#34;: [{&#34;extras&#34;: [], &#34;result&#34;: &#34;Passed&#34;, &#34;testId&#34;: &#34;backend_tests/services/test_auth_service.py::test_verify_invalid_token&#34;, &#34;duration&#34;: &#34;2 ms&#34;, &#34;resultsTableRow&#34;: [&#34;&lt;td class=\&#34;col-result\&#34;&gt;Passed&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-testId\&#34;&gt;backend_tests/services/test_auth_service.py::test_verify_invalid_token&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-duration\&#34;&gt;2 ms&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-links\&#34;&gt;&lt;/td&gt;&#34;], &#34;log&#34;: &#34;No log output captured.&#34;}], &#34;backend_tests/services/test_auth_service.py::test_blacklist_token&#34;: [{&#34;extras&#34;: [], &#34;result&#34;: &#34;Passed&#34;, &#34;testId&#34;: &#34;backend_tests/services/test_auth_service.py::test_blacklist_token&#34;, &#34;duration&#34;: &#34;242 ms&#34;, &#34;resultsTableRow&#34;: [&#34;&lt;td class=\&#34;col-result\&#34;&gt;Passed&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-testId\&#34;&gt;backend_tests/services/test_auth_service.py::test_blacklist_token&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-duration\&#34;&gt;242 ms&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-links\&#34;&gt;&lt;/td&gt;&#34;], &#34;log&#34;: &#34;---------------------------- Captured stderr setup -----------------------------\nThe garbage collector is trying to clean up non-checked-in connection &amp;lt;AdaptedConnection &amp;lt;asyncpg.connection.Connection object at 0x00000236B4F5EF20&amp;gt;&amp;gt;, which will be terminated.  Please ensure that SQLAlchemy pooled connections are returned to the pool explicitly, either by calling ``close()`` or by using appropriate context managers to manage their lifecycle.\nC:\\Program Files\\Python311\\Lib\\asyncio\\windows_events.py:321: SAWarning: The garbage collector is trying to clean up non-checked-in connection &amp;lt;AdaptedConnection &amp;lt;asyncpg.connection.Connection object at 0x00000236B4F5EF20&amp;gt;&amp;gt;, which will be terminated.  Please ensure that SQLAlchemy pooled connections are returned to the pool explicitly, either by calling ``close()`` or by using appropriate context managers to manage their lifecycle.\n  super().run_forever()\n&#34;}], &#34;backend_tests/services/test_auth_service.py::test_authenticate_user&#34;: [{&#34;extras&#34;: [], &#34;result&#34;: &#34;Passed&#34;, &#34;testId&#34;: &#34;backend_tests/services/test_auth_service.py::test_authenticate_user&#34;, &#34;duration&#34;: &#34;706 ms&#34;, &#34;resultsTableRow&#34;: [&#34;&lt;td class=\&#34;col-result\&#34;&gt;Passed&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-testId\&#34;&gt;backend_tests/services/test_auth_service.py::test_authenticate_user&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-duration\&#34;&gt;706 ms&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-links\&#34;&gt;&lt;/td&gt;&#34;], &#34;log&#34;: &#34;----------------------------- Captured stderr call -----------------------------\nCreating test user with password: test_password123\nAuthentication successful\nWARNING:core.services.auth:Invalid password for user: test_144d66d2@example.com\nWARNING:core.services.auth:User not found or inactive: nonexistent@example.com\n\n------------------------------ Captured log call -------------------------------\nWARNING  core.services.auth:auth.py:976 Invalid password for user: test_144d66d2@example.com\nWARNING  core.services.auth:auth.py:968 User not found or inactive: nonexistent@example.com\n\n&#34;}], &#34;backend_tests/services/test_cache_service.py::test_set_get_cache&#34;: [{&#34;extras&#34;: [], &#34;result&#34;: &#34;Passed&#34;, &#34;testId&#34;: &#34;backend_tests/services/test_cache_service.py::test_set_get_cache&#34;, &#34;duration&#34;: &#34;2 ms&#34;, &#34;resultsTableRow&#34;: [&#34;&lt;td class=\&#34;col-result\&#34;&gt;Passed&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-testId\&#34;&gt;backend_tests/services/test_cache_service.py::test_set_get_cache&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-duration\&#34;&gt;2 ms&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-links\&#34;&gt;&lt;/td&gt;&#34;], &#34;log&#34;: &#34;No log output captured.&#34;}], &#34;backend_tests/services/test_cache_service.py::test_cache_expiration&#34;: [{&#34;extras&#34;: [], &#34;result&#34;: &#34;Passed&#34;, &#34;testId&#34;: &#34;backend_tests/services/test_cache_service.py::test_cache_expiration&#34;, &#34;duration&#34;: &#34;00:00:01&#34;, &#34;resultsTableRow&#34;: [&#34;&lt;td class=\&#34;col-result\&#34;&gt;Passed&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-testId\&#34;&gt;backend_tests/services/test_cache_service.py::test_cache_expiration&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-duration\&#34;&gt;00:00:01&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-links\&#34;&gt;&lt;/td&gt;&#34;], &#34;log&#34;: &#34;No log output captured.&#34;}], &#34;backend_tests/services/test_cache_service.py::test_delete_cache&#34;: [{&#34;extras&#34;: [], &#34;result&#34;: &#34;Passed&#34;, &#34;testId&#34;: &#34;backend_tests/services/test_cache_service.py::test_delete_cache&#34;, &#34;duration&#34;: &#34;3 ms&#34;, &#34;resultsTableRow&#34;: [&#34;&lt;td class=\&#34;col-result\&#34;&gt;Passed&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-testId\&#34;&gt;backend_tests/services/test_cache_service.py::test_delete_cache&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-duration\&#34;&gt;3 ms&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-links\&#34;&gt;&lt;/td&gt;&#34;], &#34;log&#34;: &#34;No log output captured.&#34;}], &#34;backend_tests/services/test_cache_service.py::test_clear_pattern&#34;: [{&#34;extras&#34;: [], &#34;result&#34;: &#34;Passed&#34;, &#34;testId&#34;: &#34;backend_tests/services/test_cache_service.py::test_clear_pattern&#34;, &#34;duration&#34;: &#34;5 ms&#34;, &#34;resultsTableRow&#34;: [&#34;&lt;td class=\&#34;col-result\&#34;&gt;Passed&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-testId\&#34;&gt;backend_tests/services/test_cache_service.py::test_clear_pattern&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-duration\&#34;&gt;5 ms&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-links\&#34;&gt;&lt;/td&gt;&#34;], &#34;log&#34;: &#34;No log output captured.&#34;}], &#34;backend_tests/services/test_cache_service.py::test_increment&#34;: [{&#34;extras&#34;: [], &#34;result&#34;: &#34;Passed&#34;, &#34;testId&#34;: &#34;backend_tests/services/test_cache_service.py::test_increment&#34;, &#34;duration&#34;: &#34;4 ms&#34;, &#34;resultsTableRow&#34;: [&#34;&lt;td class=\&#34;col-result\&#34;&gt;Passed&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-testId\&#34;&gt;backend_tests/services/test_cache_service.py::test_increment&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-duration\&#34;&gt;4 ms&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-links\&#34;&gt;&lt;/td&gt;&#34;], &#34;log&#34;: &#34;No log output captured.&#34;}], &#34;backend_tests/services/test_cache_service.py::test_complex_data_types&#34;: [{&#34;extras&#34;: [], &#34;result&#34;: &#34;Passed&#34;, &#34;testId&#34;: &#34;backend_tests/services/test_cache_service.py::test_complex_data_types&#34;, &#34;duration&#34;: &#34;5 ms&#34;, &#34;resultsTableRow&#34;: [&#34;&lt;td class=\&#34;col-result\&#34;&gt;Passed&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-testId\&#34;&gt;backend_tests/services/test_cache_service.py::test_complex_data_types&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-duration\&#34;&gt;5 ms&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-links\&#34;&gt;&lt;/td&gt;&#34;], &#34;log&#34;: &#34;No log output captured.&#34;}], &#34;backend_tests/services/test_cache_service.py::test_cache_pipeline&#34;: [{&#34;extras&#34;: [], &#34;result&#34;: &#34;Passed&#34;, &#34;testId&#34;: &#34;backend_tests/services/test_cache_service.py::test_cache_pipeline&#34;, &#34;duration&#34;: &#34;4 ms&#34;, &#34;resultsTableRow&#34;: [&#34;&lt;td class=\&#34;col-result\&#34;&gt;Passed&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-testId\&#34;&gt;backend_tests/services/test_cache_service.py::test_cache_pipeline&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-duration\&#34;&gt;4 ms&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-links\&#34;&gt;&lt;/td&gt;&#34;], &#34;log&#34;: &#34;No log output captured.&#34;}], &#34;backend_tests/services/test_cache_service.py::test_cache_error_handling&#34;: [{&#34;extras&#34;: [], &#34;result&#34;: &#34;Passed&#34;, &#34;testId&#34;: &#34;backend_tests/services/test_cache_service.py::test_cache_error_handling&#34;, &#34;duration&#34;: &#34;4 ms&#34;, &#34;resultsTableRow&#34;: [&#34;&lt;td class=\&#34;col-result\&#34;&gt;Passed&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-testId\&#34;&gt;backend_tests/services/test_cache_service.py::test_cache_error_handling&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-duration\&#34;&gt;4 ms&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-links\&#34;&gt;&lt;/td&gt;&#34;], &#34;log&#34;: &#34;----------------------------- Captured stderr call -----------------------------\nERROR:core.services.cache:Error setting cache key test_key: Test exception\n\n------------------------------ Captured log call -------------------------------\nERROR    core.services.cache:cache.py:91 Error setting cache key test_key: Test exception\n\n&#34;}], &#34;backend_tests/services/test_cache_service.py::test_cache_connection_handling&#34;: [{&#34;extras&#34;: [], &#34;result&#34;: &#34;Passed&#34;, &#34;testId&#34;: &#34;backend_tests/services/test_cache_service.py::test_cache_connection_handling&#34;, &#34;duration&#34;: &#34;3 ms&#34;, &#34;resultsTableRow&#34;: [&#34;&lt;td class=\&#34;col-result\&#34;&gt;Passed&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-testId\&#34;&gt;backend_tests/services/test_cache_service.py::test_cache_connection_handling&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-duration\&#34;&gt;3 ms&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-links\&#34;&gt;&lt;/td&gt;&#34;], &#34;log&#34;: &#34;No log output captured.&#34;}], &#34;backend_tests/services/test_cache_service.py::test_cache_prefix_handling&#34;: [{&#34;extras&#34;: [], &#34;result&#34;: &#34;Passed&#34;, &#34;testId&#34;: &#34;backend_tests/services/test_cache_service.py::test_cache_prefix_handling&#34;, &#34;duration&#34;: &#34;7 ms&#34;, &#34;resultsTableRow&#34;: [&#34;&lt;td class=\&#34;col-result\&#34;&gt;Passed&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-testId\&#34;&gt;backend_tests/services/test_cache_service.py::test_cache_prefix_handling&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-duration\&#34;&gt;7 ms&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-links\&#34;&gt;&lt;/td&gt;&#34;], &#34;log&#34;: &#34;No log output captured.&#34;}], &#34;backend_tests/services/test_deal_service.py::test_create_deal&#34;: [{&#34;extras&#34;: [], &#34;result&#34;: &#34;Passed&#34;, &#34;testId&#34;: &#34;backend_tests/services/test_deal_service.py::test_create_deal&#34;, &#34;duration&#34;: &#34;488 ms&#34;, &#34;resultsTableRow&#34;: [&#34;&lt;td class=\&#34;col-result\&#34;&gt;Passed&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-testId\&#34;&gt;backend_tests/services/test_deal_service.py::test_create_deal&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-duration\&#34;&gt;488 ms&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-links\&#34;&gt;&lt;/td&gt;&#34;], &#34;log&#34;: &#34;---------------------------- Captured stderr setup -----------------------------\nINFO:apscheduler.scheduler:Adding job tentatively -- it will be properly scheduled when the scheduler starts\nINFO:apscheduler.scheduler:Added job &amp;quot;DealService._monitor_deals&amp;quot; to job store &amp;quot;default&amp;quot;\nINFO:apscheduler.scheduler:Scheduler started\n\n------------------------------ Captured log setup ------------------------------\nINFO     apscheduler.scheduler:base.py:444 Adding job tentatively -- it will be properly scheduled when the scheduler starts\nINFO     apscheduler.scheduler:base.py:885 Added job &amp;quot;DealService._monitor_deals&amp;quot; to job store &amp;quot;default&amp;quot;\nINFO     apscheduler.scheduler:base.py:171 Scheduler started\n\n----------------------------- Captured stderr call -----------------------------\nERROR:core.services.deal:Failed to cache deal dcd43548-80f1-4b7c-98d4-1c42b2aa9c35: &amp;#x27;Deal&amp;#x27; object has no attribute &amp;#x27;score&amp;#x27;\nINFO:core.services.deal:Successfully created deal dcd43548-80f1-4b7c-98d4-1c42b2aa9c35 with score 80.0\n\n------------------------------ Captured log call -------------------------------\nERROR    core.services.deal:deal.py:849 Failed to cache deal dcd43548-80f1-4b7c-98d4-1c42b2aa9c35: &amp;#x27;Deal&amp;#x27; object has no attribute &amp;#x27;score&amp;#x27;\nINFO     core.services.deal:deal.py:367 Successfully created deal dcd43548-80f1-4b7c-98d4-1c42b2aa9c35 with score 80.0\n\n&#34;}], &#34;backend_tests/services/test_deal_service.py::test_get_deal&#34;: [{&#34;extras&#34;: [], &#34;result&#34;: &#34;Passed&#34;, &#34;testId&#34;: &#34;backend_tests/services/test_deal_service.py::test_get_deal&#34;, &#34;duration&#34;: &#34;325 ms&#34;, &#34;resultsTableRow&#34;: [&#34;&lt;td class=\&#34;col-result\&#34;&gt;Passed&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-testId\&#34;&gt;backend_tests/services/test_deal_service.py::test_get_deal&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-duration\&#34;&gt;325 ms&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-links\&#34;&gt;&lt;/td&gt;&#34;], &#34;log&#34;: &#34;---------------------------- Captured stderr setup -----------------------------\nINFO:apscheduler.scheduler:Adding job tentatively -- it will be properly scheduled when the scheduler starts\nINFO:apscheduler.scheduler:Added job &amp;quot;DealService._monitor_deals&amp;quot; to job store &amp;quot;default&amp;quot;\nINFO:apscheduler.scheduler:Scheduler started\n\n------------------------------ Captured log setup ------------------------------\nINFO     apscheduler.scheduler:base.py:444 Adding job tentatively -- it will be properly scheduled when the scheduler starts\nINFO     apscheduler.scheduler:base.py:885 Added job &amp;quot;DealService._monitor_deals&amp;quot; to job store &amp;quot;default&amp;quot;\nINFO     apscheduler.scheduler:base.py:171 Scheduler started\n&#34;}], &#34;backend_tests/services/test_deal_service.py::test_update_deal&#34;: [{&#34;extras&#34;: [], &#34;result&#34;: &#34;Passed&#34;, &#34;testId&#34;: &#34;backend_tests/services/test_deal_service.py::test_update_deal&#34;, &#34;duration&#34;: &#34;558 ms&#34;, &#34;resultsTableRow&#34;: [&#34;&lt;td class=\&#34;col-result\&#34;&gt;Passed&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-testId\&#34;&gt;backend_tests/services/test_deal_service.py::test_update_deal&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-duration\&#34;&gt;558 ms&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-links\&#34;&gt;&lt;/td&gt;&#34;], &#34;log&#34;: &#34;---------------------------- Captured stderr setup -----------------------------\nINFO:apscheduler.scheduler:Adding job tentatively -- it will be properly scheduled when the scheduler starts\nINFO:apscheduler.scheduler:Added job &amp;quot;DealService._monitor_deals&amp;quot; to job store &amp;quot;default&amp;quot;\nINFO:apscheduler.scheduler:Scheduler started\n\n------------------------------ Captured log setup ------------------------------\nINFO     apscheduler.scheduler:base.py:444 Adding job tentatively -- it will be properly scheduled when the scheduler starts\nINFO     apscheduler.scheduler:base.py:885 Added job &amp;quot;DealService._monitor_deals&amp;quot; to job store &amp;quot;default&amp;quot;\nINFO     apscheduler.scheduler:base.py:171 Scheduler started\n\n----------------------------- Captured stderr call -----------------------------\nINFO:core.repositories.deal:Updated deal 97e60114-0bdb-4a61-9de2-52aef3b8a8de successfully\nERROR:core.services.deal:Failed to cache deal 97e60114-0bdb-4a61-9de2-52aef3b8a8de: &amp;#x27;Deal&amp;#x27; object has no attribute &amp;#x27;score&amp;#x27;\n\n------------------------------ Captured log call -------------------------------\nINFO     core.repositories.deal:deal.py:120 Updated deal 97e60114-0bdb-4a61-9de2-52aef3b8a8de successfully\nERROR    core.services.deal:deal.py:849 Failed to cache deal 97e60114-0bdb-4a61-9de2-52aef3b8a8de: &amp;#x27;Deal&amp;#x27; object has no attribute &amp;#x27;score&amp;#x27;\n\n&#34;}], &#34;backend_tests/services/test_deal_service.py::test_list_deals&#34;: [{&#34;extras&#34;: [], &#34;result&#34;: &#34;Passed&#34;, &#34;testId&#34;: &#34;backend_tests/services/test_deal_service.py::test_list_deals&#34;, &#34;duration&#34;: &#34;310 ms&#34;, &#34;resultsTableRow&#34;: [&#34;&lt;td class=\&#34;col-result\&#34;&gt;Passed&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-testId\&#34;&gt;backend_tests/services/test_deal_service.py::test_list_deals&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-duration\&#34;&gt;310 ms&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-links\&#34;&gt;&lt;/td&gt;&#34;], &#34;log&#34;: &#34;---------------------------- Captured stderr setup -----------------------------\nINFO:apscheduler.scheduler:Adding job tentatively -- it will be properly scheduled when the scheduler starts\nINFO:apscheduler.scheduler:Added job &amp;quot;DealService._monitor_deals&amp;quot; to job store &amp;quot;default&amp;quot;\nINFO:apscheduler.scheduler:Scheduler started\n\n------------------------------ Captured log setup ------------------------------\nINFO     apscheduler.scheduler:base.py:444 Adding job tentatively -- it will be properly scheduled when the scheduler starts\nINFO     apscheduler.scheduler:base.py:885 Added job &amp;quot;DealService._monitor_deals&amp;quot; to job store &amp;quot;default&amp;quot;\nINFO     apscheduler.scheduler:base.py:171 Scheduler started\n&#34;}], &#34;backend_tests/services/test_deal_service.py::test_delete_deal&#34;: [{&#34;extras&#34;: [], &#34;result&#34;: &#34;Passed&#34;, &#34;testId&#34;: &#34;backend_tests/services/test_deal_service.py::test_delete_deal&#34;, &#34;duration&#34;: &#34;533 ms&#34;, &#34;resultsTableRow&#34;: [&#34;&lt;td class=\&#34;col-result\&#34;&gt;Passed&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-testId\&#34;&gt;backend_tests/services/test_deal_service.py::test_delete_deal&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-duration\&#34;&gt;533 ms&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-links\&#34;&gt;&lt;/td&gt;&#34;], &#34;log&#34;: &#34;---------------------------- Captured stderr setup -----------------------------\nINFO:apscheduler.scheduler:Adding job tentatively -- it will be properly scheduled when the scheduler starts\nINFO:apscheduler.scheduler:Added job &amp;quot;DealService._monitor_deals&amp;quot; to job store &amp;quot;default&amp;quot;\nINFO:apscheduler.scheduler:Scheduler started\n\n------------------------------ Captured log setup ------------------------------\nINFO     apscheduler.scheduler:base.py:444 Adding job tentatively -- it will be properly scheduled when the scheduler starts\nINFO     apscheduler.scheduler:base.py:885 Added job &amp;quot;DealService._monitor_deals&amp;quot; to job store &amp;quot;default&amp;quot;\nINFO     apscheduler.scheduler:base.py:171 Scheduler started\n\n----------------------------- Captured stderr call -----------------------------\nINFO:core.repositories.deal:Deleted deal 78ae55d8-fb2f-4756-ae27-446bd6758627\nWARNING:core.repositories.deal:Deal with ID 78ae55d8-fb2f-4756-ae27-446bd6758627 not found\n\n------------------------------ Captured log call -------------------------------\nINFO     core.repositories.deal:deal.py:143 Deleted deal 78ae55d8-fb2f-4756-ae27-446bd6758627\nWARNING  core.repositories.deal:deal.py:71 Deal with ID 78ae55d8-fb2f-4756-ae27-446bd6758627 not found\n\n&#34;}], &#34;backend_tests/services/test_deal_service.py::test_validate_deal&#34;: [{&#34;extras&#34;: [], &#34;result&#34;: &#34;Passed&#34;, &#34;testId&#34;: &#34;backend_tests/services/test_deal_service.py::test_validate_deal&#34;, &#34;duration&#34;: &#34;15 ms&#34;, &#34;resultsTableRow&#34;: [&#34;&lt;td class=\&#34;col-result\&#34;&gt;Passed&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-testId\&#34;&gt;backend_tests/services/test_deal_service.py::test_validate_deal&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-duration\&#34;&gt;15 ms&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-links\&#34;&gt;&lt;/td&gt;&#34;], &#34;log&#34;: &#34;---------------------------- Captured stderr setup -----------------------------\nINFO:apscheduler.scheduler:Adding job tentatively -- it will be properly scheduled when the scheduler starts\nINFO:apscheduler.scheduler:Added job &amp;quot;DealService._monitor_deals&amp;quot; to job store &amp;quot;default&amp;quot;\nINFO:apscheduler.scheduler:Scheduler started\n\n------------------------------ Captured log setup ------------------------------\nINFO     apscheduler.scheduler:base.py:444 Adding job tentatively -- it will be properly scheduled when the scheduler starts\nINFO     apscheduler.scheduler:base.py:885 Added job &amp;quot;DealService._monitor_deals&amp;quot; to job store &amp;quot;default&amp;quot;\nINFO     apscheduler.scheduler:base.py:171 Scheduler started\n&#34;}], &#34;backend_tests/services/test_deal_service.py::test_deal_price_tracking&#34;: [{&#34;extras&#34;: [], &#34;result&#34;: &#34;Passed&#34;, &#34;testId&#34;: &#34;backend_tests/services/test_deal_service.py::test_deal_price_tracking&#34;, &#34;duration&#34;: &#34;364 ms&#34;, &#34;resultsTableRow&#34;: [&#34;&lt;td class=\&#34;col-result\&#34;&gt;Passed&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-testId\&#34;&gt;backend_tests/services/test_deal_service.py::test_deal_price_tracking&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-duration\&#34;&gt;364 ms&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-links\&#34;&gt;&lt;/td&gt;&#34;], &#34;log&#34;: &#34;---------------------------- Captured stderr setup -----------------------------\nINFO:apscheduler.scheduler:Adding job tentatively -- it will be properly scheduled when the scheduler starts\nINFO:apscheduler.scheduler:Added job &amp;quot;DealService._monitor_deals&amp;quot; to job store &amp;quot;default&amp;quot;\nINFO:apscheduler.scheduler:Scheduler started\n\n------------------------------ Captured log setup ------------------------------\nINFO     apscheduler.scheduler:base.py:444 Adding job tentatively -- it will be properly scheduled when the scheduler starts\nINFO     apscheduler.scheduler:base.py:885 Added job &amp;quot;DealService._monitor_deals&amp;quot; to job store &amp;quot;default&amp;quot;\nINFO     apscheduler.scheduler:base.py:171 Scheduler started\n&#34;}], &#34;backend_tests/services/test_goal_service.py::test_create_goal&#34;: [{&#34;extras&#34;: [], &#34;result&#34;: &#34;Passed&#34;, &#34;testId&#34;: &#34;backend_tests/services/test_goal_service.py::test_create_goal&#34;, &#34;duration&#34;: &#34;247 ms&#34;, &#34;resultsTableRow&#34;: [&#34;&lt;td class=\&#34;col-result\&#34;&gt;Passed&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-testId\&#34;&gt;backend_tests/services/test_goal_service.py::test_create_goal&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-duration\&#34;&gt;247 ms&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-links\&#34;&gt;&lt;/td&gt;&#34;], &#34;log&#34;: &#34;---------------------------- Captured stderr setup -----------------------------\nINFO:backend_tests.mocks.redis_service_mock:Initialized Redis service with mock client\n\n------------------------------ Captured log setup ------------------------------\nINFO     backend_tests.mocks.redis_service_mock:redis_service_mock.py:42 Initialized Redis service with mock client\n\n----------------------------- Captured stderr call -----------------------------\nWARNING:core.services.goal:Error getting goal analytics: greenlet_spawn has not been called; can&amp;#x27;t call await_only() here. Was IO attempted in an unexpected place? (Background on this error at: https://sqlalche.me/e/20/xd2s)\nINFO:core.services.goal:Created goal 6c39ff1c-0bb9-41bb-bd0c-ff92364768a6 for user 64e780b5-e4c2-42af-b508-fdf6ad6e7e08\n\n------------------------------ Captured log call -------------------------------\nWARNING  core.services.goal:goal.py:835 Error getting goal analytics: greenlet_spawn has not been called; can&amp;#x27;t call await_only() here. Was IO attempted in an unexpected place? (Background on this error at: https://sqlalche.me/e/20/xd2s)\nINFO     core.services.goal:goal.py:213 Created goal 6c39ff1c-0bb9-41bb-bd0c-ff92364768a6 for user 64e780b5-e4c2-42af-b508-fdf6ad6e7e08\n\n&#34;}], &#34;backend_tests/services/test_goal_service.py::test_get_goal&#34;: [{&#34;extras&#34;: [], &#34;result&#34;: &#34;Passed&#34;, &#34;testId&#34;: &#34;backend_tests/services/test_goal_service.py::test_get_goal&#34;, &#34;duration&#34;: &#34;267 ms&#34;, &#34;resultsTableRow&#34;: [&#34;&lt;td class=\&#34;col-result\&#34;&gt;Passed&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-testId\&#34;&gt;backend_tests/services/test_goal_service.py::test_get_goal&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-duration\&#34;&gt;267 ms&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-links\&#34;&gt;&lt;/td&gt;&#34;], &#34;log&#34;: &#34;----------------------------- Captured stderr call -----------------------------\nERROR:core.services.goal:Failed to get goal non-existent-id: (sqlalchemy.dialects.postgresql.asyncpg.Error) &amp;lt;class &amp;#x27;asyncpg.exceptions.DataError&amp;#x27;&amp;gt;: invalid input for query argument $1: &amp;#x27;non-existent-id&amp;#x27; (invalid UUID &amp;#x27;non-existent-id&amp;#x27;: length must be between 32..36 characters, got 15)\n[SQL: SELECT goals.id, goals.user_id, goals.item_category, goals.title, goals.description, goals.constraints, goals.deadline, goals.status, goals.priority, goals.max_matches, goals.max_tokens, goals.notification_threshold, goals.auto_buy_threshold, goals.matches_found, goals.deals_processed, goals.tokens_spent, goals.rewards_earned, goals.last_checked_at, goals.last_processed_at, goals.processing_stats, goals.best_match_score, goals.average_match_score, goals.active_deals_count, goals.success_rate, goals.created_at, goals.updated_at \nFROM goals \nWHERE goals.id = $1::UUID]\n[parameters: (&amp;#x27;non-existent-id&amp;#x27;,)]\n(Background on this error at: https://sqlalche.me/e/20/dbapi)\nTraceback (most recent call last):\n  File &amp;quot;asyncpg\\protocol\\prepared_stmt.pyx&amp;quot;, line 175, in asyncpg.protocol.protocol.PreparedStatementState._encode_bind_msg\n  File &amp;quot;asyncpg\\protocol\\codecs/base.pyx&amp;quot;, line 227, in asyncpg.protocol.protocol.Codec.encode\n  File &amp;quot;asyncpg\\protocol\\codecs/base.pyx&amp;quot;, line 129, in asyncpg.protocol.protocol.Codec.encode_scalar\n  File &amp;quot;asyncpg\\pgproto\\./codecs/uuid.pyx&amp;quot;, line 16, in asyncpg.pgproto.pgproto.uuid_encode\n  File &amp;quot;asyncpg\\pgproto\\./uuid.pyx&amp;quot;, line 88, in asyncpg.pgproto.pgproto.pg_uuid_bytes_from_str\nValueError: invalid UUID &amp;#x27;non-existent-id&amp;#x27;: length must be between 32..36 characters, got 15\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File &amp;quot;C:\\Active Projects\\AI AGENTIC DEALS SYSTEM\\venv\\Lib\\site-packages\\sqlalchemy\\dialects\\postgresql\\asyncpg.py&amp;quot;, line 545, in _prepare_and_execute\n    self._rows = deque(await prepared_stmt.fetch(*parameters))\n                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File &amp;quot;C:\\Active Projects\\AI AGENTIC DEALS SYSTEM\\venv\\Lib\\site-packages\\asyncpg\\prepared_stmt.py&amp;quot;, line 176, in fetch\n    data = await self.__bind_execute(args, 0, timeout)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File &amp;quot;C:\\Active Projects\\AI AGENTIC DEALS SYSTEM\\venv\\Lib\\site-packages\\asyncpg\\prepared_stmt.py&amp;quot;, line 241, in __bind_execute\n    data, status, _ = await self.__do_execute(\n                      ^^^^^^^^^^^^^^^^^^^^^^^^\n  File &amp;quot;C:\\Active Projects\\AI AGENTIC DEALS SYSTEM\\venv\\Lib\\site-packages\\asyncpg\\prepared_stmt.py&amp;quot;, line 230, in __do_execute\n    return await executor(protocol)\n           ^^^^^^^^^^^^^^^^^^^^^^^^\n  File &amp;quot;asyncpg\\protocol\\protocol.pyx&amp;quot;, line 186, in bind_execute\n  File &amp;quot;asyncpg\\protocol\\prepared_stmt.pyx&amp;quot;, line 204, in asyncpg.protocol.protocol.PreparedStatementState._encode_bind_msg\nasyncpg.exceptions.DataError: invalid input for query argument $1: &amp;#x27;non-existent-id&amp;#x27; (invalid UUID &amp;#x27;non-existent-id&amp;#x27;: length must be between 32..36 characters, got 15)\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File &amp;quot;C:\\Active Projects\\AI AGENTIC DEALS SYSTEM\\venv\\Lib\\site-packages\\sqlalchemy\\engine\\base.py&amp;quot;, line 1964, in _exec_single_context\n    self.dialect.do_execute(\n  File &amp;quot;C:\\Active Projects\\AI AGENTIC DEALS SYSTEM\\venv\\Lib\\site-packages\\sqlalchemy\\engine\\default.py&amp;quot;, line 942, in do_execute\n    cursor.execute(statement, parameters)\n  File &amp;quot;C:\\Active Projects\\AI AGENTIC DEALS SYSTEM\\venv\\Lib\\site-packages\\sqlalchemy\\dialects\\postgresql\\asyncpg.py&amp;quot;, line 580, in execute\n    self._adapt_connection.await_(\n  File &amp;quot;C:\\Active Projects\\AI AGENTIC DEALS SYSTEM\\venv\\Lib\\site-packages\\sqlalchemy\\util\\_concurrency_py3k.py&amp;quot;, line 132, in await_only\n    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File &amp;quot;C:\\Active Projects\\AI AGENTIC DEALS SYSTEM\\venv\\Lib\\site-packages\\sqlalchemy\\util\\_concurrency_py3k.py&amp;quot;, line 196, in greenlet_spawn\n    value = await result\n            ^^^^^^^^^^^^\n  File &amp;quot;C:\\Active Projects\\AI AGENTIC DEALS SYSTEM\\venv\\Lib\\site-packages\\sqlalchemy\\dialects\\postgresql\\asyncpg.py&amp;quot;, line 558, in _prepare_and_execute\n    self._handle_exception(error)\n  File &amp;quot;C:\\Active Projects\\AI AGENTIC DEALS SYSTEM\\venv\\Lib\\site-packages\\sqlalchemy\\dialects\\postgresql\\asyncpg.py&amp;quot;, line 508, in _handle_exception\n    self._adapt_connection._handle_exception(error)\n  File &amp;quot;C:\\Active Projects\\AI AGENTIC DEALS SYSTEM\\venv\\Lib\\site-packages\\sqlalchemy\\dialects\\postgresql\\asyncpg.py&amp;quot;, line 792, in _handle_exception\n    raise translated_error from error\nsqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.Error: &amp;lt;class &amp;#x27;asyncpg.exceptions.DataError&amp;#x27;&amp;gt;: invalid input for query argument $1: &amp;#x27;non-existent-id&amp;#x27; (invalid UUID &amp;#x27;non-existent-id&amp;#x27;: length must be between 32..36 characters, got 15)\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File &amp;quot;C:\\Active Projects\\AI AGENTIC DEALS SYSTEM\\backend\\core\\services\\goal.py&amp;quot;, line 376, in get_goal\n    result = await self.session.execute(query)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File &amp;quot;C:\\Active Projects\\AI AGENTIC DEALS SYSTEM\\venv\\Lib\\site-packages\\sqlalchemy\\ext\\asyncio\\session.py&amp;quot;, line 463, in execute\n    result = await greenlet_spawn(\n             ^^^^^^^^^^^^^^^^^^^^^\n  File &amp;quot;C:\\Active Projects\\AI AGENTIC DEALS SYSTEM\\venv\\Lib\\site-packages\\sqlalchemy\\util\\_concurrency_py3k.py&amp;quot;, line 201, in greenlet_spawn\n    result = context.throw(*sys.exc_info())\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File &amp;quot;C:\\Active Projects\\AI AGENTIC DEALS SYSTEM\\venv\\Lib\\site-packages\\sqlalchemy\\orm\\session.py&amp;quot;, line 2365, in execute\n    return self._execute_internal(\n           ^^^^^^^^^^^^^^^^^^^^^^^\n  File &amp;quot;C:\\Active Projects\\AI AGENTIC DEALS SYSTEM\\venv\\Lib\\site-packages\\sqlalchemy\\orm\\session.py&amp;quot;, line 2251, in _execute_internal\n    result: Result[Any] = compile_state_cls.orm_execute_statement(\n                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File &amp;quot;C:\\Active Projects\\AI AGENTIC DEALS SYSTEM\\venv\\Lib\\site-packages\\sqlalchemy\\orm\\context.py&amp;quot;, line 305, in orm_execute_statement\n    result = conn.execute(\n             ^^^^^^^^^^^^^\n  File &amp;quot;C:\\Active Projects\\AI AGENTIC DEALS SYSTEM\\venv\\Lib\\site-packages\\sqlalchemy\\engine\\base.py&amp;quot;, line 1416, in execute\n    return meth(\n           ^^^^^\n  File &amp;quot;C:\\Active Projects\\AI AGENTIC DEALS SYSTEM\\venv\\Lib\\site-packages\\sqlalchemy\\sql\\elements.py&amp;quot;, line 516, in _execute_on_connection\n    return connection._execute_clauseelement(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File &amp;quot;C:\\Active Projects\\AI AGENTIC DEALS SYSTEM\\venv\\Lib\\site-packages\\sqlalchemy\\engine\\base.py&amp;quot;, line 1638, in _execute_clauseelement\n    ret = self._execute_context(\n          ^^^^^^^^^^^^^^^^^^^^^^\n  File &amp;quot;C:\\Active Projects\\AI AGENTIC DEALS SYSTEM\\venv\\Lib\\site-packages\\sqlalchemy\\engine\\base.py&amp;quot;, line 1843, in _execute_context\n    return self._exec_single_context(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File &amp;quot;C:\\Active Projects\\AI AGENTIC DEALS SYSTEM\\venv\\Lib\\site-packages\\sqlalchemy\\engine\\base.py&amp;quot;, line 1983, in _exec_single_context\n    self._handle_dbapi_exception(\n  File &amp;quot;C:\\Active Projects\\AI AGENTIC DEALS SYSTEM\\venv\\Lib\\site-packages\\sqlalchemy\\engine\\base.py&amp;quot;, line 2352, in _handle_dbapi_exception\n    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e\n  File &amp;quot;C:\\Active Projects\\AI AGENTIC DEALS SYSTEM\\venv\\Lib\\site-packages\\sqlalchemy\\engine\\base.py&amp;quot;, line 1964, in _exec_single_context\n    self.dialect.do_execute(\n  File &amp;quot;C:\\Active Projects\\AI AGENTIC DEALS SYSTEM\\venv\\Lib\\site-packages\\sqlalchemy\\engine\\default.py&amp;quot;, line 942, in do_execute\n    cursor.execute(statement, parameters)\n  File &amp;quot;C:\\Active Projects\\AI AGENTIC DEALS SYSTEM\\venv\\Lib\\site-packages\\sqlalchemy\\dialects\\postgresql\\asyncpg.py&amp;quot;, line 580, in execute\n    self._adapt_connection.await_(\n  File &amp;quot;C:\\Active Projects\\AI AGENTIC DEALS SYSTEM\\venv\\Lib\\site-packages\\sqlalchemy\\util\\_concurrency_py3k.py&amp;quot;, line 132, in await_only\n    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File &amp;quot;C:\\Active Projects\\AI AGENTIC DEALS SYSTEM\\venv\\Lib\\site-packages\\sqlalchemy\\util\\_concurrency_py3k.py&amp;quot;, line 196, in greenlet_spawn\n    value = await result\n            ^^^^^^^^^^^^\n  File &amp;quot;C:\\Active Projects\\AI AGENTIC DEALS SYSTEM\\venv\\Lib\\site-packages\\sqlalchemy\\dialects\\postgresql\\asyncpg.py&amp;quot;, line 558, in _prepare_and_execute\n    self._handle_exception(error)\n  File &amp;quot;C:\\Active Projects\\AI AGENTIC DEALS SYSTEM\\venv\\Lib\\site-packages\\sqlalchemy\\dialects\\postgresql\\asyncpg.py&amp;quot;, line 508, in _handle_exception\n    self._adapt_connection._handle_exception(error)\n  File &amp;quot;C:\\Active Projects\\AI AGENTIC DEALS SYSTEM\\venv\\Lib\\site-packages\\sqlalchemy\\dialects\\postgresql\\asyncpg.py&amp;quot;, line 792, in _handle_exception\n    raise translated_error from error\nsqlalchemy.exc.DBAPIError: (sqlalchemy.dialects.postgresql.asyncpg.Error) &amp;lt;class &amp;#x27;asyncpg.exceptions.DataError&amp;#x27;&amp;gt;: invalid input for query argument $1: &amp;#x27;non-existent-id&amp;#x27; (invalid UUID &amp;#x27;non-existent-id&amp;#x27;: length must be between 32..36 characters, got 15)\n[SQL: SELECT goals.id, goals.user_id, goals.item_category, goals.title, goals.description, goals.constraints, goals.deadline, goals.status, goals.priority, goals.max_matches, goals.max_tokens, goals.notification_threshold, goals.auto_buy_threshold, goals.matches_found, goals.deals_processed, goals.tokens_spent, goals.rewards_earned, goals.last_checked_at, goals.last_processed_at, goals.processing_stats, goals.best_match_score, goals.average_match_score, goals.active_deals_count, goals.success_rate, goals.created_at, goals.updated_at \nFROM goals \nWHERE goals.id = $1::UUID]\n[parameters: (&amp;#x27;non-existent-id&amp;#x27;,)]\n(Background on this error at: https://sqlalche.me/e/20/dbapi)\n\n------------------------------ Captured log call -------------------------------\nERROR    core.services.goal:goal.py:414 Failed to get goal non-existent-id: (sqlalchemy.dialects.postgresql.asyncpg.Error) &amp;lt;class &amp;#x27;asyncpg.exceptions.DataError&amp;#x27;&amp;gt;: invalid input for query argument $1: &amp;#x27;non-existent-id&amp;#x27; (invalid UUID &amp;#x27;non-existent-id&amp;#x27;: length must be between 32..36 characters, got 15)\n[SQL: SELECT goals.id, goals.user_id, goals.item_category, goals.title, goals.description, goals.constraints, goals.deadline, goals.status, goals.priority, goals.max_matches, goals.max_tokens, goals.notification_threshold, goals.auto_buy_threshold, goals.matches_found, goals.deals_processed, goals.tokens_spent, goals.rewards_earned, goals.last_checked_at, goals.last_processed_at, goals.processing_stats, goals.best_match_score, goals.average_match_score, goals.active_deals_count, goals.success_rate, goals.created_at, goals.updated_at \nFROM goals \nWHERE goals.id = $1::UUID]\n[parameters: (&amp;#x27;non-existent-id&amp;#x27;,)]\n(Background on this error at: https://sqlalche.me/e/20/dbapi)\nTraceback (most recent call last):\n  File &amp;quot;asyncpg\\protocol\\prepared_stmt.pyx&amp;quot;, line 175, in asyncpg.protocol.protocol.PreparedStatementState._encode_bind_msg\n  File &amp;quot;asyncpg\\protocol\\codecs/base.pyx&amp;quot;, line 227, in asyncpg.protocol.protocol.Codec.encode\n  File &amp;quot;asyncpg\\protocol\\codecs/base.pyx&amp;quot;, line 129, in asyncpg.protocol.protocol.Codec.encode_scalar\n  File &amp;quot;asyncpg\\pgproto\\./codecs/uuid.pyx&amp;quot;, line 16, in asyncpg.pgproto.pgproto.uuid_encode\n  File &amp;quot;asyncpg\\pgproto\\./uuid.pyx&amp;quot;, line 88, in asyncpg.pgproto.pgproto.pg_uuid_bytes_from_str\nValueError: invalid UUID &amp;#x27;non-existent-id&amp;#x27;: length must be between 32..36 characters, got 15\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File &amp;quot;C:\\Active Projects\\AI AGENTIC DEALS SYSTEM\\venv\\Lib\\site-packages\\sqlalchemy\\dialects\\postgresql\\asyncpg.py&amp;quot;, line 545, in _prepare_and_execute\n    self._rows = deque(await prepared_stmt.fetch(*parameters))\n                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File &amp;quot;C:\\Active Projects\\AI AGENTIC DEALS SYSTEM\\venv\\Lib\\site-packages\\asyncpg\\prepared_stmt.py&amp;quot;, line 176, in fetch\n    data = await self.__bind_execute(args, 0, timeout)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File &amp;quot;C:\\Active Projects\\AI AGENTIC DEALS SYSTEM\\venv\\Lib\\site-packages\\asyncpg\\prepared_stmt.py&amp;quot;, line 241, in __bind_execute\n    data, status, _ = await self.__do_execute(\n                      ^^^^^^^^^^^^^^^^^^^^^^^^\n  File &amp;quot;C:\\Active Projects\\AI AGENTIC DEALS SYSTEM\\venv\\Lib\\site-packages\\asyncpg\\prepared_stmt.py&amp;quot;, line 230, in __do_execute\n    return await executor(protocol)\n           ^^^^^^^^^^^^^^^^^^^^^^^^\n  File &amp;quot;asyncpg\\protocol\\protocol.pyx&amp;quot;, line 186, in bind_execute\n  File &amp;quot;asyncpg\\protocol\\prepared_stmt.pyx&amp;quot;, line 204, in asyncpg.protocol.protocol.PreparedStatementState._encode_bind_msg\nasyncpg.exceptions.DataError: invalid input for query argument $1: &amp;#x27;non-existent-id&amp;#x27; (invalid UUID &amp;#x27;non-existent-id&amp;#x27;: length must be between 32..36 characters, got 15)\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File &amp;quot;C:\\Active Projects\\AI AGENTIC DEALS SYSTEM\\venv\\Lib\\site-packages\\sqlalchemy\\engine\\base.py&amp;quot;, line 1964, in _exec_single_context\n    self.dialect.do_execute(\n  File &amp;quot;C:\\Active Projects\\AI AGENTIC DEALS SYSTEM\\venv\\Lib\\site-packages\\sqlalchemy\\engine\\default.py&amp;quot;, line 942, in do_execute\n    cursor.execute(statement, parameters)\n  File &amp;quot;C:\\Active Projects\\AI AGENTIC DEALS SYSTEM\\venv\\Lib\\site-packages\\sqlalchemy\\dialects\\postgresql\\asyncpg.py&amp;quot;, line 580, in execute\n    self._adapt_connection.await_(\n  File &amp;quot;C:\\Active Projects\\AI AGENTIC DEALS SYSTEM\\venv\\Lib\\site-packages\\sqlalchemy\\util\\_concurrency_py3k.py&amp;quot;, line 132, in await_only\n    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File &amp;quot;C:\\Active Projects\\AI AGENTIC DEALS SYSTEM\\venv\\Lib\\site-packages\\sqlalchemy\\util\\_concurrency_py3k.py&amp;quot;, line 196, in greenlet_spawn\n    value = await result\n            ^^^^^^^^^^^^\n  File &amp;quot;C:\\Active Projects\\AI AGENTIC DEALS SYSTEM\\venv\\Lib\\site-packages\\sqlalchemy\\dialects\\postgresql\\asyncpg.py&amp;quot;, line 558, in _prepare_and_execute\n    self._handle_exception(error)\n  File &amp;quot;C:\\Active Projects\\AI AGENTIC DEALS SYSTEM\\venv\\Lib\\site-packages\\sqlalchemy\\dialects\\postgresql\\asyncpg.py&amp;quot;, line 508, in _handle_exception\n    self._adapt_connection._handle_exception(error)\n  File &amp;quot;C:\\Active Projects\\AI AGENTIC DEALS SYSTEM\\venv\\Lib\\site-packages\\sqlalchemy\\dialects\\postgresql\\asyncpg.py&amp;quot;, line 792, in _handle_exception\n    raise translated_error from error\nsqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.Error: &amp;lt;class &amp;#x27;asyncpg.exceptions.DataError&amp;#x27;&amp;gt;: invalid input for query argument $1: &amp;#x27;non-existent-id&amp;#x27; (invalid UUID &amp;#x27;non-existent-id&amp;#x27;: length must be between 32..36 characters, got 15)\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File &amp;quot;C:\\Active Projects\\AI AGENTIC DEALS SYSTEM\\backend\\core\\services\\goal.py&amp;quot;, line 376, in get_goal\n    result = await self.session.execute(query)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File &amp;quot;C:\\Active Projects\\AI AGENTIC DEALS SYSTEM\\venv\\Lib\\site-packages\\sqlalchemy\\ext\\asyncio\\session.py&amp;quot;, line 463, in execute\n    result = await greenlet_spawn(\n             ^^^^^^^^^^^^^^^^^^^^^\n  File &amp;quot;C:\\Active Projects\\AI AGENTIC DEALS SYSTEM\\venv\\Lib\\site-packages\\sqlalchemy\\util\\_concurrency_py3k.py&amp;quot;, line 201, in greenlet_spawn\n    result = context.throw(*sys.exc_info())\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File &amp;quot;C:\\Active Projects\\AI AGENTIC DEALS SYSTEM\\venv\\Lib\\site-packages\\sqlalchemy\\orm\\session.py&amp;quot;, line 2365, in execute\n    return self._execute_internal(\n           ^^^^^^^^^^^^^^^^^^^^^^^\n  File &amp;quot;C:\\Active Projects\\AI AGENTIC DEALS SYSTEM\\venv\\Lib\\site-packages\\sqlalchemy\\orm\\session.py&amp;quot;, line 2251, in _execute_internal\n    result: Result[Any] = compile_state_cls.orm_execute_statement(\n                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File &amp;quot;C:\\Active Projects\\AI AGENTIC DEALS SYSTEM\\venv\\Lib\\site-packages\\sqlalchemy\\orm\\context.py&amp;quot;, line 305, in orm_execute_statement\n    result = conn.execute(\n             ^^^^^^^^^^^^^\n  File &amp;quot;C:\\Active Projects\\AI AGENTIC DEALS SYSTEM\\venv\\Lib\\site-packages\\sqlalchemy\\engine\\base.py&amp;quot;, line 1416, in execute\n    return meth(\n           ^^^^^\n  File &amp;quot;C:\\Active Projects\\AI AGENTIC DEALS SYSTEM\\venv\\Lib\\site-packages\\sqlalchemy\\sql\\elements.py&amp;quot;, line 516, in _execute_on_connection\n    return connection._execute_clauseelement(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File &amp;quot;C:\\Active Projects\\AI AGENTIC DEALS SYSTEM\\venv\\Lib\\site-packages\\sqlalchemy\\engine\\base.py&amp;quot;, line 1638, in _execute_clauseelement\n    ret = self._execute_context(\n          ^^^^^^^^^^^^^^^^^^^^^^\n  File &amp;quot;C:\\Active Projects\\AI AGENTIC DEALS SYSTEM\\venv\\Lib\\site-packages\\sqlalchemy\\engine\\base.py&amp;quot;, line 1843, in _execute_context\n    return self._exec_single_context(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File &amp;quot;C:\\Active Projects\\AI AGENTIC DEALS SYSTEM\\venv\\Lib\\site-packages\\sqlalchemy\\engine\\base.py&amp;quot;, line 1983, in _exec_single_context\n    self._handle_dbapi_exception(\n  File &amp;quot;C:\\Active Projects\\AI AGENTIC DEALS SYSTEM\\venv\\Lib\\site-packages\\sqlalchemy\\engine\\base.py&amp;quot;, line 2352, in _handle_dbapi_exception\n    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e\n  File &amp;quot;C:\\Active Projects\\AI AGENTIC DEALS SYSTEM\\venv\\Lib\\site-packages\\sqlalchemy\\engine\\base.py&amp;quot;, line 1964, in _exec_single_context\n    self.dialect.do_execute(\n  File &amp;quot;C:\\Active Projects\\AI AGENTIC DEALS SYSTEM\\venv\\Lib\\site-packages\\sqlalchemy\\engine\\default.py&amp;quot;, line 942, in do_execute\n    cursor.execute(statement, parameters)\n  File &amp;quot;C:\\Active Projects\\AI AGENTIC DEALS SYSTEM\\venv\\Lib\\site-packages\\sqlalchemy\\dialects\\postgresql\\asyncpg.py&amp;quot;, line 580, in execute\n    self._adapt_connection.await_(\n  File &amp;quot;C:\\Active Projects\\AI AGENTIC DEALS SYSTEM\\venv\\Lib\\site-packages\\sqlalchemy\\util\\_concurrency_py3k.py&amp;quot;, line 132, in await_only\n    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File &amp;quot;C:\\Active Projects\\AI AGENTIC DEALS SYSTEM\\venv\\Lib\\site-packages\\sqlalchemy\\util\\_concurrency_py3k.py&amp;quot;, line 196, in greenlet_spawn\n    value = await result\n            ^^^^^^^^^^^^\n  File &amp;quot;C:\\Active Projects\\AI AGENTIC DEALS SYSTEM\\venv\\Lib\\site-packages\\sqlalchemy\\dialects\\postgresql\\asyncpg.py&amp;quot;, line 558, in _prepare_and_execute\n    self._handle_exception(error)\n  File &amp;quot;C:\\Active Projects\\AI AGENTIC DEALS SYSTEM\\venv\\Lib\\site-packages\\sqlalchemy\\dialects\\postgresql\\asyncpg.py&amp;quot;, line 508, in _handle_exception\n    self._adapt_connection._handle_exception(error)\n  File &amp;quot;C:\\Active Projects\\AI AGENTIC DEALS SYSTEM\\venv\\Lib\\site-packages\\sqlalchemy\\dialects\\postgresql\\asyncpg.py&amp;quot;, line 792, in _handle_exception\n    raise translated_error from error\nsqlalchemy.exc.DBAPIError: (sqlalchemy.dialects.postgresql.asyncpg.Error) &amp;lt;class &amp;#x27;asyncpg.exceptions.DataError&amp;#x27;&amp;gt;: invalid input for query argument $1: &amp;#x27;non-existent-id&amp;#x27; (invalid UUID &amp;#x27;non-existent-id&amp;#x27;: length must be between 32..36 characters, got 15)\n[SQL: SELECT goals.id, goals.user_id, goals.item_category, goals.title, goals.description, goals.constraints, goals.deadline, goals.status, goals.priority, goals.max_matches, goals.max_tokens, goals.notification_threshold, goals.auto_buy_threshold, goals.matches_found, goals.deals_processed, goals.tokens_spent, goals.rewards_earned, goals.last_checked_at, goals.last_processed_at, goals.processing_stats, goals.best_match_score, goals.average_match_score, goals.active_deals_count, goals.success_rate, goals.created_at, goals.updated_at \nFROM goals \nWHERE goals.id = $1::UUID]\n[parameters: (&amp;#x27;non-existent-id&amp;#x27;,)]\n(Background on this error at: https://sqlalche.me/e/20/dbapi)\n\n&#34;}], &#34;backend_tests/services/test_goal_service.py::test_update_goal&#34;: [{&#34;extras&#34;: [], &#34;result&#34;: &#34;Passed&#34;, &#34;testId&#34;: &#34;backend_tests/services/test_goal_service.py::test_update_goal&#34;, &#34;duration&#34;: &#34;255 ms&#34;, &#34;resultsTableRow&#34;: [&#34;&lt;td class=\&#34;col-result\&#34;&gt;Passed&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-testId\&#34;&gt;backend_tests/services/test_goal_service.py::test_update_goal&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-duration\&#34;&gt;255 ms&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-links\&#34;&gt;&lt;/td&gt;&#34;], &#34;log&#34;: &#34;----------------------------- Captured stderr call -----------------------------\nINFO:core.services.goal:Updated goal 71f4f61b-10b1-4551-b1c8-5b7f06bec42d\n\n------------------------------ Captured log call -------------------------------\nINFO     core.services.goal:goal.py:1073 Updated goal 71f4f61b-10b1-4551-b1c8-5b7f06bec42d\n\n&#34;}], &#34;backend_tests/services/test_goal_service.py::test_list_goals&#34;: [{&#34;extras&#34;: [], &#34;result&#34;: &#34;Passed&#34;, &#34;testId&#34;: &#34;backend_tests/services/test_goal_service.py::test_list_goals&#34;, &#34;duration&#34;: &#34;307 ms&#34;, &#34;resultsTableRow&#34;: [&#34;&lt;td class=\&#34;col-result\&#34;&gt;Passed&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-testId\&#34;&gt;backend_tests/services/test_goal_service.py::test_list_goals&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-duration\&#34;&gt;307 ms&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-links\&#34;&gt;&lt;/td&gt;&#34;], &#34;log&#34;: &#34;----------------------------- Captured stderr call -----------------------------\nINFO:core.services.goal:Retrieved 20 goals. Filters: user_id=None, status=None, min_priority=None\nINFO:core.services.goal:Retrieved 3 goals. Filters: user_id=c091da78-2886-4749-a3d2-f04fdc992043, status=None, min_priority=None\nINFO:core.services.goal:Retrieved 20 goals. Filters: user_id=None, status=GoalStatus.ACTIVE, min_priority=None\nINFO:core.services.goal:Retrieved 2 goals. Filters: user_id=None, status=None, min_priority=2\n\n------------------------------ Captured log call -------------------------------\nINFO     core.services.goal:goal.py:1163 Retrieved 20 goals. Filters: user_id=None, status=None, min_priority=None\nINFO     core.services.goal:goal.py:1163 Retrieved 3 goals. Filters: user_id=c091da78-2886-4749-a3d2-f04fdc992043, status=None, min_priority=None\nINFO     core.services.goal:goal.py:1163 Retrieved 20 goals. Filters: user_id=None, status=GoalStatus.ACTIVE, min_priority=None\nINFO     core.services.goal:goal.py:1163 Retrieved 2 goals. Filters: user_id=None, status=None, min_priority=2\n\n&#34;}], &#34;backend_tests/services/test_goal_service.py::test_delete_goal&#34;: [{&#34;extras&#34;: [], &#34;result&#34;: &#34;Passed&#34;, &#34;testId&#34;: &#34;backend_tests/services/test_goal_service.py::test_delete_goal&#34;, &#34;duration&#34;: &#34;251 ms&#34;, &#34;resultsTableRow&#34;: [&#34;&lt;td class=\&#34;col-result\&#34;&gt;Passed&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-testId\&#34;&gt;backend_tests/services/test_goal_service.py::test_delete_goal&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-duration\&#34;&gt;251 ms&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-links\&#34;&gt;&lt;/td&gt;&#34;], &#34;log&#34;: &#34;----------------------------- Captured stderr call -----------------------------\nINFO:core.services.goal:Deleted goal 51947e07-3e95-4719-b219-7d2a7ba6b948\nERROR:core.services.goal:Failed to get goal 51947e07-3e95-4719-b219-7d2a7ba6b948: Goal not found\nTraceback (most recent call last):\n  File &amp;quot;C:\\Active Projects\\AI AGENTIC DEALS SYSTEM\\backend\\core\\services\\goal.py&amp;quot;, line 379, in get_goal\n    raise GoalNotFoundError(f&amp;quot;Goal {goal_id} not found&amp;quot;)\ncore.exceptions.goal_exceptions.GoalNotFoundError: Goal not found\n\n------------------------------ Captured log call -------------------------------\nINFO     core.services.goal:goal.py:498 Deleted goal 51947e07-3e95-4719-b219-7d2a7ba6b948\nERROR    core.services.goal:goal.py:414 Failed to get goal 51947e07-3e95-4719-b219-7d2a7ba6b948: Goal not found\nTraceback (most recent call last):\n  File &amp;quot;C:\\Active Projects\\AI AGENTIC DEALS SYSTEM\\backend\\core\\services\\goal.py&amp;quot;, line 379, in get_goal\n    raise GoalNotFoundError(f&amp;quot;Goal {goal_id} not found&amp;quot;)\ncore.exceptions.goal_exceptions.GoalNotFoundError: Goal not found\n\n&#34;}], &#34;backend_tests/services/test_goal_service.py::test_validate_goal&#34;: [{&#34;extras&#34;: [], &#34;result&#34;: &#34;Passed&#34;, &#34;testId&#34;: &#34;backend_tests/services/test_goal_service.py::test_validate_goal&#34;, &#34;duration&#34;: &#34;3 ms&#34;, &#34;resultsTableRow&#34;: [&#34;&lt;td class=\&#34;col-result\&#34;&gt;Passed&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-testId\&#34;&gt;backend_tests/services/test_goal_service.py::test_validate_goal&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-duration\&#34;&gt;3 ms&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-links\&#34;&gt;&lt;/td&gt;&#34;], &#34;log&#34;: &#34;No log output captured.&#34;}], &#34;backend_tests/services/test_goal_service.py::test_goal_constraints_validation&#34;: [{&#34;extras&#34;: [], &#34;result&#34;: &#34;Passed&#34;, &#34;testId&#34;: &#34;backend_tests/services/test_goal_service.py::test_goal_constraints_validation&#34;, &#34;duration&#34;: &#34;4 ms&#34;, &#34;resultsTableRow&#34;: [&#34;&lt;td class=\&#34;col-result\&#34;&gt;Passed&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-testId\&#34;&gt;backend_tests/services/test_goal_service.py::test_goal_constraints_validation&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-duration\&#34;&gt;4 ms&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-links\&#34;&gt;&lt;/td&gt;&#34;], &#34;log&#34;: &#34;----------------------------- Captured stderr call -----------------------------\nERROR:core.services.goal:Constraints validation failed: Missing required constraint fields: keywords\nERROR:core.services.goal:Constraints validation failed: Missing required constraint fields: min_price, max_price\n\n------------------------------ Captured log call -------------------------------\nERROR    core.services.goal:goal.py:992 Constraints validation failed: Missing required constraint fields: keywords\nERROR    core.services.goal:goal.py:992 Constraints validation failed: Missing required constraint fields: min_price, max_price\n\n&#34;}], &#34;backend_tests/services/test_market_service.py::test_create_market&#34;: [{&#34;extras&#34;: [], &#34;result&#34;: &#34;Passed&#34;, &#34;testId&#34;: &#34;backend_tests/services/test_market_service.py::test_create_market&#34;, &#34;duration&#34;: &#34;9 ms&#34;, &#34;resultsTableRow&#34;: [&#34;&lt;td class=\&#34;col-result\&#34;&gt;Passed&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-testId\&#34;&gt;backend_tests/services/test_market_service.py::test_create_market&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-duration\&#34;&gt;9 ms&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-links\&#34;&gt;&lt;/td&gt;&#34;], &#34;log&#34;: &#34;No log output captured.&#34;}], &#34;backend_tests/services/test_market_service.py::test_get_market&#34;: [{&#34;extras&#34;: [], &#34;result&#34;: &#34;Passed&#34;, &#34;testId&#34;: &#34;backend_tests/services/test_market_service.py::test_get_market&#34;, &#34;duration&#34;: &#34;7 ms&#34;, &#34;resultsTableRow&#34;: [&#34;&lt;td class=\&#34;col-result\&#34;&gt;Passed&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-testId\&#34;&gt;backend_tests/services/test_market_service.py::test_get_market&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-duration\&#34;&gt;7 ms&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-links\&#34;&gt;&lt;/td&gt;&#34;], &#34;log&#34;: &#34;No log output captured.&#34;}], &#34;backend_tests/services/test_market_service.py::test_update_market&#34;: [{&#34;extras&#34;: [], &#34;result&#34;: &#34;Passed&#34;, &#34;testId&#34;: &#34;backend_tests/services/test_market_service.py::test_update_market&#34;, &#34;duration&#34;: &#34;12 ms&#34;, &#34;resultsTableRow&#34;: [&#34;&lt;td class=\&#34;col-result\&#34;&gt;Passed&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-testId\&#34;&gt;backend_tests/services/test_market_service.py::test_update_market&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-duration\&#34;&gt;12 ms&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-links\&#34;&gt;&lt;/td&gt;&#34;], &#34;log&#34;: &#34;No log output captured.&#34;}], &#34;backend_tests/services/test_market_service.py::test_list_markets&#34;: [{&#34;extras&#34;: [], &#34;result&#34;: &#34;Passed&#34;, &#34;testId&#34;: &#34;backend_tests/services/test_market_service.py::test_list_markets&#34;, &#34;duration&#34;: &#34;17 ms&#34;, &#34;resultsTableRow&#34;: [&#34;&lt;td class=\&#34;col-result\&#34;&gt;Passed&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-testId\&#34;&gt;backend_tests/services/test_market_service.py::test_list_markets&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-duration\&#34;&gt;17 ms&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-links\&#34;&gt;&lt;/td&gt;&#34;], &#34;log&#34;: &#34;No log output captured.&#34;}], &#34;backend_tests/services/test_market_service.py::test_validate_market_config&#34;: [{&#34;extras&#34;: [], &#34;result&#34;: &#34;Passed&#34;, &#34;testId&#34;: &#34;backend_tests/services/test_market_service.py::test_validate_market_config&#34;, &#34;duration&#34;: &#34;3 ms&#34;, &#34;resultsTableRow&#34;: [&#34;&lt;td class=\&#34;col-result\&#34;&gt;Passed&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-testId\&#34;&gt;backend_tests/services/test_market_service.py::test_validate_market_config&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-duration\&#34;&gt;3 ms&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-links\&#34;&gt;&lt;/td&gt;&#34;], &#34;log&#34;: &#34;No log output captured.&#34;}], &#34;backend_tests/services/test_market_service.py::test_market_integration&#34;: [{&#34;extras&#34;: [], &#34;result&#34;: &#34;Passed&#34;, &#34;testId&#34;: &#34;backend_tests/services/test_market_service.py::test_market_integration&#34;, &#34;duration&#34;: &#34;65 ms&#34;, &#34;resultsTableRow&#34;: [&#34;&lt;td class=\&#34;col-result\&#34;&gt;Passed&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-testId\&#34;&gt;backend_tests/services/test_market_service.py::test_market_integration&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-duration\&#34;&gt;65 ms&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-links\&#34;&gt;&lt;/td&gt;&#34;], &#34;log&#34;: &#34;No log output captured.&#34;}], &#34;backend_tests/services/test_task_service.py::test_create_task&#34;: [{&#34;extras&#34;: [], &#34;result&#34;: &#34;Passed&#34;, &#34;testId&#34;: &#34;backend_tests/services/test_task_service.py::test_create_task&#34;, &#34;duration&#34;: &#34;4 ms&#34;, &#34;resultsTableRow&#34;: [&#34;&lt;td class=\&#34;col-result\&#34;&gt;Passed&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-testId\&#34;&gt;backend_tests/services/test_task_service.py::test_create_task&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-duration\&#34;&gt;4 ms&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-links\&#34;&gt;&lt;/td&gt;&#34;], &#34;log&#34;: &#34;----------------------------- Captured stderr call -----------------------------\nINFO:core.services.task:Creating task: test_task\n\n------------------------------ Captured log call -------------------------------\nINFO     core.services.task:task.py:52 Creating task: test_task\n\n&#34;}], &#34;backend_tests/services/test_task_service.py::test_get_task&#34;: [{&#34;extras&#34;: [], &#34;result&#34;: &#34;Passed&#34;, &#34;testId&#34;: &#34;backend_tests/services/test_task_service.py::test_get_task&#34;, &#34;duration&#34;: &#34;3 ms&#34;, &#34;resultsTableRow&#34;: [&#34;&lt;td class=\&#34;col-result\&#34;&gt;Passed&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-testId\&#34;&gt;backend_tests/services/test_task_service.py::test_get_task&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-duration\&#34;&gt;3 ms&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-links\&#34;&gt;&lt;/td&gt;&#34;], &#34;log&#34;: &#34;----------------------------- Captured stderr call -----------------------------\nINFO:core.services.task:Creating task: test_task\nERROR:core.services.task:Error getting task status: Task non-existent-id not found\n\n------------------------------ Captured log call -------------------------------\nINFO     core.services.task:task.py:52 Creating task: test_task\nERROR    core.services.task:task.py:149 Error getting task status: Task non-existent-id not found\n\n&#34;}], &#34;backend_tests/services/test_task_service.py::test_update_task_status&#34;: [{&#34;extras&#34;: [], &#34;result&#34;: &#34;Passed&#34;, &#34;testId&#34;: &#34;backend_tests/services/test_task_service.py::test_update_task_status&#34;, &#34;duration&#34;: &#34;118 ms&#34;, &#34;resultsTableRow&#34;: [&#34;&lt;td class=\&#34;col-result\&#34;&gt;Passed&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-testId\&#34;&gt;backend_tests/services/test_task_service.py::test_update_task_status&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-duration\&#34;&gt;118 ms&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-links\&#34;&gt;&lt;/td&gt;&#34;], &#34;log&#34;: &#34;----------------------------- Captured stderr call -----------------------------\nINFO:core.services.task:Creating task: test_task\n\n------------------------------ Captured log call -------------------------------\nINFO     core.services.task:task.py:52 Creating task: test_task\n\n&#34;}], &#34;backend_tests/services/test_task_service.py::test_list_tasks&#34;: [{&#34;extras&#34;: [], &#34;result&#34;: &#34;Passed&#34;, &#34;testId&#34;: &#34;backend_tests/services/test_task_service.py::test_list_tasks&#34;, &#34;duration&#34;: &#34;7 ms&#34;, &#34;resultsTableRow&#34;: [&#34;&lt;td class=\&#34;col-result\&#34;&gt;Passed&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-testId\&#34;&gt;backend_tests/services/test_task_service.py::test_list_tasks&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-duration\&#34;&gt;7 ms&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-links\&#34;&gt;&lt;/td&gt;&#34;], &#34;log&#34;: &#34;----------------------------- Captured stderr call -----------------------------\nINFO:core.services.task:Creating task: task_0\nINFO:core.services.task:Creating task: task_1\nINFO:core.services.task:Creating task: task_2\n\n------------------------------ Captured log call -------------------------------\nINFO     core.services.task:task.py:52 Creating task: task_0\nINFO     core.services.task:task.py:52 Creating task: task_1\nINFO     core.services.task:task.py:52 Creating task: task_2\n\n&#34;}], &#34;backend_tests/services/test_task_service.py::test_retry_failed_task&#34;: [{&#34;extras&#34;: [], &#34;result&#34;: &#34;Passed&#34;, &#34;testId&#34;: &#34;backend_tests/services/test_task_service.py::test_retry_failed_task&#34;, &#34;duration&#34;: &#34;112 ms&#34;, &#34;resultsTableRow&#34;: [&#34;&lt;td class=\&#34;col-result\&#34;&gt;Passed&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-testId\&#34;&gt;backend_tests/services/test_task_service.py::test_retry_failed_task&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-duration\&#34;&gt;112 ms&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-links\&#34;&gt;&lt;/td&gt;&#34;], &#34;log&#34;: &#34;----------------------------- Captured stderr call -----------------------------\nINFO:core.services.task:Creating task: failing_task\nERROR:core.services.task:Task failing_task failed: Test error\nERROR:asyncio:Task exception was never retrieved\nfuture: &amp;lt;Task finished name=&amp;#x27;Task-593&amp;#x27; coro=&amp;lt;TaskService.create_task.&amp;lt;locals&amp;gt;.wrapped_task() done, defined at C:\\Active Projects\\AI AGENTIC DEALS SYSTEM\\backend\\core\\services\\task.py:55&amp;gt; exception=Exception(&amp;#x27;Test error&amp;#x27;)&amp;gt;\nTraceback (most recent call last):\n  File &amp;quot;C:\\Active Projects\\AI AGENTIC DEALS SYSTEM\\backend\\core\\services\\task.py&amp;quot;, line 80, in wrapped_task\n    result = await func(*args, **kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File &amp;quot;C:\\Active Projects\\AI AGENTIC DEALS SYSTEM\\backend\\backend_tests\\services\\test_task_service.py&amp;quot;, line 137, in failing_task\n    raise Exception(&amp;quot;Test error&amp;quot;)\nException: Test error\n\n------------------------------ Captured log call -------------------------------\nINFO     core.services.task:task.py:52 Creating task: failing_task\nERROR    core.services.task:task.py:115 Task failing_task failed: Test error\nERROR    asyncio:base_events.py:1771 Task exception was never retrieved\nfuture: &amp;lt;Task finished name=&amp;#x27;Task-593&amp;#x27; coro=&amp;lt;TaskService.create_task.&amp;lt;locals&amp;gt;.wrapped_task() done, defined at C:\\Active Projects\\AI AGENTIC DEALS SYSTEM\\backend\\core\\services\\task.py:55&amp;gt; exception=Exception(&amp;#x27;Test error&amp;#x27;)&amp;gt;\nTraceback (most recent call last):\n  File &amp;quot;C:\\Active Projects\\AI AGENTIC DEALS SYSTEM\\backend\\core\\services\\task.py&amp;quot;, line 80, in wrapped_task\n    result = await func(*args, **kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File &amp;quot;C:\\Active Projects\\AI AGENTIC DEALS SYSTEM\\backend\\backend_tests\\services\\test_task_service.py&amp;quot;, line 137, in failing_task\n    raise Exception(&amp;quot;Test error&amp;quot;)\nException: Test error\n\n&#34;}], &#34;backend_tests/services/test_task_service.py::test_cancel_task&#34;: [{&#34;extras&#34;: [], &#34;result&#34;: &#34;Passed&#34;, &#34;testId&#34;: &#34;backend_tests/services/test_task_service.py::test_cancel_task&#34;, &#34;duration&#34;: &#34;3 ms&#34;, &#34;resultsTableRow&#34;: [&#34;&lt;td class=\&#34;col-result\&#34;&gt;Passed&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-testId\&#34;&gt;backend_tests/services/test_task_service.py::test_cancel_task&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-duration\&#34;&gt;3 ms&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-links\&#34;&gt;&lt;/td&gt;&#34;], &#34;log&#34;: &#34;----------------------------- Captured stderr call -----------------------------\nINFO:core.services.task:Creating task: test_task\n\n------------------------------ Captured log call -------------------------------\nINFO     core.services.task:task.py:52 Creating task: test_task\n\n&#34;}], &#34;backend_tests/services/test_task_service.py::test_task_timeout&#34;: [{&#34;extras&#34;: [], &#34;result&#34;: &#34;Passed&#34;, &#34;testId&#34;: &#34;backend_tests/services/test_task_service.py::test_task_timeout&#34;, &#34;duration&#34;: &#34;00:00:02&#34;, &#34;resultsTableRow&#34;: [&#34;&lt;td class=\&#34;col-result\&#34;&gt;Passed&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-testId\&#34;&gt;backend_tests/services/test_task_service.py::test_task_timeout&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-duration\&#34;&gt;00:00:02&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-links\&#34;&gt;&lt;/td&gt;&#34;], &#34;log&#34;: &#34;----------------------------- Captured stderr call -----------------------------\nINFO:core.services.task:Creating task: timeout_task\n\n------------------------------ Captured log call -------------------------------\nINFO     core.services.task:task.py:52 Creating task: timeout_task\n\n&#34;}], &#34;backend_tests/services/test_task_service.py::test_task_dependencies&#34;: [{&#34;extras&#34;: [], &#34;result&#34;: &#34;Passed&#34;, &#34;testId&#34;: &#34;backend_tests/services/test_task_service.py::test_task_dependencies&#34;, &#34;duration&#34;: &#34;00:00:02&#34;, &#34;resultsTableRow&#34;: [&#34;&lt;td class=\&#34;col-result\&#34;&gt;Passed&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-testId\&#34;&gt;backend_tests/services/test_task_service.py::test_task_dependencies&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-duration\&#34;&gt;00:00:02&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-links\&#34;&gt;&lt;/td&gt;&#34;], &#34;log&#34;: &#34;----------------------------- Captured stderr call -----------------------------\nINFO:core.services.task:Creating task: parent_task\nINFO:core.services.task:Creating task: child_task\n\n------------------------------ Captured log call -------------------------------\nINFO     core.services.task:task.py:52 Creating task: parent_task\nINFO     core.services.task:task.py:52 Creating task: child_task\n\n&#34;}], &#34;backend_tests/services/test_task_service.py::test_task_cleanup&#34;: [{&#34;extras&#34;: [], &#34;result&#34;: &#34;Passed&#34;, &#34;testId&#34;: &#34;backend_tests/services/test_task_service.py::test_task_cleanup&#34;, &#34;duration&#34;: &#34;505 ms&#34;, &#34;resultsTableRow&#34;: [&#34;&lt;td class=\&#34;col-result\&#34;&gt;Passed&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-testId\&#34;&gt;backend_tests/services/test_task_service.py::test_task_cleanup&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-duration\&#34;&gt;505 ms&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-links\&#34;&gt;&lt;/td&gt;&#34;], &#34;log&#34;: &#34;----------------------------- Captured stderr call -----------------------------\nINFO:core.services.task:Creating task: task_0\nINFO:core.services.task:Creating task: task_1\nINFO:core.services.task:Creating task: task_2\n\n------------------------------ Captured log call -------------------------------\nINFO     core.services.task:task.py:52 Creating task: task_0\nINFO     core.services.task:task.py:52 Creating task: task_1\nINFO     core.services.task:task.py:52 Creating task: task_2\n\n&#34;}], &#34;backend_tests/services/test_token_service.py::test_get_balance&#34;: [{&#34;extras&#34;: [], &#34;result&#34;: &#34;Passed&#34;, &#34;testId&#34;: &#34;backend_tests/services/test_token_service.py::test_get_balance&#34;, &#34;duration&#34;: &#34;259 ms&#34;, &#34;resultsTableRow&#34;: [&#34;&lt;td class=\&#34;col-result\&#34;&gt;Passed&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-testId\&#34;&gt;backend_tests/services/test_token_service.py::test_get_balance&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-duration\&#34;&gt;259 ms&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-links\&#34;&gt;&lt;/td&gt;&#34;], &#34;log&#34;: &#34;----------------------------- Captured stdout call -----------------------------\n2025-03-01 03:08:48,368 - core.services.token - DEBUG - Retrieved balance for user 855cec5a-402a-47b6-9b02-a1d712dafb0e: &amp;lt;TokenBalance(id=b185af6e-3de9-40a8-9923-30df8a90f70a, balance=50.00000000)&amp;gt;\n\n----------------------------- Captured stderr call -----------------------------\nDEBUG:core.services.token:Retrieved balance for user 855cec5a-402a-47b6-9b02-a1d712dafb0e: &amp;lt;TokenBalance(id=b185af6e-3de9-40a8-9923-30df8a90f70a, balance=50.00000000)&amp;gt;\n\n------------------------------ Captured log call -------------------------------\nDEBUG    core.services.token:token.py:490 Retrieved balance for user 855cec5a-402a-47b6-9b02-a1d712dafb0e: &amp;lt;TokenBalance(id=b185af6e-3de9-40a8-9923-30df8a90f70a, balance=50.00000000)&amp;gt;\n\n&#34;}], &#34;backend_tests/services/test_token_service.py::test_transfer_tokens&#34;: [{&#34;extras&#34;: [], &#34;result&#34;: &#34;Passed&#34;, &#34;testId&#34;: &#34;backend_tests/services/test_token_service.py::test_transfer_tokens&#34;, &#34;duration&#34;: &#34;511 ms&#34;, &#34;resultsTableRow&#34;: [&#34;&lt;td class=\&#34;col-result\&#34;&gt;Passed&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-testId\&#34;&gt;backend_tests/services/test_token_service.py::test_transfer_tokens&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-duration\&#34;&gt;511 ms&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-links\&#34;&gt;&lt;/td&gt;&#34;], &#34;log&#34;: &#34;----------------------------- Captured stdout call -----------------------------\n2025-03-01 03:08:48,867 - core.repositories.token - DEBUG - Created new balance for user b2f7b991-6812-464a-817c-0a894ffaad05 with ID 490dd75c-a3bd-4365-b9b6-3d73bf4f6110\n2025-03-01 03:08:48,869 - core.repositories.token - DEBUG - Created transaction with ID aac1df8d-919c-40b5-8832-8f2fd6b17dc2\n2025-03-01 03:08:48,879 - core.services.token - INFO - Successfully transferred 50.0 tokens from 818cbe80-a1a8-40a5-b75e-a48afd9bdafa to b2f7b991-6812-464a-817c-0a894ffaad05: Test transfer\n2025-03-01 03:08:48,881 - core.services.token - DEBUG - Retrieved balance for user 818cbe80-a1a8-40a5-b75e-a48afd9bdafa: &amp;lt;TokenBalance(id=e640b8c3-a5a9-47ee-8bc1-52280bc73d48, balance=50.00000000)&amp;gt;\n2025-03-01 03:08:48,882 - core.services.token - DEBUG - Retrieved balance for user b2f7b991-6812-464a-817c-0a894ffaad05: &amp;lt;TokenBalance(id=490dd75c-a3bd-4365-b9b6-3d73bf4f6110, balance=50.00000000)&amp;gt;\n\n----------------------------- Captured stderr call -----------------------------\nDEBUG:core.repositories.token:Created new balance for user b2f7b991-6812-464a-817c-0a894ffaad05 with ID 490dd75c-a3bd-4365-b9b6-3d73bf4f6110\nDEBUG:core.repositories.token:Created transaction with ID aac1df8d-919c-40b5-8832-8f2fd6b17dc2\nINFO:core.services.token:Successfully transferred 50.0 tokens from 818cbe80-a1a8-40a5-b75e-a48afd9bdafa to b2f7b991-6812-464a-817c-0a894ffaad05: Test transfer\nDEBUG:core.services.token:Retrieved balance for user 818cbe80-a1a8-40a5-b75e-a48afd9bdafa: &amp;lt;TokenBalance(id=e640b8c3-a5a9-47ee-8bc1-52280bc73d48, balance=50.00000000)&amp;gt;\nDEBUG:core.services.token:Retrieved balance for user b2f7b991-6812-464a-817c-0a894ffaad05: &amp;lt;TokenBalance(id=490dd75c-a3bd-4365-b9b6-3d73bf4f6110, balance=50.00000000)&amp;gt;\n\n------------------------------ Captured log call -------------------------------\nDEBUG    core.repositories.token:token.py:420 Created new balance for user b2f7b991-6812-464a-817c-0a894ffaad05 with ID 490dd75c-a3bd-4365-b9b6-3d73bf4f6110\nDEBUG    core.repositories.token:token.py:436 Created transaction with ID aac1df8d-919c-40b5-8832-8f2fd6b17dc2\nINFO     core.services.token:token.py:542 Successfully transferred 50.0 tokens from 818cbe80-a1a8-40a5-b75e-a48afd9bdafa to b2f7b991-6812-464a-817c-0a894ffaad05: Test transfer\nDEBUG    core.services.token:token.py:490 Retrieved balance for user 818cbe80-a1a8-40a5-b75e-a48afd9bdafa: &amp;lt;TokenBalance(id=e640b8c3-a5a9-47ee-8bc1-52280bc73d48, balance=50.00000000)&amp;gt;\nDEBUG    core.services.token:token.py:490 Retrieved balance for user b2f7b991-6812-464a-817c-0a894ffaad05: &amp;lt;TokenBalance(id=490dd75c-a3bd-4365-b9b6-3d73bf4f6110, balance=50.00000000)&amp;gt;\n\n&#34;}], &#34;backend_tests/services/test_token_service.py::test_insufficient_balance&#34;: [{&#34;extras&#34;: [], &#34;result&#34;: &#34;Passed&#34;, &#34;testId&#34;: &#34;backend_tests/services/test_token_service.py::test_insufficient_balance&#34;, &#34;duration&#34;: &#34;496 ms&#34;, &#34;resultsTableRow&#34;: [&#34;&lt;td class=\&#34;col-result\&#34;&gt;Passed&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-testId\&#34;&gt;backend_tests/services/test_token_service.py::test_insufficient_balance&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-duration\&#34;&gt;496 ms&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-links\&#34;&gt;&lt;/td&gt;&#34;], &#34;log&#34;: &#34;----------------------------- Captured stdout call -----------------------------\n2025-03-01 03:08:49,381 - core.services.token - ERROR - Failed to transfer tokens: Insufficient balance for deduction\n\n----------------------------- Captured stderr call -----------------------------\nERROR:core.services.token:Failed to transfer tokens: Insufficient balance for deduction\n\n------------------------------ Captured log call -------------------------------\nERROR    core.services.token:token.py:549 Failed to transfer tokens: Insufficient balance for deduction\n\n--------------------------- Captured stderr teardown ---------------------------\nsys:1: SAWarning: transaction already deassociated from connection\n&#34;}], &#34;backend_tests/services/test_token_service.py::test_service_fee&#34;: [{&#34;extras&#34;: [], &#34;result&#34;: &#34;Passed&#34;, &#34;testId&#34;: &#34;backend_tests/services/test_token_service.py::test_service_fee&#34;, &#34;duration&#34;: &#34;283 ms&#34;, &#34;resultsTableRow&#34;: [&#34;&lt;td class=\&#34;col-result\&#34;&gt;Passed&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-testId\&#34;&gt;backend_tests/services/test_token_service.py::test_service_fee&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-duration\&#34;&gt;283 ms&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-links\&#34;&gt;&lt;/td&gt;&#34;], &#34;log&#34;: &#34;----------------------------- Captured stdout call -----------------------------\n2025-03-01 03:08:49,661 - core.services.token - INFO - Deducted service fee of 10.0 from user be9f358f-0347-4c0a-bcfa-369e5ed0ba43 for test_service\n2025-03-01 03:08:49,668 - core.services.token - DEBUG - Retrieved balance for user be9f358f-0347-4c0a-bcfa-369e5ed0ba43: &amp;lt;TokenBalance(id=56449c4a-0487-4932-b6b3-3d786820959b, balance=90.00000000)&amp;gt;\n\n----------------------------- Captured stderr call -----------------------------\nINFO:core.services.token:Deducted service fee of 10.0 from user be9f358f-0347-4c0a-bcfa-369e5ed0ba43 for test_service\nDEBUG:core.services.token:Retrieved balance for user be9f358f-0347-4c0a-bcfa-369e5ed0ba43: &amp;lt;TokenBalance(id=56449c4a-0487-4932-b6b3-3d786820959b, balance=90.00000000)&amp;gt;\n\n------------------------------ Captured log call -------------------------------\nINFO     core.services.token:token.py:595 Deducted service fee of 10.0 from user be9f358f-0347-4c0a-bcfa-369e5ed0ba43 for test_service\nDEBUG    core.services.token:token.py:490 Retrieved balance for user be9f358f-0347-4c0a-bcfa-369e5ed0ba43: &amp;lt;TokenBalance(id=56449c4a-0487-4932-b6b3-3d786820959b, balance=90.00000000)&amp;gt;\n\n&#34;}], &#34;backend_tests/services/test_token_service.py::test_transaction_history&#34;: [{&#34;extras&#34;: [], &#34;result&#34;: &#34;Passed&#34;, &#34;testId&#34;: &#34;backend_tests/services/test_token_service.py::test_transaction_history&#34;, &#34;duration&#34;: &#34;265 ms&#34;, &#34;resultsTableRow&#34;: [&#34;&lt;td class=\&#34;col-result\&#34;&gt;Passed&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-testId\&#34;&gt;backend_tests/services/test_token_service.py::test_transaction_history&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-duration\&#34;&gt;265 ms&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-links\&#34;&gt;&lt;/td&gt;&#34;], &#34;log&#34;: &#34;----------------------------- Captured stdout call -----------------------------\n2025-03-01 03:08:49,936 - core.services.token - DEBUG - Retrieved 3 transactions for user b2417672-04dd-489f-bc44-35797478a375\n\n----------------------------- Captured stderr call -----------------------------\nDEBUG:core.services.token:Retrieved 3 transactions for user b2417672-04dd-489f-bc44-35797478a375\n\n------------------------------ Captured log call -------------------------------\nDEBUG    core.services.token:token.py:212 Retrieved 3 transactions for user b2417672-04dd-489f-bc44-35797478a375\n\n&#34;}], &#34;backend_tests/services/test_token_service.py::test_balance_cache&#34;: [{&#34;extras&#34;: [], &#34;result&#34;: &#34;Passed&#34;, &#34;testId&#34;: &#34;backend_tests/services/test_token_service.py::test_balance_cache&#34;, &#34;duration&#34;: &#34;256 ms&#34;, &#34;resultsTableRow&#34;: [&#34;&lt;td class=\&#34;col-result\&#34;&gt;Passed&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-testId\&#34;&gt;backend_tests/services/test_token_service.py::test_balance_cache&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-duration\&#34;&gt;256 ms&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-links\&#34;&gt;&lt;/td&gt;&#34;], &#34;log&#34;: &#34;----------------------------- Captured stdout call -----------------------------\n2025-03-01 03:08:50,196 - core.services.token - DEBUG - Retrieved balance for user 55b6b58b-fcc4-444c-ac4a-4c54a09624e3: &amp;lt;TokenBalance(id=236d3db2-9b5b-4154-92b7-1360bedcec29, balance=100.00000000)&amp;gt;\n2025-03-01 03:08:50,196 - core.services.token - DEBUG - Retrieved cached balance for user 55b6b58b-fcc4-444c-ac4a-4c54a09624e3: 100.00000000\n2025-03-01 03:08:50,196 - core.services.token - DEBUG - Cleared balance cache for user 55b6b58b-fcc4-444c-ac4a-4c54a09624e3\n2025-03-01 03:08:50,197 - core.services.token - DEBUG - Retrieved balance for user 55b6b58b-fcc4-444c-ac4a-4c54a09624e3: &amp;lt;TokenBalance(id=236d3db2-9b5b-4154-92b7-1360bedcec29, balance=100.00000000)&amp;gt;\n\n----------------------------- Captured stderr call -----------------------------\nDEBUG:core.services.token:Retrieved balance for user 55b6b58b-fcc4-444c-ac4a-4c54a09624e3: &amp;lt;TokenBalance(id=236d3db2-9b5b-4154-92b7-1360bedcec29, balance=100.00000000)&amp;gt;\nDEBUG:core.services.token:Retrieved cached balance for user 55b6b58b-fcc4-444c-ac4a-4c54a09624e3: 100.00000000\nDEBUG:core.services.token:Cleared balance cache for user 55b6b58b-fcc4-444c-ac4a-4c54a09624e3\nDEBUG:core.services.token:Retrieved balance for user 55b6b58b-fcc4-444c-ac4a-4c54a09624e3: &amp;lt;TokenBalance(id=236d3db2-9b5b-4154-92b7-1360bedcec29, balance=100.00000000)&amp;gt;\n\n------------------------------ Captured log call -------------------------------\nDEBUG    core.services.token:token.py:490 Retrieved balance for user 55b6b58b-fcc4-444c-ac4a-4c54a09624e3: &amp;lt;TokenBalance(id=236d3db2-9b5b-4154-92b7-1360bedcec29, balance=100.00000000)&amp;gt;\nDEBUG    core.services.token:token.py:468 Retrieved cached balance for user 55b6b58b-fcc4-444c-ac4a-4c54a09624e3: 100.00000000\nDEBUG    core.services.token:token.py:616 Cleared balance cache for user 55b6b58b-fcc4-444c-ac4a-4c54a09624e3\nDEBUG    core.services.token:token.py:490 Retrieved balance for user 55b6b58b-fcc4-444c-ac4a-4c54a09624e3: &amp;lt;TokenBalance(id=236d3db2-9b5b-4154-92b7-1360bedcec29, balance=100.00000000)&amp;gt;\n\n&#34;}], &#34;backend_tests/services/test_token_service.py::test_transaction_validation&#34;: [{&#34;extras&#34;: [], &#34;result&#34;: &#34;Passed&#34;, &#34;testId&#34;: &#34;backend_tests/services/test_token_service.py::test_transaction_validation&#34;, &#34;duration&#34;: &#34;241 ms&#34;, &#34;resultsTableRow&#34;: [&#34;&lt;td class=\&#34;col-result\&#34;&gt;Passed&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-testId\&#34;&gt;backend_tests/services/test_token_service.py::test_transaction_validation&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-duration\&#34;&gt;241 ms&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-links\&#34;&gt;&lt;/td&gt;&#34;], &#34;log&#34;: &#34;No log output captured.&#34;}], &#34;backend_tests/services/test_token_service.py::test_token_transaction_creation&#34;: [{&#34;extras&#34;: [], &#34;result&#34;: &#34;Passed&#34;, &#34;testId&#34;: &#34;backend_tests/services/test_token_service.py::test_token_transaction_creation&#34;, &#34;duration&#34;: &#34;251 ms&#34;, &#34;resultsTableRow&#34;: [&#34;&lt;td class=\&#34;col-result\&#34;&gt;Passed&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-testId\&#34;&gt;backend_tests/services/test_token_service.py::test_token_transaction_creation&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-duration\&#34;&gt;251 ms&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-links\&#34;&gt;&lt;/td&gt;&#34;], &#34;log&#34;: &#34;No log output captured.&#34;}], &#34;backend_tests/services/test_token_service.py::test_token_balance_calculation&#34;: [{&#34;extras&#34;: [], &#34;result&#34;: &#34;Passed&#34;, &#34;testId&#34;: &#34;backend_tests/services/test_token_service.py::test_token_balance_calculation&#34;, &#34;duration&#34;: &#34;266 ms&#34;, &#34;resultsTableRow&#34;: [&#34;&lt;td class=\&#34;col-result\&#34;&gt;Passed&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-testId\&#34;&gt;backend_tests/services/test_token_service.py::test_token_balance_calculation&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-duration\&#34;&gt;266 ms&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-links\&#34;&gt;&lt;/td&gt;&#34;], &#34;log&#34;: &#34;----------------------------- Captured stdout call -----------------------------\n2025-03-01 03:08:50,957 - core.services.token - DEBUG - Retrieved balance for user f888ca2a-0d8e-4433-8657-91c4ae96b61c: &amp;lt;TokenBalance(id=d775010d-bfb1-4f6f-8627-a2e4196392c1, balance=1.00000000)&amp;gt;\n2025-03-01 03:08:50,965 - core.services.token - DEBUG - Retrieved balance for user f888ca2a-0d8e-4433-8657-91c4ae96b61c: &amp;lt;TokenBalance(id=d775010d-bfb1-4f6f-8627-a2e4196392c1, balance=1.50000000)&amp;gt;\n\n----------------------------- Captured stderr call -----------------------------\nDEBUG:core.services.token:Retrieved balance for user f888ca2a-0d8e-4433-8657-91c4ae96b61c: &amp;lt;TokenBalance(id=d775010d-bfb1-4f6f-8627-a2e4196392c1, balance=1.00000000)&amp;gt;\nDEBUG:core.services.token:Retrieved balance for user f888ca2a-0d8e-4433-8657-91c4ae96b61c: &amp;lt;TokenBalance(id=d775010d-bfb1-4f6f-8627-a2e4196392c1, balance=1.50000000)&amp;gt;\n\n------------------------------ Captured log call -------------------------------\nDEBUG    core.services.token:token.py:490 Retrieved balance for user f888ca2a-0d8e-4433-8657-91c4ae96b61c: &amp;lt;TokenBalance(id=d775010d-bfb1-4f6f-8627-a2e4196392c1, balance=1.00000000)&amp;gt;\nDEBUG    core.services.token:token.py:490 Retrieved balance for user f888ca2a-0d8e-4433-8657-91c4ae96b61c: &amp;lt;TokenBalance(id=d775010d-bfb1-4f6f-8627-a2e4196392c1, balance=1.50000000)&amp;gt;\n\n&#34;}], &#34;backend_tests/services/test_token_service.py::test_token_transaction_validation&#34;: [{&#34;extras&#34;: [], &#34;result&#34;: &#34;Passed&#34;, &#34;testId&#34;: &#34;backend_tests/services/test_token_service.py::test_token_transaction_validation&#34;, &#34;duration&#34;: &#34;253 ms&#34;, &#34;resultsTableRow&#34;: [&#34;&lt;td class=\&#34;col-result\&#34;&gt;Passed&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-testId\&#34;&gt;backend_tests/services/test_token_service.py::test_token_transaction_validation&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-duration\&#34;&gt;253 ms&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-links\&#34;&gt;&lt;/td&gt;&#34;], &#34;log&#34;: &#34;No log output captured.&#34;}], &#34;backend_tests/services/test_user/test_auth_service.py::test_authenticate_user&#34;: [{&#34;extras&#34;: [], &#34;result&#34;: &#34;Passed&#34;, &#34;testId&#34;: &#34;backend_tests/services/test_user/test_auth_service.py::test_authenticate_user&#34;, &#34;duration&#34;: &#34;471 ms&#34;, &#34;resultsTableRow&#34;: [&#34;&lt;td class=\&#34;col-result\&#34;&gt;Passed&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-testId\&#34;&gt;backend_tests/services/test_user/test_auth_service.py::test_authenticate_user&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-duration\&#34;&gt;471 ms&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-links\&#34;&gt;&lt;/td&gt;&#34;], &#34;log&#34;: &#34;No log output captured.&#34;}], &#34;backend_tests/services/test_user/test_auth_service.py::test_authentication_failure&#34;: [{&#34;extras&#34;: [], &#34;result&#34;: &#34;Passed&#34;, &#34;testId&#34;: &#34;backend_tests/services/test_user/test_auth_service.py::test_authentication_failure&#34;, &#34;duration&#34;: &#34;474 ms&#34;, &#34;resultsTableRow&#34;: [&#34;&lt;td class=\&#34;col-result\&#34;&gt;Passed&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-testId\&#34;&gt;backend_tests/services/test_user/test_auth_service.py::test_authentication_failure&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-duration\&#34;&gt;474 ms&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-links\&#34;&gt;&lt;/td&gt;&#34;], &#34;log&#34;: &#34;----------------------------- Captured stderr call -----------------------------\nWARNING:core.services.auth:Invalid password for user: test_auth_fail_26d62704@example.com\nWARNING:core.services.auth:User not found or inactive: nonexistent@example.com\n\n------------------------------ Captured log call -------------------------------\nWARNING  core.services.auth:auth.py:108 Invalid password for user: test_auth_fail_26d62704@example.com\nWARNING  core.services.auth:auth.py:100 User not found or inactive: nonexistent@example.com\n\n&#34;}], &#34;backend_tests/services/test_user/test_auth_service.py::test_token_operations&#34;: [{&#34;extras&#34;: [], &#34;result&#34;: &#34;Passed&#34;, &#34;testId&#34;: &#34;backend_tests/services/test_user/test_auth_service.py::test_token_operations&#34;, &#34;duration&#34;: &#34;262 ms&#34;, &#34;resultsTableRow&#34;: [&#34;&lt;td class=\&#34;col-result\&#34;&gt;Passed&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-testId\&#34;&gt;backend_tests/services/test_user/test_auth_service.py::test_token_operations&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-duration\&#34;&gt;262 ms&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-links\&#34;&gt;&lt;/td&gt;&#34;], &#34;log&#34;: &#34;No log output captured.&#34;}]}, &#34;renderCollapsed&#34;: [&#34;passed&#34;], &#34;initialSort&#34;: &#34;result&#34;, &#34;title&#34;: &#34;full-report.html&#34;}"></div>
    <script>
      (function(){function r(e,n,t){function o(i,f){if(!n[i]){if(!e[i]){var c="function"==typeof require&&require;if(!f&&c)return c(i,!0);if(u)return u(i,!0);var a=new Error("Cannot find module '"+i+"'");throw a.code="MODULE_NOT_FOUND",a}var p=n[i]={exports:{}};e[i][0].call(p.exports,function(r){var n=e[i][1][r];return o(n||r)},p,p.exports,r,e,n,t)}return n[i].exports}for(var u="function"==typeof require&&require,i=0;i<t.length;i++)o(t[i]);return o}return r})()({1:[function(require,module,exports){
const { getCollapsedCategory, setCollapsedIds } = require('./storage.js')

class DataManager {
    setManager(data) {
        const collapsedCategories = [...getCollapsedCategory(data.renderCollapsed)]
        const collapsedIds = []
        const tests = Object.values(data.tests).flat().map((test, index) => {
            const collapsed = collapsedCategories.includes(test.result.toLowerCase())
            const id = `test_${index}`
            if (collapsed) {
                collapsedIds.push(id)
            }
            return {
                ...test,
                id,
                collapsed,
            }
        })
        const dataBlob = { ...data, tests }
        this.data = { ...dataBlob }
        this.renderData = { ...dataBlob }
        setCollapsedIds(collapsedIds)
    }

    get allData() {
        return { ...this.data }
    }

    resetRender() {
        this.renderData = { ...this.data }
    }

    setRender(data) {
        this.renderData.tests = [...data]
    }

    toggleCollapsedItem(id) {
        this.renderData.tests = this.renderData.tests.map((test) =>
            test.id === id ? { ...test, collapsed: !test.collapsed } : test,
        )
    }

    set allCollapsed(collapsed) {
        this.renderData = { ...this.renderData, tests: [...this.renderData.tests.map((test) => (
            { ...test, collapsed }
        ))] }
    }

    get testSubset() {
        return [...this.renderData.tests]
    }

    get environment() {
        return this.renderData.environment
    }

    get initialSort() {
        return this.data.initialSort
    }
}

module.exports = {
    manager: new DataManager(),
}

},{"./storage.js":8}],2:[function(require,module,exports){
const mediaViewer = require('./mediaviewer.js')
const templateEnvRow = document.getElementById('template_environment_row')
const templateResult = document.getElementById('template_results-table__tbody')

function htmlToElements(html) {
    const temp = document.createElement('template')
    temp.innerHTML = html
    return temp.content.childNodes
}

const find = (selector, elem) => {
    if (!elem) {
        elem = document
    }
    return elem.querySelector(selector)
}

const findAll = (selector, elem) => {
    if (!elem) {
        elem = document
    }
    return [...elem.querySelectorAll(selector)]
}

const dom = {
    getStaticRow: (key, value) => {
        const envRow = templateEnvRow.content.cloneNode(true)
        const isObj = typeof value === 'object' && value !== null
        const values = isObj ? Object.keys(value).map((k) => `${k}: ${value[k]}`) : null

        const valuesElement = htmlToElements(
            values ? `<ul>${values.map((val) => `<li>${val}</li>`).join('')}<ul>` : `<div>${value}</div>`)[0]
        const td = findAll('td', envRow)
        td[0].textContent = key
        td[1].appendChild(valuesElement)

        return envRow
    },
    getResultTBody: ({ testId, id, log, extras, resultsTableRow, tableHtml, result, collapsed }) => {
        const resultBody = templateResult.content.cloneNode(true)
        resultBody.querySelector('tbody').classList.add(result.toLowerCase())
        resultBody.querySelector('tbody').id = testId
        resultBody.querySelector('.collapsible').dataset.id = id

        resultsTableRow.forEach((html) => {
            const t = document.createElement('template')
            t.innerHTML = html
            resultBody.querySelector('.collapsible').appendChild(t.content)
        })

        if (log) {
            // Wrap lines starting with "E" with span.error to color those lines red
            const wrappedLog = log.replace(/^E.*$/gm, (match) => `<span class="error">${match}</span>`)
            resultBody.querySelector('.log').innerHTML = wrappedLog
        } else {
            resultBody.querySelector('.log').remove()
        }

        if (collapsed) {
            resultBody.querySelector('.collapsible > td')?.classList.add('collapsed')
            resultBody.querySelector('.extras-row').classList.add('hidden')
        } else {
            resultBody.querySelector('.collapsible > td')?.classList.remove('collapsed')
        }

        const media = []
        extras?.forEach(({ name, format_type, content }) => {
            if (['image', 'video'].includes(format_type)) {
                media.push({ path: content, name, format_type })
            }

            if (format_type === 'html') {
                resultBody.querySelector('.extraHTML').insertAdjacentHTML('beforeend', `<div>${content}</div>`)
            }
        })
        mediaViewer.setup(resultBody, media)

        // Add custom html from the pytest_html_results_table_html hook
        tableHtml?.forEach((item) => {
            resultBody.querySelector('td[class="extra"]').insertAdjacentHTML('beforeend', item)
        })

        return resultBody
    },
}

module.exports = {
    dom,
    htmlToElements,
    find,
    findAll,
}

},{"./mediaviewer.js":6}],3:[function(require,module,exports){
const { manager } = require('./datamanager.js')
const { doSort } = require('./sort.js')
const storageModule = require('./storage.js')

const getFilteredSubSet = (filter) =>
    manager.allData.tests.filter(({ result }) => filter.includes(result.toLowerCase()))

const doInitFilter = () => {
    const currentFilter = storageModule.getVisible()
    const filteredSubset = getFilteredSubSet(currentFilter)
    manager.setRender(filteredSubset)
}

const doFilter = (type, show) => {
    if (show) {
        storageModule.showCategory(type)
    } else {
        storageModule.hideCategory(type)
    }

    const currentFilter = storageModule.getVisible()
    const filteredSubset = getFilteredSubSet(currentFilter)
    manager.setRender(filteredSubset)

    const sortColumn = storageModule.getSort()
    doSort(sortColumn, true)
}

module.exports = {
    doFilter,
    doInitFilter,
}

},{"./datamanager.js":1,"./sort.js":7,"./storage.js":8}],4:[function(require,module,exports){
const { redraw, bindEvents, renderStatic } = require('./main.js')
const { doInitFilter } = require('./filter.js')
const { doInitSort } = require('./sort.js')
const { manager } = require('./datamanager.js')
const data = JSON.parse(document.getElementById('data-container').dataset.jsonblob)

function init() {
    manager.setManager(data)
    doInitFilter()
    doInitSort()
    renderStatic()
    redraw()
    bindEvents()
}

init()

},{"./datamanager.js":1,"./filter.js":3,"./main.js":5,"./sort.js":7}],5:[function(require,module,exports){
const { dom, find, findAll } = require('./dom.js')
const { manager } = require('./datamanager.js')
const { doSort } = require('./sort.js')
const { doFilter } = require('./filter.js')
const {
    getVisible,
    getCollapsedIds,
    setCollapsedIds,
    getSort,
    getSortDirection,
    possibleFilters,
} = require('./storage.js')

const removeChildren = (node) => {
    while (node.firstChild) {
        node.removeChild(node.firstChild)
    }
}

const renderStatic = () => {
    const renderEnvironmentTable = () => {
        const environment = manager.environment
        const rows = Object.keys(environment).map((key) => dom.getStaticRow(key, environment[key]))
        const table = document.getElementById('environment')
        removeChildren(table)
        rows.forEach((row) => table.appendChild(row))
    }
    renderEnvironmentTable()
}

const addItemToggleListener = (elem) => {
    elem.addEventListener('click', ({ target }) => {
        const id = target.parentElement.dataset.id
        manager.toggleCollapsedItem(id)

        const collapsedIds = getCollapsedIds()
        if (collapsedIds.includes(id)) {
            const updated = collapsedIds.filter((item) => item !== id)
            setCollapsedIds(updated)
        } else {
            collapsedIds.push(id)
            setCollapsedIds(collapsedIds)
        }
        redraw()
    })
}

const renderContent = (tests) => {
    const sortAttr = getSort(manager.initialSort)
    const sortAsc = JSON.parse(getSortDirection())
    const rows = tests.map(dom.getResultTBody)
    const table = document.getElementById('results-table')
    const tableHeader = document.getElementById('results-table-head')

    const newTable = document.createElement('table')
    newTable.id = 'results-table'

    // remove all sorting classes and set the relevant
    findAll('.sortable', tableHeader).forEach((elem) => elem.classList.remove('asc', 'desc'))
    tableHeader.querySelector(`.sortable[data-column-type="${sortAttr}"]`)?.classList.add(sortAsc ? 'desc' : 'asc')
    newTable.appendChild(tableHeader)

    if (!rows.length) {
        const emptyTable = document.getElementById('template_results-table__body--empty').content.cloneNode(true)
        newTable.appendChild(emptyTable)
    } else {
        rows.forEach((row) => {
            if (!!row) {
                findAll('.collapsible td:not(.col-links', row).forEach(addItemToggleListener)
                find('.logexpander', row).addEventListener('click',
                    (evt) => evt.target.parentNode.classList.toggle('expanded'),
                )
                newTable.appendChild(row)
            }
        })
    }

    table.replaceWith(newTable)
}

const renderDerived = () => {
    const currentFilter = getVisible()
    possibleFilters.forEach((result) => {
        const input = document.querySelector(`input[data-test-result="${result}"]`)
        input.checked = currentFilter.includes(result)
    })
}

const bindEvents = () => {
    const filterColumn = (evt) => {
        const { target: element } = evt
        const { testResult } = element.dataset

        doFilter(testResult, element.checked)
        const collapsedIds = getCollapsedIds()
        const updated = manager.renderData.tests.map((test) => {
            return {
                ...test,
                collapsed: collapsedIds.includes(test.id),
            }
        })
        manager.setRender(updated)
        redraw()
    }

    const header = document.getElementById('environment-header')
    header.addEventListener('click', () => {
        const table = document.getElementById('environment')
        table.classList.toggle('hidden')
        header.classList.toggle('collapsed')
    })

    findAll('input[name="filter_checkbox"]').forEach((elem) => {
        elem.addEventListener('click', filterColumn)
    })

    findAll('.sortable').forEach((elem) => {
        elem.addEventListener('click', (evt) => {
            const { target: element } = evt
            const { columnType } = element.dataset
            doSort(columnType)
            redraw()
        })
    })

    document.getElementById('show_all_details').addEventListener('click', () => {
        manager.allCollapsed = false
        setCollapsedIds([])
        redraw()
    })
    document.getElementById('hide_all_details').addEventListener('click', () => {
        manager.allCollapsed = true
        const allIds = manager.renderData.tests.map((test) => test.id)
        setCollapsedIds(allIds)
        redraw()
    })
}

const redraw = () => {
    const { testSubset } = manager

    renderContent(testSubset)
    renderDerived()
}

module.exports = {
    redraw,
    bindEvents,
    renderStatic,
}

},{"./datamanager.js":1,"./dom.js":2,"./filter.js":3,"./sort.js":7,"./storage.js":8}],6:[function(require,module,exports){
class MediaViewer {
    constructor(assets) {
        this.assets = assets
        this.index = 0
    }

    nextActive() {
        this.index = this.index === this.assets.length - 1 ? 0 : this.index + 1
        return [this.activeFile, this.index]
    }

    prevActive() {
        this.index = this.index === 0 ? this.assets.length - 1 : this.index -1
        return [this.activeFile, this.index]
    }

    get currentIndex() {
        return this.index
    }

    get activeFile() {
        return this.assets[this.index]
    }
}


const setup = (resultBody, assets) => {
    if (!assets.length) {
        resultBody.querySelector('.media').classList.add('hidden')
        return
    }

    const mediaViewer = new MediaViewer(assets)
    const container = resultBody.querySelector('.media-container')
    const leftArrow = resultBody.querySelector('.media-container__nav--left')
    const rightArrow = resultBody.querySelector('.media-container__nav--right')
    const mediaName = resultBody.querySelector('.media__name')
    const counter = resultBody.querySelector('.media__counter')
    const imageEl = resultBody.querySelector('img')
    const sourceEl = resultBody.querySelector('source')
    const videoEl = resultBody.querySelector('video')

    const setImg = (media, index) => {
        if (media?.format_type === 'image') {
            imageEl.src = media.path

            imageEl.classList.remove('hidden')
            videoEl.classList.add('hidden')
        } else if (media?.format_type === 'video') {
            sourceEl.src = media.path

            videoEl.classList.remove('hidden')
            imageEl.classList.add('hidden')
        }

        mediaName.innerText = media?.name
        counter.innerText = `${index + 1} / ${assets.length}`
    }
    setImg(mediaViewer.activeFile, mediaViewer.currentIndex)

    const moveLeft = () => {
        const [media, index] = mediaViewer.prevActive()
        setImg(media, index)
    }
    const doRight = () => {
        const [media, index] = mediaViewer.nextActive()
        setImg(media, index)
    }
    const openImg = () => {
        window.open(mediaViewer.activeFile.path, '_blank')
    }
    if (assets.length === 1) {
        container.classList.add('media-container--fullscreen')
    } else {
        leftArrow.addEventListener('click', moveLeft)
        rightArrow.addEventListener('click', doRight)
    }
    imageEl.addEventListener('click', openImg)
}

module.exports = {
    setup,
}

},{}],7:[function(require,module,exports){
const { manager } = require('./datamanager.js')
const storageModule = require('./storage.js')

const genericSort = (list, key, ascending, customOrder) => {
    let sorted
    if (customOrder) {
        sorted = list.sort((a, b) => {
            const aValue = a.result.toLowerCase()
            const bValue = b.result.toLowerCase()

            const aIndex = customOrder.findIndex((item) => item.toLowerCase() === aValue)
            const bIndex = customOrder.findIndex((item) => item.toLowerCase() === bValue)

            // Compare the indices to determine the sort order
            return aIndex - bIndex
        })
    } else {
        sorted = list.sort((a, b) => a[key] === b[key] ? 0 : a[key] > b[key] ? 1 : -1)
    }

    if (ascending) {
        sorted.reverse()
    }
    return sorted
}

const durationSort = (list, ascending) => {
    const parseDuration = (duration) => {
        if (duration.includes(':')) {
            // If it's in the format "HH:mm:ss"
            const [hours, minutes, seconds] = duration.split(':').map(Number)
            return (hours * 3600 + minutes * 60 + seconds) * 1000
        } else {
            // If it's in the format "nnn ms"
            return parseInt(duration)
        }
    }
    const sorted = list.sort((a, b) => parseDuration(a['duration']) - parseDuration(b['duration']))
    if (ascending) {
        sorted.reverse()
    }
    return sorted
}

const doInitSort = () => {
    const type = storageModule.getSort(manager.initialSort)
    const ascending = storageModule.getSortDirection()
    const list = manager.testSubset
    const initialOrder = ['Error', 'Failed', 'Rerun', 'XFailed', 'XPassed', 'Skipped', 'Passed']

    storageModule.setSort(type)
    storageModule.setSortDirection(ascending)

    if (type?.toLowerCase() === 'original') {
        manager.setRender(list)
    } else {
        let sortedList
        switch (type) {
        case 'duration':
            sortedList = durationSort(list, ascending)
            break
        case 'result':
            sortedList = genericSort(list, type, ascending, initialOrder)
            break
        default:
            sortedList = genericSort(list, type, ascending)
            break
        }
        manager.setRender(sortedList)
    }
}

const doSort = (type, skipDirection) => {
    const newSortType = storageModule.getSort(manager.initialSort) !== type
    const currentAsc = storageModule.getSortDirection()
    let ascending
    if (skipDirection) {
        ascending = currentAsc
    } else {
        ascending = newSortType ? false : !currentAsc
    }
    storageModule.setSort(type)
    storageModule.setSortDirection(ascending)

    const list = manager.testSubset
    const sortedList = type === 'duration' ? durationSort(list, ascending) : genericSort(list, type, ascending)
    manager.setRender(sortedList)
}

module.exports = {
    doInitSort,
    doSort,
}

},{"./datamanager.js":1,"./storage.js":8}],8:[function(require,module,exports){
const possibleFilters = [
    'passed',
    'skipped',
    'failed',
    'error',
    'xfailed',
    'xpassed',
    'rerun',
]

const getVisible = () => {
    const url = new URL(window.location.href)
    const settings = new URLSearchParams(url.search).get('visible')
    const lower = (item) => {
        const lowerItem = item.toLowerCase()
        if (possibleFilters.includes(lowerItem)) {
            return lowerItem
        }
        return null
    }
    return settings === null ?
        possibleFilters :
        [...new Set(settings?.split(',').map(lower).filter((item) => item))]
}

const hideCategory = (categoryToHide) => {
    const url = new URL(window.location.href)
    const visibleParams = new URLSearchParams(url.search).get('visible')
    const currentVisible = visibleParams ? visibleParams.split(',') : [...possibleFilters]
    const settings = [...new Set(currentVisible)].filter((f) => f !== categoryToHide).join(',')

    url.searchParams.set('visible', settings)
    window.history.pushState({}, null, unescape(url.href))
}

const showCategory = (categoryToShow) => {
    if (typeof window === 'undefined') {
        return
    }
    const url = new URL(window.location.href)
    const currentVisible = new URLSearchParams(url.search).get('visible')?.split(',').filter(Boolean) ||
        [...possibleFilters]
    const settings = [...new Set([categoryToShow, ...currentVisible])]
    const noFilter = possibleFilters.length === settings.length || !settings.length

    noFilter ? url.searchParams.delete('visible') : url.searchParams.set('visible', settings.join(','))
    window.history.pushState({}, null, unescape(url.href))
}

const getSort = (initialSort) => {
    const url = new URL(window.location.href)
    let sort = new URLSearchParams(url.search).get('sort')
    if (!sort) {
        sort = initialSort || 'result'
    }
    return sort
}

const setSort = (type) => {
    const url = new URL(window.location.href)
    url.searchParams.set('sort', type)
    window.history.pushState({}, null, unescape(url.href))
}

const getCollapsedCategory = (renderCollapsed) => {
    let categories
    if (typeof window !== 'undefined') {
        const url = new URL(window.location.href)
        const collapsedItems = new URLSearchParams(url.search).get('collapsed')
        switch (true) {
        case !renderCollapsed && collapsedItems === null:
            categories = ['passed']
            break
        case collapsedItems?.length === 0 || /^["']{2}$/.test(collapsedItems):
            categories = []
            break
        case /^all$/.test(collapsedItems) || collapsedItems === null && /^all$/.test(renderCollapsed):
            categories = [...possibleFilters]
            break
        default:
            categories = collapsedItems?.split(',').map((item) => item.toLowerCase()) || renderCollapsed
            break
        }
    } else {
        categories = []
    }
    return categories
}

const getSortDirection = () => JSON.parse(sessionStorage.getItem('sortAsc')) || false
const setSortDirection = (ascending) => sessionStorage.setItem('sortAsc', ascending)

const getCollapsedIds = () => JSON.parse(sessionStorage.getItem('collapsedIds')) || []
const setCollapsedIds = (list) => sessionStorage.setItem('collapsedIds', JSON.stringify(list))

module.exports = {
    getVisible,
    hideCategory,
    showCategory,
    getCollapsedIds,
    setCollapsedIds,
    getSort,
    setSort,
    getSortDirection,
    setSortDirection,
    getCollapsedCategory,
    possibleFilters,
}

},{}]},{},[4]);
    </script>
  </footer>
</html>